import{c as P,r as m,j as e,L as b,a as X,t as g}from"./app-D9wldZxo.js";import{g as R}from"./echo-CmTENghG.js";import{c as N}from"./utils-B0KHI9vB.js";import{B as D}from"./button-Dadb_Lep.js";import{B as C}from"./badge-DyYF213F.js";import{C as ee,d as se}from"./card-DbFVjWqh.js";import{P as te}from"./progress-D5NiGDeK.js";import{r as ae,P as Z,s as re,t as ne,S as ie,a as oe,C as le,b as B,c as ce,d as T,e as de,f as ue,g as pe,h as he,v as me,y as xe,z as fe,E as ge,F as O,G as U,H as F,I as z,D as V,i as $,q as H,l as G,p as _,n as q,J as be,A as je,j as ve,k as we,m as Ne,o as Y,L as ke,N as Se,w as ye,x as _e}from"./dropdown-menu-C4-9o8Rw.js";import{V as J,c as Ce,d as Me,e as Q,f as Le,a as De,S as Pe}from"./menuConfig-GyORRgsI.js";import{B as Ae}from"./badge-check-CEpGdEtW.js";import{L as E}from"./lock-BHZn93rL.js";import{C as Ie}from"./chevron-right-BSwXEIvG.js";import{S as W}from"./sparkles-JbdQIbjf.js";import{S as Oe}from"./separator-L5pP8n2q.js";import{E as Ee}from"./external-link-pORnC0H4.js";import{C as Re}from"./chevron-down-Dux0wLDw.js";import{c as Be}from"./createLucideIcon-CJjlOp5I.js";import{H as Te}from"./headphones-DD_UyCnk.js";import{U as Ue}from"./user-D9c6nVY3.js";import{S as Fe}from"./shield-BtuNH23d.js";import{T as ze}from"./sonner-DQ2kSMfY.js";const Ve=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],$e=Be("bug",Ve),He={dashboard:"dashboard.view",orders:"orders.view",categories:"categories.view",products:"products.view",product_drop:"products.view",variables:"products.view",files:"media.view",sliders:"sliders.view",inventory:"inventory.view",linkiupay:"billing.view",buildiu:"buildiu.view",whatsapp:"whatsapp.view",linkiulab:"linkiulab.view",integrations:"integrations.view",shipping:"shipping_zones.view",support:"support.view",services:"services.view",agenda:"agenda.view",appointments:"appointments.view",customers:"customers.view",team:"users.view",reviews:"reviews.view",payment_methods:"payment_methods.view",coupons:"coupons.view",tickers:"tickers.view",locations:"locations.view",settings:"settings.view",roles:"roles.view",profile:"profile.view",subscription:"billing.view",billing:"billing.view",linkiu_pos:"pos.view",digital_menu:"products.view",tables:"tables.view",reservations:"reservations.view",kitchen:"kitchen.view",waiters:"waiters.view",statistics:"statistics.view",logout:"dashboard.view"};function Ge(k){const{auth:M,currentTenant:r,currentUserRole:n}=P().props,[u,x]=m.useState(!1),S=s=>{const a=He[s];return a?n?n.is_owner?!0:n.permissions.includes("*")||n.permissions.includes(a):!1:!0},w=(s,a,o)=>S(a)?o?(s.preventDefault(),s.stopPropagation(),S("billing")?(X.get(route("tenant.subscription.index",{tenant:r.slug})),!1):(x(!0),!1)):!0:(s.preventDefault(),s.stopPropagation(),x(!0),!1),p=(r?.vertical?.slug?.toLowerCase()||"default").normalize("NFD").replace(/[\u0300-\u036f]/g,""),v=(J[p]||J.default).map(s=>{const a=Q[s]||Q.dashboard;let o=Ce[s];const l=Me[p];return l&&o&&s==="integrations"&&(o=o.filter(c=>{const h=`integration_${c.label.toLowerCase().replace("é","e")}`;return l[h]===!0})),{label:De[s]||s,route:Le[s]||"#",icon:a,key:s,children:o}}),A=s=>{const a=r?.latest_subscription?.plan?.features;let o={};if(Array.isArray(a)){const l=a.find(c=>typeof c=="object"&&!Array.isArray(c));l&&(o=l)}else typeof a=="object"&&a!==null&&(o=a);return o[s]===!1};return e.jsxs(ae,{variant:"inset",...k,children:[e.jsx(Z,{open:u,onOpenChange:x}),e.jsx(re,{children:e.jsx("div",{className:"px-2 py-2 group-data-[state=collapsed]:hidden",children:e.jsxs(C,{variant:"outline",className:"w-full justify-center gap-2 py-2 border-blue-200 bg-blue-50/50 text-blue-700 hover:bg-blue-100/50",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-semibold",children:"Tienda Verificada"})]})})}),e.jsx(ne,{children:e.jsx(ie,{children:e.jsx(oe,{children:v.map(s=>{const a=A(s.key),o=s.route!=="#"&&route().current(s.route),l=s.children&&s.children.length>0,c=S(s.key);return e.jsx(m.Fragment,{children:l?e.jsx(le,{asChild:!0,defaultOpen:o,className:"group/collapsible",children:e.jsxs(B,{children:[e.jsx(ce,{asChild:!0,children:e.jsxs(T,{tooltip:s.label,isActive:o,onClick:h=>w(h,s.key,a),children:[e.jsx(s.icon,{className:N(!c&&"text-red-500")}),e.jsx("span",{className:N(!c&&"text-red-600 font-medium"),children:s.label}),c?a?e.jsx(C,{className:"ml-auto h-5 px-1.5 text-[10px] font-bold bg-amber-100 text-amber-700 border-amber-200 hover:bg-amber-100",children:"PRO"}):e.jsx(Ie,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}):e.jsx(E,{className:"ml-auto h-3.5 w-3.5 text-red-500 animate-pulse"})]})}),e.jsx(de,{children:e.jsx(ue,{children:s.children?.map(h=>e.jsx(pe,{children:e.jsx(he,{asChild:!0,children:e.jsxs(b,{href:c?a?route("tenant.subscription.index",{tenant:r.slug}):h.route==="#"?"#":route(h.route,{tenant:r.slug}):"#",onClick:I=>w(I,s.key,a),children:[e.jsx("span",{children:h.label}),c?a&&e.jsx(C,{className:"ml-auto h-4 px-1 text-[9px] font-bold bg-amber-100 text-amber-700 border-amber-200",children:"PRO"}):e.jsx(E,{className:"ml-auto h-3 w-3 text-red-500"})]})})},h.label))})})]})}):e.jsx(B,{children:e.jsx(T,{asChild:!0,tooltip:s.label,isActive:o,onClick:h=>w(h,s.key,a),children:e.jsxs(b,{href:c?a?route("tenant.subscription.index",{tenant:r.slug}):s.route==="#"?"#":route(s.route,{tenant:r.slug}):"#",children:[e.jsx(s.icon,{className:N(!c&&"text-red-500")}),e.jsx("span",{className:N(!c&&"text-red-600 font-medium"),children:s.label}),c?a&&e.jsx(C,{className:"ml-auto h-5 px-1.5 text-[10px] font-bold bg-amber-100 text-amber-700 border-amber-200 hover:bg-amber-100",children:"PRO"}):e.jsx(E,{className:"ml-auto h-3.5 w-3.5 text-red-500"})]})})})},s.key)})})})}),e.jsx(me,{children:r?.latest_subscription&&e.jsxs("div",{className:"p-2",children:[e.jsx(ee,{className:"group-data-[state=collapsed]:hidden border-purple-200/50 bg-gradient-to-br from-purple-50 via-white to-blue-50",children:e.jsxs(se,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{variant:"secondary",className:"bg-purple-100 text-purple-700 hover:bg-purple-200",children:r.latest_subscription.plan?.name||"Pro"}),e.jsx(C,{variant:"outline",className:N(r.latest_subscription.days_remaining<=3&&"border-red-200 text-red-600"),children:r.latest_subscription.status==="trialing"?`${r.latest_subscription.trial_days_remaining} días`:`${r.latest_subscription.days_remaining} días`})]}),e.jsx(te,{value:Math.max(5,r.latest_subscription.percent_completed)}),e.jsx(D,{asChild:!0,className:"w-full",children:e.jsxs(b,{href:route("tenant.subscription.index",{tenant:r.slug}),onClick:s=>w(s,"subscription",!1),children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Ver planes"]})})]})}),e.jsx("div",{className:"hidden group-data-[state=collapsed]:flex justify-center",children:e.jsx(b,{href:route("tenant.subscription.index",{tenant:r.slug}),children:e.jsx(W,{className:"h-5 w-5 text-purple-500"})})})]})})]})}function qe({title:k,breadcrumbs:M}){const{auth:r,currentTenant:n,currentUserRole:u}=P().props,x=r?.user;P().url,u?.label,u?.is_owner;const[S,w]=m.useState(!1),j=i=>u?u.is_owner?!0:u.permissions.includes(i)||u.permissions.includes("*"):!1,p=(i,t)=>{j(t)||(i.preventDefault(),w(!0))},[L,v]=m.useState("");m.useEffect(()=>{v(window.location.host)},[]);const A=n?`${L}/${n.slug}`:L,[s,a]=m.useState(r?.notifications?.unread_count||0),[o,l]=m.useState(r?.notifications?.recent||[]),[c,h]=m.useState(!1);m.useEffect(()=>{r?.notifications&&(a(r.notifications.unread_count),l(r.notifications.recent))},[r?.notifications]),m.useEffect(()=>{const i=R();i&&n?.id&&i.channel(`tenant-updates.${n.id}`).listen(".invoice.generated",t=>{g.info("¡Nueva factura generada!",{description:t.message}),a(d=>d+1);const f={id:Math.random().toString(),data:{message:t.message,type:"invoice_generated",url:t.url},created_at:new Date().toISOString(),read_at:null};l(d=>[f,...d.slice(0,4)])}).listen(".payment.status_updated",t=>{t.status==="paid"?g.success("¡Pago Aprobado!",{description:t.message}):g.error("Pago Rechazado",{description:t.message}),a(y=>y+1);const d={id:Math.random().toString(),data:{message:t.message,type:"payment_status_updated",url:t.url},created_at:new Date().toISOString(),read_at:null};l(y=>[d,...y.slice(0,4)])}).listen(".icon.status_updated",t=>{t.status==="approved"?g.success("¡Icono Aprobado!",{description:t.message}):g.error("Icono Rechazado",{description:t.message}),a(y=>y+1);const d={id:Math.random().toString(),data:{message:t.message,type:"icon_status_updated",url:t.url},created_at:new Date().toISOString(),read_at:null};l(y=>[d,...y.slice(0,4)])}).listen(".ticket.replied",t=>{if(t.is_staff){g.info("Nueva respuesta de soporte",{description:t.message,action:{label:"Ver",onClick:()=>window.location.href=route("tenant.support.show",{tenant:n.slug,support:t.ticket_id})}}),a(d=>d+1);const f={id:Math.random().toString(),data:{...t,type:"ticket_replied"},created_at:new Date().toISOString(),read_at:null};l(d=>[f,...d.slice(0,4)])}}).listen(".ticket.assigned",t=>{console.log("[Echo] Received .ticket.assigned event:",t),g.success("Ticket asignado",{description:t.message,action:{label:"Ver",onClick:()=>window.location.href=route("tenant.support.show",{tenant:n.slug,support:t.ticket_id})}}),a(d=>d+1);const f={id:Math.random().toString(),data:{...t,type:"ticket_assigned"},created_at:new Date().toISOString(),read_at:null};l(d=>[f,...d.slice(0,4)])})},[n?.id]);const I=i=>{l(t=>t.map(f=>f.id===i?{...f,read_at:new Date().toISOString()}:f)),a(t=>Math.max(0,t-1))},K=()=>{l(i=>i.map(t=>({...t,read_at:new Date().toISOString()}))),a(0)};return e.jsxs("header",{className:"h-14 bg-white/80 backdrop-blur-md border-b sticky top-0 z-40 transition-all duration-300",children:[e.jsx(Z,{open:S,onOpenChange:w}),e.jsxs("div",{className:"h-full px-4 sm:px-8 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"-ml-1 md:hidden"}),e.jsx(fe,{children:e.jsxs(ge,{children:[e.jsx(O,{className:"hidden md:block",children:e.jsx(U,{asChild:!0,children:e.jsx(b,{href:route("tenant.dashboard",{tenant:n.slug}),children:"Panel"})})}),e.jsx(F,{className:"hidden md:block"}),M?M.map((i,t)=>e.jsxs(m.Fragment,{children:[e.jsx(O,{children:i.href?e.jsx(U,{asChild:!0,children:e.jsx(b,{href:i.href,children:i.label})}):e.jsx(z,{children:i.label})}),t<M.length-1&&e.jsx(F,{})]},t)):e.jsx(O,{children:e.jsx(z,{children:k})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx(D,{asChild:!0,children:e.jsxs("a",{href:n?`//${A}`:"#",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ee,{}),"Ver Tienda"]})}),e.jsxs(V,{children:[e.jsx($,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(D,{variant:"ghost",children:[e.jsx(H,{}),"Ayuda",e.jsx(Re,{})]})}),e.jsxs(G,{align:"end",children:[e.jsxs(_,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx($e,{className:"w-4 h-4 text-rose-500"}),"Reportar error"]}),e.jsxs(_,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx(H,{className:"w-4 h-4 text-amber-500"}),"Tutoriales"]}),e.jsx(q,{}),e.jsxs(_,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx(Te,{className:"w-4 h-4"}),"Hablar con asesor"]})]})]}),e.jsx(Oe,{orientation:"vertical",className:"h-6 hidden sm:block"}),e.jsxs(D,{variant:"ghost",size:"icon",className:"relative text-muted-foreground hover:text-foreground",onClick:()=>h(!0),children:[e.jsx(be,{className:"h-5 w-5"}),s>0&&e.jsx("span",{className:"absolute top-2 right-2 h-2 w-2 bg-rose-500 rounded-full border-2 border-white animate-pulse"})]}),e.jsxs(V,{children:[e.jsx($,{asChild:!0,className:"outline-none ring-0",children:e.jsx(D,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:e.jsxs(je,{className:"h-8 w-8",children:[e.jsx(ve,{src:x?.profile_photo_url,alt:x?.name}),e.jsx(we,{children:x?.name?.charAt(0)})]})})}),e.jsxs(G,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(Ne,{className:"font-normal border-b pb-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold leading-none",children:x?.name}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:x?.email}),e.jsx(C,{variant:"outline",className:"w-fit text-[10px] py-0",children:u?.label||"Linkiu Member"})]})}),e.jsxs(Y,{className:"py-1",children:[e.jsx(_,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(b,{href:n?route("tenant.profile.edit",{tenant:n.slug}):"#",onClick:i=>p(i,"profile.view"),children:[e.jsx(Ue,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Mi Perfil"})]})}),e.jsx(_,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(b,{href:n?route("tenant.settings.edit",{tenant:n.slug}):"#",onClick:i=>p(i,"settings.view"),children:[e.jsx(Pe,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Configuración"})]})}),e.jsx(_,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(b,{href:n?route("tenant.roles.index",{tenant:n.slug}):"#",onClick:i=>p(i,"roles.view"),children:[e.jsx(Fe,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Roles y Permisos"})]})})]}),e.jsx(q,{className:"bg-slate-50"}),e.jsx(Y,{children:e.jsx(_,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none text-destructive focus:text-destructive",children:e.jsxs(b,{href:n?route("tenant.logout",{tenant:n.slug}):"#",method:"post",as:"button",className:"w-full text-left",children:[e.jsx(ke,{className:"mr-3 h-4 w-4"}),"Cerrar Sesión"]})})})]})]})]})]}),e.jsx(Se,{open:c,onOpenChange:h,notifications:o,onNotificationRead:I,onAllRead:K})]})}function Ye(){const k=new Date().getFullYear();return e.jsx("footer",{className:"py-6 px-8 bg-white border-t border-slate-100 rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[e.jsxs("span",{children:["© ",k]}),e.jsx(b,{href:"/",className:"font-bold text-slate-900 hover:text-primary transition-colors",children:"Linkiu.bio"}),e.jsx("span",{className:"hidden sm:inline text-slate-300",children:"•"}),e.jsx("span",{className:"hidden sm:inline",children:"Todos los derechos reservados."})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Privacidad"}),e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Términos"}),e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Soporte"})]})]})})}function xs({children:k,title:M,breadcrumbs:r,maxwidth:n="max-w-7xl",hideSidebar:u=!1,hideFooter:x=!1,hideNavbar:S=!1}){const{auth:w,flash:j,currentTenant:p}=P().props;return m.useEffect(()=>{j.success&&g.success(j.success),j.error&&g.error(j.error),j.warning&&g.warning(j.warning,{duration:8e3})},[j]),m.useEffect(()=>{const L=R();return L&&p?.id&&L.channel(`tenant.${p.id}.reservations`).listen(".reservation.created",v=>{g.info(v.message,{description:"Nueva reserva recibida",duration:1e4,action:{label:"Ver Reservas",onClick:()=>X.get(route("tenant.admin.reservations.index",{tenant:p.slug}))}})}),()=>{try{const v=R();v&&p?.id&&v.connector?.ably?.connection?.state==="connected"&&v.leave(`tenant.${p.id}.reservations`)}catch{}}},[p?.id]),e.jsxs(ye,{children:[!u&&e.jsx(Ge,{}),e.jsxs(_e,{children:[!S&&e.jsx(qe,{title:M,breadcrumbs:r}),e.jsxs("div",{className:N("flex-1 flex flex-col min-h-screen",!u&&"bg-slate-50/50"),children:[e.jsx("main",{className:N("flex-1 overflow-x-hidden",u?"p-0":"p-4 sm:p-8"),children:e.jsx("div",{className:N(u?"w-full":n+" mx-auto","animate-in fade-in slide-in-from-bottom-4 duration-700"),children:k})}),!x&&e.jsx(Ye,{})]})]}),e.jsx(ze,{position:"bottom-center"})]})}export{xs as A};
