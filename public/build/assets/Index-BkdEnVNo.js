import{j as e,H as g,L as p,a as b}from"./app-arqQV-bc.js";import{S as N}from"./SuperAdminLayout-DBJxSbv0.js";import{B as u}from"./button-Bd640uTA.js";import{I as w}from"./input-CnYabjbM.js";import{T as v,a as S,b as h,c as t,d as y,e as l}from"./table-BF9Ri8Ro.js";import{B as C}from"./badge-t3wrEXXG.js";import{D as T,i as M,l as A,m as D,p as j,n as _}from"./dropdown-menu-mNq1McYa.js";import{C as n,a as i,b as c,d}from"./card-BQPJWSk4.js";import{S as E,a as B,b as F,c as I,d as H}from"./select-Ci9oU9C1.js";import{S as L}from"./Pagination-BdXxqbJr.js";import{S as U}from"./search-BL2TDUYY.js";import{F as R}from"./funnel-hxs6NWfb.js";import{U as V}from"./user-KA4Ja2_R.js";import{C as z}from"./clock-D6SFixQE.js";import{E as P}from"./ellipsis-DmatcEia.js";import{E as $}from"./external-link-r8YAPN_c.js";import{M as q}from"./message-square-CJZFbUIv.js";import{f as G}from"./formatDistanceToNow-CJnsltzk.js";import{e as O}from"./es-BteQoBuv.js";import"./chevron-right-CyE8jcbn.js";import"./createLucideIcon-kbomgvBs.js";import"./chevrons-up-down-CmD-hWyD.js";import"./badge-check-C3DjHgnO.js";import"./ApplicationLogo-CDotYN88.js";import"./users-DyLj9nwM.js";import"./layout-grid-DSJln_pY.js";import"./utils-BegMJZHH.js";import"./index-CwhdJaVg.js";import"./index-B_Os2ghw.js";import"./index-CJZqa-kr.js";import"./index-C9GonLHF.js";import"./circle-check-CJmQNw_U.js";import"./trash-2-D8UpIHBH.js";import"./check-BZhepUpU.js";import"./credit-card-4AdI57T8.js";import"./shopping-bag-TtCDC01g.js";import"./dialog-Do7ESPrT.js";import"./x-hBSqTjfa.js";import"./separator-DpUia1Ar.js";import"./index-C-vN8jX4.js";import"./sheet-BJFcoitR.js";import"./index-CfChaKac.js";import"./index-DzhEK4jt.js";import"./index-iS2GCZ5y.js";import"./index-CVnnicxK.js";import"./index-Bz80iYGN.js";import"./index-DiBfayRM.js";import"./index-DDCOIm2e.js";import"./index-BdQq_4o_.js";import"./index-DLsOI5U2.js";import"./chevron-down-CS-ozzzB.js";import"./chevron-up-D9DUAay6.js";import"./chevron-left-BDLIoQOo.js";import"./constructNow-ChcPjMH_.js";import"./differenceInCalendarMonths-B3kfrhWB.js";import"./endOfMonth-DL9zlqV0.js";const m={open:{label:"Abierto",color:"bg-blue-100 text-blue-700"},in_progress:{label:"En progreso",color:"bg-amber-100 text-amber-700"},awaiting_response:{label:"Esperando respuesta",color:"bg-purple-100 text-purple-700"},resolved:{label:"Resuelto",color:"bg-emerald-100 text-emerald-700"},closed:{label:"Cerrado",color:"bg-slate-100 text-slate-700"}},x={low:{label:"Baja",color:"bg-slate-400"},medium:{label:"Media",color:"bg-blue-500"},high:{label:"Alta",color:"bg-orange-500"},urgent:{label:"Urgente",color:"bg-red-500"}},J={technical:"Problema Técnico",billing:"Facturación",account:"Mi Cuenta",feature_request:"Solicitud de Funcionalidad",other:"Otros"},K=r=>{try{const o=new Date(r);return isNaN(o.getTime())?"recientemente":G(o,{addSuffix:!0,locale:O})}catch{return"recientemente"}};function Xe({tickets:r,agents:o}){const f=(s,a)=>{b.post(route("superadmin.support.assign",s),{assigned_to_id:a})};return e.jsxs(N,{header:"Soporte Técnico",breadcrumbs:[{label:"Soporte Técnico"}],children:[e.jsx(g,{title:"Soporte - SuperAdmin"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Centro de Soporte"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestiona los tickets de todos los tenants de la plataforma."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(n,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground uppercase",children:"Abiertos"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:r.data.filter(s=>s.status==="open").length})})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground uppercase",children:"Urgentes"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.data.filter(s=>s.priority==="urgent").length})})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground uppercase",children:"Sin Asignar"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.data.filter(s=>!s.assigned_to).length})})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground uppercase",children:"Total"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:r.data.length})})]})]}),e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(w,{type:"search",placeholder:"Buscar por asunto, tenant o usuario...",className:"pl-8"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(u,{variant:"outline",size:"sm",className:"gap-2 font-semibold",children:[e.jsx(R,{className:"h-4 w-4"})," Filtros"]})})]})}),e.jsxs(d,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(v,{children:[e.jsx(S,{children:e.jsxs(h,{children:[e.jsx(t,{className:"w-[80px]",children:"ID"}),e.jsx(t,{children:"Tenant / Usuario"}),e.jsx(t,{children:"Asunto"}),e.jsx(t,{children:"Estado"}),e.jsx(t,{children:"Prioridad"}),e.jsx(t,{children:"Asignado a"}),e.jsx(t,{className:"text-right",children:"Acciones"})]})}),e.jsx(y,{children:r.data.length>0?r.data.map(s=>e.jsxs(h,{children:[e.jsx(l,{className:"font-mono text-[10px] font-bold",children:e.jsx(p,{href:route("superadmin.support.show",s.id),className:"text-blue-600 hover:underline hover:text-blue-800",children:s.reference_id||`#${String(s.id).padStart(4,"0")}`})}),e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-900",children:s.tenant.name}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"})," ",s.user.name]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx(p,{href:route("superadmin.support.show",s.id),className:"font-semibold hover:underline decoration-primary line-clamp-1",children:s.subject}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase bg-slate-100 px-1 rounded",children:J[s.category]||s.category}),e.jsxs("span",{className:"text-[9px] text-slate-400 flex items-center gap-1",children:[e.jsx(z,{className:"h-2.5 w-2.5"})," ",K(s.created_at)]})]})]})}),e.jsx(l,{children:e.jsx(C,{className:`${(m?.[s.status]||m?.open||{color:"bg-blue-100"}).color} border-none shadow-none`,variant:"secondary",children:(m?.[s.status]||m?.open||{label:"Abierto"}).label})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${(x?.[s.priority]||x?.medium||{color:"bg-slate-400"}).color}`}),e.jsx("span",{className:"text-xs capitalize",children:(x?.[s.priority]||x?.medium||{label:"Media"}).label})]})}),e.jsx(l,{children:e.jsxs(E,{defaultValue:s.assigned_to?String(o.find(a=>a.name===s.assigned_to?.name)?.id):void 0,onValueChange:a=>f(s.id,a),children:[e.jsx(B,{className:"h-8 text-xs w-[140px] shadow-none border-dashed focus:ring-0 focus:ring-offset-0",children:e.jsx(F,{placeholder:"Sin asignar"})}),e.jsx(I,{children:o.map(a=>e.jsx(H,{value:String(a.id),children:a.name},a.id))})]})}),e.jsx(l,{className:"text-right",children:e.jsxs(T,{children:[e.jsx(M,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"cursor-pointer",children:e.jsx(P,{className:"h-4 w-4"})})}),e.jsxs(A,{align:"end",className:"w-48",children:[e.jsx(D,{children:"Acciones"}),e.jsx(j,{asChild:!0,className:"cursor-pointer",children:e.jsxs(p,{href:route("superadmin.support.show",s.id),children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Ver Detalles"]})}),e.jsx(_,{}),e.jsx(j,{className:"text-emerald-600 cursor-pointer",children:"Marcar como Resuelto"})]})]})})]},s.id)):e.jsx(h,{children:e.jsx(l,{colSpan:7,className:"h-24 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 py-8",children:[e.jsx(q,{className:"h-12 w-12 text-muted-foreground/20"}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"No se encontraron tickets."})]})})})})]})}),r.data.length>0&&e.jsx("div",{className:"mt-4",children:e.jsx(L,{links:r.links})})]})]})]})]})}export{Xe as default};
