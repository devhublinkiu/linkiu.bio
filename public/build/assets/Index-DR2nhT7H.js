import{c as re,r as E,j as e,H as te,a as q,t as x,u as K}from"./app-BxeeMXn5.js";import{A as ie}from"./AdminLayout-qCE3vY7L.js";import{C as V,a as L,b as I,c as G,d as U}from"./card-CZ4HJuOG.js";import{S as A}from"./switch-DaaS2XD2.js";import{L as c}from"./label-DvE9LE6F.js";import{B as v}from"./button-7JWLOcK_.js";import{B as J}from"./badge-lrHzGyyu.js";import{I as f}from"./input-DAizBa_g.js";import{D as Q,a as X,b as Y,c as Z,d as le,e as ee}from"./dialog-bj0tKiGn.js";import{S as _,a as y,b as C,c as D,d as a}from"./select-Mywosk_A.js";import{P as ne}from"./dropdown-menu-y9rp4bWE.js";import{A as oe,a as ce,b as de,c as me,d as pe,e as xe,f as ue,g as he}from"./alert-dialog-M1Oqq8sv.js";import{S as je}from"./Pagination-CnT440XL.js";import{S as ge}from"./smartphone-CHWbm9i4.js";import{P as H}from"./plus-CGb4S1OW.js";import{W as ve}from"./wallet-D3trzBtH.js";import{B as be}from"./banknote-o40mAnOF.js";import{C as Ne}from"./credit-card-DdNcKhKR.js";import{B as R}from"./building-2-ozBiMD1D.js";import{C as fe}from"./copy-mCFzC_U6.js";import{S as _e}from"./square-pen-DyMbWI9a.js";import{T as ye}from"./trash-2-Cefy4eHW.js";import{L as se}from"./loader-circle-Os_MzIh-.js";import"./utils-C-R0dfCD.js";import"./progress-BPtmN4cS.js";import"./index-D1_1hXqK.js";import"./index-Dtj3r8is.js";import"./menuConfig--lJI1wgO.js";import"./video-BBI0Mdxh.js";import"./createLucideIcon-MMsaX1RM.js";import"./chef-hat-BUkOBHO9.js";import"./table-YYiP2uiH.js";import"./user-CUi44rAN.js";import"./map-pin-DbqcMmJZ.js";import"./star-Cxzywz77.js";import"./users-Bu-h6n7y.js";import"./calendar-check-DZWxogn-.js";import"./calendar-BmHj6uld.js";import"./briefcase-ClT8Apdn.js";import"./truck-Dctgs6Id.js";import"./message-circle-BPpK8KIf.js";import"./package-1Cz2kpnt.js";import"./shopping-bag-CWfZSTHo.js";import"./layout-dashboard-BHjPtgyJ.js";import"./badge-check-DHBa0N5U.js";import"./lock-D8DYOORy.js";import"./chevron-right-DPgD6mkS.js";import"./sparkles-Bns8Lzd1.js";import"./separator-0SREGApO.js";import"./external-link-BEZwjyKz.js";import"./chevron-down-CUwoWnp1.js";import"./headphones-DG2WmJqQ.js";import"./shield-Bco25DSE.js";import"./sonner-CzgRTX_z.js";import"./index-BAK1YxAc.js";import"./index-YFI2wHgC.js";import"./index-CYQStCBS.js";import"./index-B6sjIBFy.js";import"./index-B6i64pSH.js";import"./index-qgmO2-AH.js";import"./x-CpN8cc9J.js";import"./index-BdQq_4o_.js";import"./index-D8L8_pCG.js";import"./index-DWUEdQX6.js";import"./index-BUGEk3O6.js";import"./check-DyXxeGP9.js";import"./chevron-up-CGTnGh2u.js";import"./circle-check-BQHjiPz9.js";import"./sheet-Bbp6VhsK.js";import"./index-B9B_fttR.js";import"./ellipsis-BUaddE5J.js";import"./chevron-left-C6qfJShI.js";function $s({tenant:i,paymentMethods:u,bankAccounts:n,bank_accounts_limit:h,bank_accounts_count:b,locations:o}){const{currentUserRole:l}=re().props,[S,p]=E.useState(!1),[N,d]=E.useState(null),[r,t]=E.useState(!1),[T,F]=E.useState(null),M=s=>l?l.is_owner===!0||l.permissions?.includes("*")===!0||l.permissions?.includes(s)===!0:!1,P=h!==null&&b>=h,$=n.data,B=(s,m,w)=>{s&&(s.preventDefault(),s.stopPropagation()),M(m)?w():p(!0)},z=s=>u.find(m=>m.type===s),j=z("bank_transfer"),g=z("cash"),k=z("dataphone"),O=(s,m)=>{if(!M("payment_methods.update")){p(!0);return}const w={is_active:m,settings:s.settings??{},location_id:s.location_id};q.put(route("tenant.payment-methods.update.method",{tenant:i.slug,method:s.id}),w,{preserveScroll:!0,preserveState:!0,onSuccess:()=>x.success(m?"Método activado":"Método desactivado"),onError:()=>x.error("Error actualizando método")})},W=(s,m)=>{if(!M("payment_methods.update")){p(!0);return}const w={is_active:s.is_active,location_id:s.location_id,settings:{...s.settings??{},...m}};q.put(route("tenant.payment-methods.update.method",{tenant:i.slug,method:s.id}),w,{preserveScroll:!0,preserveState:!0,onSuccess:()=>x.success("Configuración actualizada"),onError:()=>x.error("Error actualizando configuración")})},ae=()=>{N&&q.delete(route("tenant.payment-methods.accounts.destroy",{tenant:i.slug,account:N.id}),{onSuccess:()=>{x.success("Cuenta eliminada"),d(null)}})};return e.jsxs(ie,{title:"Métodos de Pago",children:[e.jsx(te,{title:"Métodos de Pago - Linkiu.Bio"}),e.jsxs("div",{className:"max-w-7xl mx-auto py-8 text-slate-900",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Métodos de Pago"}),e.jsxs("p",{className:"text-slate-500 font-medium",children:["Define cómo quieres recibir el dinero de tus clientes.",h!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",b," / ",h," cuentas bancarias)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(V,{className:`border-2 transition-all ${j?.is_active?"border-primary/50 shadow-lg shadow-primary/5":"border-slate-100"}`,children:[e.jsxs(L,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"p-2.5 bg-blue-100 text-blue-600 rounded-xl",children:e.jsx(ge,{className:"w-6 h-6"})}),e.jsx(A,{checked:j?.is_active,onCheckedChange:s=>j&&O(j,s)})]}),e.jsx(I,{className:"mt-4",children:"Transferencia Bancaria"}),e.jsx(G,{children:"Nequi, Daviplata, Bancolombia, etc."})]}),j?.is_active&&e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100",children:[e.jsx(c,{className:"text-xs font-bold uppercase text-slate-500",children:"Exigir Comprobante"}),e.jsx(A,{checked:j.settings?.require_proof!==!1,onCheckedChange:s=>W(j,{require_proof:s})})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"text-sm font-bold",children:["Cuentas (",n.total,")"]}),P?e.jsxs(v,{size:"sm",variant:"outline",className:"h-7 text-xs gap-1",disabled:!0,title:"Has alcanzado el máximo de cuentas bancarias permitidas en tu plan",children:[e.jsx(H,{className:"w-3 h-3"})," Agregar"]}):e.jsxs(v,{size:"sm",variant:"outline",className:"h-7 text-xs gap-1 cursor-pointer",onClick:s=>B(s,"payment_methods.create",()=>t(!0)),children:[e.jsx(H,{className:"w-3 h-3"})," Agregar"]})]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-1",children:$.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4 text-center border border-dashed border-slate-200 rounded-lg bg-slate-50/50",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-3 mb-3",children:e.jsx(ve,{className:"size-8 text-primary"})}),e.jsx("p",{className:"text-sm font-medium text-slate-600 mb-1",children:"No tienes cuentas registradas"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Agrega una cuenta para recibir transferencias."}),!P&&e.jsxs(v,{size:"sm",className:"cursor-pointer",onClick:()=>B(null,"payment_methods.create",()=>t(!0)),children:[e.jsx(H,{className:"w-3.5 h-3.5 mr-1"})," Agregar primera cuenta"]})]}):$.map(s=>e.jsx(Ce,{account:s,onDelete:m=>B(null,"payment_methods.delete",()=>d(m)),onEdit:m=>B(null,"payment_methods.update",()=>F(m))},s.id))}),n.last_page>1&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100",children:e.jsx(je,{links:n.links})})]})]})]}),e.jsxs(V,{className:`border-2 transition-all ${g?.is_active?"border-green-500/50 shadow-lg shadow-green-500/5":"border-slate-100"}`,children:[e.jsxs(L,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"p-2.5 bg-green-100 text-green-600 rounded-xl",children:e.jsx(be,{className:"w-6 h-6"})}),e.jsx(A,{checked:g?.is_active,onCheckedChange:s=>g&&O(g,s)})]}),e.jsx(I,{className:"mt-4",children:"Efectivo"}),e.jsx(G,{children:"Pago contra entrega o en caja."})]}),g?.is_active&&e.jsx(U,{children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100",children:[e.jsx(c,{className:"text-xs font-bold uppercase text-slate-500",children:"Preguntar cuánto devuelta necesita"}),e.jsx(A,{checked:g.settings?.ask_change!==!1,onCheckedChange:s=>W(g,{ask_change:s})})]})})]}),e.jsx(V,{className:`border-2 transition-all ${k?.is_active?"border-purple-500/50 shadow-lg shadow-purple-500/5":"border-slate-100"}`,children:e.jsxs(L,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"p-2.5 bg-purple-100 text-purple-600 rounded-xl",children:e.jsx(Ne,{className:"w-6 h-6"})}),e.jsx(A,{checked:k?.is_active,onCheckedChange:s=>k&&O(k,s)})]}),e.jsx(I,{className:"mt-4",children:"Datáfono"}),e.jsx(G,{children:"Llevamos terminal para tarjetas."})]})})]}),e.jsx(ne,{open:S,onOpenChange:p}),e.jsx(oe,{open:!!N,onOpenChange:s=>!s&&d(null),children:e.jsxs(ce,{className:"border-red-100",children:[e.jsxs(de,{children:[e.jsx(me,{children:"¿Seguro que deseas eliminar esta cuenta?"}),e.jsx(pe,{children:"Esta acción no se puede deshacer. La cuenta bancaria será eliminada permanentemente."})]}),e.jsxs(xe,{children:[e.jsx(ue,{className:"cursor-pointer",children:"Cancelar"}),e.jsx(he,{variant:"destructive",onClick:ae,className:"cursor-pointer",children:"Eliminar Cuenta"})]})]})}),e.jsx(De,{isOpen:r,onClose:()=>t(!1),locations:o,tenant:i,atLimit:P}),T&&e.jsx(Se,{isOpen:!!T,onClose:()=>F(null),account:T,locations:o,tenant:i})]})]})}function Ce({account:i,onDelete:u,onEdit:n}){return e.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-100 shadow-sm flex justify-between items-center group",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-sm text-slate-800",children:i.bank_name}),e.jsx(J,{variant:"secondary",className:"text-[9px] h-4 px-1",children:i.account_type}),i.location&&e.jsxs(J,{variant:"outline",className:"text-[9px] h-4 px-1 border-primary/20 bg-primary/5 text-primary",children:[e.jsx(R,{className:"w-2 h-2 mr-1"}),i.location.name]})]}),e.jsxs("div",{className:"text-xs text-slate-500 font-mono mt-0.5 flex items-center gap-1",children:[i.account_number,e.jsx(fe,{className:"w-3 h-3 cursor-pointer hover:text-primary",onClick:()=>{navigator.clipboard.writeText(i.account_number),x.success("Copiado")}})]}),i.account_holder&&e.jsx("div",{className:"text-[10px] text-slate-400 font-medium truncate max-w-[150px]",children:i.account_holder})]}),e.jsxs("div",{className:"flex gap-1 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(v,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>n(i),children:e.jsx(_e,{className:"w-3.5 h-3.5 text-slate-500"})}),e.jsx(v,{variant:"ghost",size:"icon",className:"h-7 w-7 hover:bg-red-50 hover:text-red-600",onClick:()=>u(i),children:e.jsx(ye,{className:"w-3.5 h-3.5"})})]})]})}function De({isOpen:i,onClose:u,locations:n,tenant:h,atLimit:b}){const{data:o,setData:l,post:S,processing:p,reset:N,errors:d}=K({bank_name:"",account_type:"Ahorros",account_number:"",account_holder:"",holder_id:"",location_id:"",is_active:!0}),r=t=>{t.preventDefault(),S(route("tenant.payment-methods.accounts.store",{tenant:h.slug}),{onSuccess:()=>{x.success("Cuenta agregada"),u(),N()},onError:()=>x.error("Revisa los campos del formulario")})};return e.jsx(Q,{open:i,onOpenChange:u,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Nueva Cuenta Bancaria"}),e.jsx(le,{children:"¿A qué cuenta deben transferir tus clientes?"})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Banco"}),e.jsxs(_,{value:o.bank_name,onValueChange:t=>l("bank_name",t),children:[e.jsx(y,{children:e.jsx(C,{placeholder:"Selecciona"})}),e.jsxs(D,{children:[e.jsx(a,{value:"Nequi",children:"Nequi"}),e.jsx(a,{value:"Daviplata",children:"Daviplata"}),e.jsx(a,{value:"Bancolombia",children:"Bancolombia"}),e.jsx(a,{value:"Davivienda",children:"Davivienda"}),e.jsx(a,{value:"BBVA",children:"BBVA"}),e.jsx(a,{value:"Bre-b",children:"Bre-b"}),e.jsx(a,{value:"Otros",children:"Otros"})]})]}),d.bank_name&&e.jsx("p",{className:"text-red-500 text-xs",children:d.bank_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tipo"}),e.jsxs(_,{value:o.account_type,onValueChange:t=>l("account_type",t),children:[e.jsx(y,{children:e.jsx(C,{placeholder:"Selecciona"})}),e.jsxs(D,{children:[e.jsx(a,{value:"Ahorros",children:"Ahorros"}),e.jsx(a,{value:"Corriente",children:"Corriente"}),e.jsx(a,{value:"Depósito Electrónico",children:"Depósito Electrónico"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Número de Cuenta (o Celular)"}),e.jsx(f,{value:o.account_number,onChange:t=>l("account_number",t.target.value),placeholder:"Ej: 3001234567"}),d.account_number&&e.jsx("p",{className:"text-red-500 text-xs",children:d.account_number})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Titular"}),e.jsx(f,{value:o.account_holder,onChange:t=>l("account_holder",t.target.value)}),d.account_holder&&e.jsx("p",{className:"text-red-500 text-xs",children:d.account_holder})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Cédula/NIT (Opcional)"}),e.jsx(f,{value:o.holder_id,onChange:t=>l("holder_id",t.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Sede Asociada (Multisede)"}),e.jsxs(_,{value:o.location_id.toString(),onValueChange:t=>l("location_id",t),children:[e.jsx(y,{className:"bg-slate-50 border-primary/20 focus:ring-primary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-primary"}),e.jsx(C,{placeholder:"Todas las sedes (Global)"})]})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"Todas las sedes (Global)"}),n.map(t=>e.jsx(a,{value:t.id.toString(),children:t.name},t.id))]})]}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Si seleccionas una sede, esta cuenta solo aparecerá en pedidos de esa sede."})]}),e.jsx(ee,{children:e.jsxs(v,{type:"submit",disabled:p||b,className:"cursor-pointer",children:[p?e.jsx(se,{className:"mr-2 size-4 animate-spin"}):null,"Guardar Cuenta"]})})]})]})})}function Se({isOpen:i,onClose:u,account:n,locations:h,tenant:b}){const{data:o,setData:l,put:S,processing:p,errors:N}=K({bank_name:n.bank_name,account_type:n.account_type,account_number:n.account_number,account_holder:n.account_holder,holder_id:n.holder_id||"",location_id:n.location_id??"all",is_active:n.is_active}),d=r=>{r.preventDefault(),S(route("tenant.payment-methods.accounts.update",{tenant:b.slug,account:n.id}),{onSuccess:()=>{x.success("Cuenta actualizada"),u()},onError:()=>x.error("Revisa los campos del formulario")})};return e.jsx(Q,{open:i,onOpenChange:u,children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsx(Z,{children:"Editar Cuenta"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Banco"}),e.jsxs(_,{value:o.bank_name,onValueChange:r=>l("bank_name",r),children:[e.jsx(y,{children:e.jsx(C,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"Nequi",children:"Nequi"}),e.jsx(a,{value:"Daviplata",children:"Daviplata"}),e.jsx(a,{value:"Bancolombia",children:"Bancolombia"}),e.jsx(a,{value:"Davivienda",children:"Davivienda"}),e.jsx(a,{value:"BBVA",children:"BBVA"}),e.jsx(a,{value:"Bre-b",children:"Bre-b"}),e.jsx(a,{value:"Otros",children:"Otros"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tipo"}),e.jsxs(_,{value:o.account_type,onValueChange:r=>l("account_type",r),children:[e.jsx(y,{children:e.jsx(C,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"Ahorros",children:"Ahorros"}),e.jsx(a,{value:"Corriente",children:"Corriente"}),e.jsx(a,{value:"Depósito Electrónico",children:"Depósito Electrónico"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Número"}),e.jsx(f,{value:o.account_number,onChange:r=>l("account_number",r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Titular"}),e.jsx(f,{value:o.account_holder,onChange:r=>l("account_holder",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"ID (Opcional)"}),e.jsx(f,{value:o.holder_id,onChange:r=>l("holder_id",r.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Sede Asociada (Multisede)"}),e.jsxs(_,{value:o.location_id.toString(),onValueChange:r=>l("location_id",r),children:[e.jsx(y,{className:"bg-slate-50 border-primary/20 focus:ring-primary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-primary"}),e.jsx(C,{placeholder:"Todas las sedes (Global)"})]})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"Todas las sedes (Global)"}),h.map(r=>e.jsx(a,{value:r.id.toString(),children:r.name},r.id))]})]}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Si seleccionas una sede, esta cuenta solo aparecerá en pedidos de esa sede."})]}),e.jsx(ee,{children:e.jsxs(v,{type:"submit",disabled:p,className:"cursor-pointer",children:[p?e.jsx(se,{className:"mr-2 size-4 animate-spin"}):null,"Guardar Cambios"]})})]})]})})}export{$s as default};
