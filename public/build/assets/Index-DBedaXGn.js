import{c as ne,r as c,u as D,j as e,H as de,a as n,t}from"./app-B2i56772.js";import{P as me}from"./dropdown-menu-DmXnVWVS.js";import{S as pe}from"./SuperAdminLayout-BTFu4WkN.js";import{B as l}from"./button-BddZHLbc.js";import{I as V}from"./input-DBNIwXu0.js";import{S as B,a as U,b as H,c as L,d as u}from"./select-ClRMxfXi.js";import{S as xe,a as ue,b as he,c as ge}from"./sheet-BYmPEYHR.js";import{CreateFolderModal as fe}from"./CreateFolderModal-C_8d1Ctn.js";import{UploadModal as je}from"./UploadModal-CKt9Cyn8.js";import{A as ve,a as Ne,b as ye,c as be,d as we,e as Se,f as Ce,g as ke}from"./alert-dialog-yqHfK6BW.js";import{S as De}from"./Pagination-B-IYE7T4.js";import{F as Ee}from"./folder-plus-TnPg4RHR.js";import{U as Ae}from"./upload-DlD-_rs3.js";import{c as A}from"./createLucideIcon-D_eBnp1W.js";import{F as Fe}from"./file-text-gHkosXrr.js";import{V as Me,F as N}from"./video-DGfX4q0e.js";import{I as Oe}from"./image-hX5sLeF8.js";import{T as y}from"./trash-2-DFiSLFW9.js";import{S as _e}from"./search-CkZPRNJr.js";import{C as ze}from"./check-BXudH8di.js";import{E as Ie}from"./eye-K_ZbWlim.js";import{C as R}from"./copy-DKMXSA2J.js";import{H as Te}from"./hard-drive-DRrOpX07.js";import{C as Pe}from"./calendar-Ck1wG4bv.js";import{D as Ve}from"./download-D_Y8_7aS.js";import"./index-BKbrreay.js";import"./utils-DyIEM9Hy.js";import"./chevron-right-CbumkvGd.js";import"./dialog-BfzucGwq.js";import"./index-DJSPV-or.js";import"./index-ykKLN3SD.js";import"./index-DvWOdVYN.js";import"./x-B5LJUYBC.js";import"./circle-check-qwWqnypp.js";import"./credit-card-C_C5Gl_c.js";import"./shopping-bag-Bo9Pazs1.js";import"./separator-BeNm-P6u.js";import"./index-CAHj415D.js";import"./index-0TEkSQsx.js";import"./index-o5QoyLO9.js";import"./index-DBzmoSVG.js";import"./index-OfG7Dj8W.js";import"./index-BbbmFCg3.js";import"./index-DHp04QnP.js";import"./chevrons-up-down-C0cts3a0.js";import"./badge-check-D1_tuun5.js";import"./ApplicationLogo-CE-gkIYO.js";import"./users-4ML6WyRj.js";import"./layout-grid-BY7Lrn_i.js";import"./index-BdQq_4o_.js";import"./index-BdpBaZAv.js";import"./chevron-down-BDQOlKUd.js";import"./chevron-up-DBoP92CZ.js";import"./ellipsis-CHJbh5YJ.js";import"./chevron-left-C2rak3ys.js";const Be=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ue=A("archive",Be);const He=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],j=A("file",He);const Le=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Re=A("music",Le),E={image:Oe,video:Me,audio:Re,document:Fe,archive:Ue,other:j};function Js({files:F,stats:b,folders:w,filters:d}){const{auth:$}=ne().props,M=$.permissions||[],p=s=>M.includes("*")||M.includes(s),[G,m]=c.useState(!1),[h,O]=c.useState([]),[$e,Ge]=c.useState("grid"),[q,S]=c.useState(!1),[_,v]=c.useState(!1),[r,K]=c.useState(null),[J,C]=c.useState(!1),Q=c.useRef(null),[W,x]=c.useState(!1),[o,g]=c.useState(null),{data:f,setData:z,post:qe,processing:X,reset:Y}=D({files:[],folder:"uploads",description:""}),k=D({name:""});D({folder:""});const Z=s=>{s.target.files&&z("files",Array.from(s.target.files))},ee=s=>{s.preventDefault();const a=new FormData;f.files.forEach(i=>{a.append("files[]",i)}),a.append("folder",f.folder),f.description&&a.append("description",f.description),n.post(route("media.store"),a,{onSuccess:()=>{t.success("Archivos subidos correctamente"),S(!1),Y()},onError:()=>{t.error("Error al subir archivos")}})},I=s=>{if(!p("sa.media.delete")){m(!0);return}g({id:s,type:"single"}),x(!0)},se=()=>{if(h.length!==0){if(!p("sa.media.delete")){m(!0);return}g({id:h,type:"bulk"}),x(!0)}},re=s=>{if(!p("sa.media.delete")){m(!0);return}g({id:s,type:"folder"}),x(!0)},ae=()=>{o&&(o.type==="single"?n.delete(route("media.destroy",o.id),{onSuccess:()=>{t.success("Archivo eliminado"),x(!1),g(null),_&&v(!1)},onError:()=>t.error("Error al eliminar")}):o.type==="folder"?n.post(route("media.folder.delete"),{folder:o.id},{onSuccess:()=>{t.success("Carpeta eliminada"),x(!1),g(null)},onError:s=>{t.error(s?.error||"Error al eliminar carpeta")}}):n.post(route("media.bulk-delete"),{ids:o.id},{onSuccess:()=>{t.success("Archivos eliminados"),O([]),x(!1),g(null)},onError:()=>t.error("Error al eliminar")}))},T=s=>{navigator.clipboard.writeText(s),t.success("URL copiada al portapapeles")},te=s=>{O(a=>a.includes(s)?a.filter(i=>i!==s):[...a,s])},ie=s=>{K(s),v(!0)},le=s=>{if(s.preventDefault(),!p("sa.media.upload")){m(!0);return}k.post(route("media.create-folder"),{onSuccess:()=>{t.success("Carpeta creada correctamente"),C(!1),k.reset()},onError:()=>{t.error("Error al crear carpeta")}})},oe=(s,a)=>{if(!p("sa.media.upload")){m(!0);return}n.post(route("media.move",s),{folder:a},{onSuccess:()=>{t.success("Archivo movido correctamente"),v(!1)},onError:()=>{t.error("Error al mover archivo")}})},ce=s=>{if(s===0)return"0 B";const a=1024,i=["B","KB","MB","GB"],P=Math.floor(Math.log(s)/Math.log(a));return Math.round(s/Math.pow(a,P)*100)/100+" "+i[P]};return e.jsxs(pe,{header:"Gestión de Archivos",children:[e.jsx(me,{open:G,onOpenChange:m}),e.jsx(ve,{open:W,onOpenChange:x,children:e.jsxs(Ne,{children:[e.jsxs(ye,{children:[e.jsx(be,{children:o?.type==="folder"?"¿Eliminar carpeta?":o?.type==="single"?"¿Eliminar archivo?":"¿Eliminar archivos seleccionados?"}),e.jsx(we,{children:o?.type==="folder"?"Esta acción no se puede deshacer. La carpeta y TODO su contenido serán eliminados permanentemente.":o?.type==="single"?"Esta acción no se puede deshacer. El archivo será eliminado permanentemente.":`Se eliminarán ${h.length} archivos permanentemente. Esta acción no se puede deshacer.`})]}),e.jsxs(Se,{children:[e.jsx(Ce,{children:"Cancelar"}),e.jsx(ke,{onClick:ae,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})}),e.jsx(de,{title:"Gestión de Archivos"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Gestión de Archivos"}),e.jsxs("p",{className:"text-muted-foreground mt-1 text-sm",children:[b.total," archivos · ",ce(b.total_size)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",className:"gap-2",onClick:()=>{if(!p("sa.media.upload")){m(!0);return}C(!0)},children:[e.jsx(Ee,{className:"w-4 h-4"}),"Nueva Carpeta"]}),e.jsx(fe,{open:J,onOpenChange:C,form:k,onSubmit:le}),e.jsxs(l,{className:"gap-2",onClick:()=>{if(!p("sa.media.upload")){m(!0);return}S(!0)},children:[e.jsx(Ae,{className:"w-4 h-4"}),"Subir Archivos"]}),e.jsx(je,{open:q,onOpenChange:S,data:f,setData:z,onSubmit:ee,fileInputRef:Q,processing:X,folders:w,onFileSelect:Z})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(b.by_type).map(([s,a])=>{const i=E[s]||j;return e.jsx("div",{className:"bg-card rounded-xl border p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-primary/10 rounded-lg",children:e.jsx(i,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold tabular-nums leading-none mb-1",children:a}),e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:s})]})]})},s)})}),d.folder?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>n.get(route("media.index"),{...d,folder:void 0}),className:"gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(N,{className:"w-4 h-4"}),"Carpetas"]}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsxs("span",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-primary"}),d.folder]})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 lg:grid-cols-8 gap-4",children:w.map(s=>e.jsxs("div",{onClick:()=>n.get(route("media.index"),{...d,folder:s}),className:"group relative bg-card p-4 rounded-xl border border-border hover:border-primary transition-all cursor-pointer flex flex-col items-center gap-3",children:[e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(l,{size:"icon-xs",variant:"destructive",className:"rounded-full",onClick:a=>{a.stopPropagation(),re(s)},children:e.jsx(y,{className:"w-3 h-3"})})}),e.jsx("div",{className:"p-3 bg-muted rounded-2xl group-hover:bg-primary/10 transition-colors",children:e.jsx(N,{className:"w-8 h-8 text-muted-foreground group-hover:text-primary"})}),e.jsx("p",{className:"text-sm font-medium text-foreground group-hover:text-primary truncate w-full text-center px-1",children:s})]},s))}),e.jsx("div",{className:"bg-card rounded-xl border p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(V,{placeholder:"Buscar archivos...",defaultValue:d.search,onChange:s=>{n.get(route("media.index"),{...d,search:s.target.value},{preserveState:!0})},className:"pl-10"})]})}),e.jsxs(B,{value:d.type||"all",onValueChange:s=>{n.get(route("media.index"),{...d,type:s==="all"?void 0:s},{preserveState:!0})},children:[e.jsx(U,{className:"w-[180px]",children:e.jsx(H,{placeholder:"Tipo de archivo"})}),e.jsxs(L,{children:[e.jsx(u,{value:"all",children:"Todos los tipos"}),e.jsx(u,{value:"image",children:"Imágenes"}),e.jsx(u,{value:"video",children:"Videos"}),e.jsx(u,{value:"document",children:"Documentos"}),e.jsx(u,{value:"audio",children:"Audio"}),e.jsx(u,{value:"archive",children:"ArchivosComprimidos"})]})]}),h.length>0&&e.jsxs(l,{variant:"destructive",onClick:se,className:"gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"Eliminar (",h.length,")"]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-10 gap-4",children:F.data.map(s=>{const a=E[s.type]||j,i=h.includes(s.id);return e.jsxs("div",{className:`relative group bg-card rounded-xl border overflow-hidden transition-all ${i?"border-primary ring-2 ring-primary/20":"border-border hover:border-muted-foreground/30"}`,children:[e.jsx("button",{onClick:()=>te(s.id),className:`absolute top-2 left-2 z-10 w-5 h-5 rounded border transition-colors flex items-center justify-center ${i?"bg-primary border-primary":"bg-card border-border hover:border-primary"}`,children:i&&e.jsx(ze,{className:"w-3.5 h-3.5 text-primary-foreground"})}),e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:s.type==="image"?e.jsx("img",{src:s.full_url,alt:s.name,loading:"lazy",className:"w-full h-full object-cover"}):e.jsx(a,{className:"w-12 h-12 text-gray-400"})}),e.jsxs("div",{className:"p-2.5",children:[e.jsx("p",{className:"text-xs font-semibold text-foreground truncate leading-tight",title:s.name,children:s.name}),e.jsx("p",{className:"text-[10px] font-medium text-muted-foreground mt-0.5",children:s.size_human})]}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(l,{size:"sm",variant:"secondary",onClick:()=>ie(s),className:"gap-1",children:e.jsx(Ie,{className:"w-3 h-3"})}),e.jsx(l,{size:"sm",variant:"secondary",onClick:()=>T(s.full_url),className:"gap-1",children:e.jsx(R,{className:"w-3 h-3"})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>I(s.id),children:e.jsx(y,{className:"w-3 h-3"})})]})]},s.id)})}),e.jsx(De,{links:F.links,className:"mt-8"})]}),e.jsx(xe,{open:_,onOpenChange:v,children:e.jsx(ue,{className:"w-full sm:max-w-lg overflow-y-auto",children:r&&e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsx(ge,{className:"text-lg font-bold truncate pr-8",children:r.name})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsx("div",{className:"rounded-xl border bg-muted focus-visible:border-primary overflow-hidden",children:r.type==="image"?e.jsx("img",{src:r.full_url,alt:r.name,className:"w-full h-auto"}):e.jsx("div",{className:"aspect-video flex items-center justify-center",children:(()=>{const s=E[r.type]||j;return e.jsx(s,{className:"w-20 h-20 text-muted-foreground"})})()})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Información del Archivo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Tipo"}),e.jsx("p",{className:"text-sm font-semibold capitalize",children:r.type})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Te,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Tamaño"}),e.jsx("p",{className:"text-sm font-semibold",children:r.size_human})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(N,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Carpeta"}),e.jsx("p",{className:"text-sm font-semibold",children:r.folder})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Subido"}),e.jsx("p",{className:"text-sm font-semibold",children:new Date(r.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),r.uploader&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-4 h-4 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Subido por"}),e.jsx("p",{className:"text-sm font-semibold",children:r.uploader.name})]})]}),r.metadata&&Object.keys(r.metadata).length>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-4 h-4 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70",children:"Dimensiones"}),e.jsxs("p",{className:"text-sm font-semibold",children:[r.metadata.width," × ",r.metadata.height," px"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"URL Pública"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{value:r.full_url,readOnly:!0,className:"text-xs"}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>T(r.full_url),children:e.jsx(R,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Mover a Carpeta"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(B,{value:r.folder,onValueChange:s=>oe(r.id,s),children:[e.jsx(U,{className:"flex-1",children:e.jsx(H,{placeholder:"Selecciona carpeta"})}),e.jsx(L,{children:w.map(s=>e.jsx(u,{value:s,children:s},s))})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecciona una carpeta para mover este archivo"})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(l,{variant:"outline",className:"flex-1 gap-2",onClick:()=>window.open(r.full_url,"_blank"),children:[e.jsx(Ve,{className:"w-4 h-4"}),"Descargar"]}),e.jsxs(l,{variant:"destructive",className:"flex-1 gap-2",onClick:()=>{I(r.id)},children:[e.jsx(y,{className:"w-4 h-4"}),"Eliminar"]})]})]})]})]})})})]})}export{Js as default};
