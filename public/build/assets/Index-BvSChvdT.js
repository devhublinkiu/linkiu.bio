import{c as K,r as j,j as e,H as Q,L as n,a as k,t as b}from"./app-DvpAkplk.js";import{A as X}from"./AdminLayout-hY3b0G1y.js";import{P as Y}from"./dropdown-menu-ubFSrLA8.js";import{B as a}from"./button-DOQ0axlO.js";import{C as v,d as y}from"./card-CnT0l_PA.js";import{T as Z,a as $,b as P,c as d,d as ee,e as c}from"./table-U0RLv7Tr.js";import{B as D}from"./badge-IfxeRtOE.js";import{S as E}from"./switch-BXBYa__l.js";import{S as se}from"./Pagination-CS-xDxOF.js";import{A as T,a as L,b as _,c as M,d as B,e as H,f as re,g as I}from"./alert-dialog-BSAqmKQ6.js";import{M as O}from"./map-pin-BY9e0G3n.js";import{P as C}from"./plus-CtD-lmm0.js";import{S as te}from"./smartphone-C_Vrmwfp.js";import{c as ae}from"./createLucideIcon-BAweqaF3.js";import{L as F}from"./loader-circle-BM3yzWLg.js";import{E as R}from"./eye-ByEEqtKl.js";import{S as q}from"./square-pen-CeXv8eOc.js";import{T as U}from"./trash-2-Cl32KA5j.js";import"./utils-Bt66apXy.js";import"./progress-BHe2VIPc.js";import"./index-CVnMJ0kl.js";import"./index-CnuaM2Cu.js";import"./menuConfig-CS7C2xYF.js";import"./video-Diu1usog.js";import"./chef-hat-4WRp0NMl.js";import"./table-9Iw8O0xw.js";import"./user-CXZ9uqcX.js";import"./banknote-CNQnpK3Q.js";import"./star-Cq7jFrzE.js";import"./users-BDTVDblz.js";import"./calendar-check-rPKpguYk.js";import"./calendar-mikciA0V.js";import"./briefcase-5b91nXrO.js";import"./truck-SA0a2FWD.js";import"./message-circle-4blwuSBk.js";import"./credit-card-fEKVAskI.js";import"./package-D7hy5e4b.js";import"./shopping-bag-DhB74yIJ.js";import"./layout-dashboard-Cf5aFky8.js";import"./badge-check-BhvL5u0B.js";import"./lock-DHVVRGwf.js";import"./chevron-right-wq5EBuGT.js";import"./sparkles-DyQnos2U.js";import"./separator-BG2VS_Fl.js";import"./external-link-DZTE9j3y.js";import"./chevron-down-tlhr8VnY.js";import"./headphones-Bg1cPLTV.js";import"./shield-BW7u8GoI.js";import"./sonner-DgVci-2A.js";import"./index-Bw9aTihY.js";import"./index-D8KCWmzE.js";import"./index-DxV-pwI8.js";import"./index-DvNjLHaW.js";import"./circle-check-DihymiLa.js";import"./check-BnQaAa8B.js";import"./dialog-Cjxgu9dZ.js";import"./x-C_qF6Mva.js";import"./input-Bv-dfyAA.js";import"./sheet-DsGG5XCT.js";import"./index-2KDpKUG2.js";import"./index-DAaNBk-s.js";import"./index-DGLOWnr1.js";import"./index-ahKcmWZ5.js";import"./index-Dcod572x.js";import"./index-CD1tTlGF.js";import"./index-uxDWIACH.js";import"./ellipsis-TzpxLlOx.js";import"./chevron-left-CFFX0xaS.js";const ie=[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]],ne=ae("navigation-2",ie);function vs({locations:m,locations_limit:x,locations_count:S}){const{currentTenant:i,currentUserRole:p}=K().props,[t,l]=j.useState(null),[z,g]=j.useState(null),[V,h]=j.useState(!1),[u,f]=j.useState(null),N=s=>p?p.is_owner===!0||p.permissions?.includes("*")===!0||p.permissions?.includes(s)===!0:!1,w=x!==null&&S>=x,G=()=>{if(t){if(!N("locations.delete")){h(!0);return}k.delete(route("tenant.locations.destroy",[i?.slug,t.id]),{onSuccess:()=>{b.success("Sede eliminada correctamente"),l(null)},onError:s=>{const r=s?.delete??Object.values(s??{})[0],J=Array.isArray(r)?r[0]:r;l(null),g(J||"Error al eliminar la sede")}})}},A=s=>{if(!N("locations.update")){h(!0);return}f(s.id),s.is_active,k.patch(route("tenant.locations.toggle-active",[i?.slug,s.id]),{},{preserveScroll:!0,onSuccess:()=>b.success("Estado actualizado"),onError:()=>{b.error("No se pudo actualizar el estado"),f(null)},onFinish:()=>f(null)})},o=(s,r)=>{N(r)||(s.preventDefault(),s.stopPropagation(),h(!0))},W=m.data.length===0;return e.jsxs(X,{title:"Gestión de Sedes",children:[e.jsx(Q,{title:"Sedes y Puntos de Venta"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(O,{className:"size-6 text-primary"}),"Sedes y Puntos de Venta"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Administra las ubicaciones físicas de tu negocio y sus horarios.",x!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",S," / ",x," usados)"]})]})]}),w?e.jsxs(a,{className:"cursor-pointer font-bold",disabled:!0,title:"Has alcanzado el máximo de sedes permitidas en tu plan",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]}):e.jsx(n,{href:route("tenant.locations.create",i?.slug),onClick:s=>o(s,"locations.create"),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]})})]}),W?e.jsx(v,{className:"border-dashed",children:e.jsxs(y,{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-4 mb-4",children:e.jsx(O,{className:"size-12 text-primary"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"No tienes sedes registradas"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-sm",children:"Crea tu primera sede para gestionar ubicaciones, horarios y contacto."}),!w&&e.jsx(n,{href:route("tenant.locations.create",i?.slug),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Crear primera sede"]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"hidden md:block",children:e.jsx(y,{className:"p-0",children:e.jsxs(Z,{children:[e.jsx($,{className:"bg-slate-50",children:e.jsxs(P,{children:[e.jsx(d,{className:"font-bold",children:"Sede"}),e.jsx(d,{className:"font-bold",children:"Ubicación"}),e.jsx(d,{className:"font-bold",children:"Contacto"}),e.jsx(d,{className:"text-center font-bold",children:"Estado"}),e.jsx(d,{className:"text-right font-bold",children:"Acciones"})]})}),e.jsx(ee,{children:m.data.map(s=>e.jsxs(P,{className:"hover:bg-slate-50/50 transition-colors",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase tracking-wider py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col max-w-[250px]",children:[e.jsx("span",{className:"text-sm truncate",title:s.address||"—",children:s.address||"—"}),e.jsxs("span",{className:"text-xs text-muted-foreground lowercase",children:[s.city,", ",s.state]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.phone&&e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-1",children:[e.jsx(te,{className:"size-3"}),s.phone]}),s.whatsapp&&e.jsxs("div",{className:"flex items-center text-xs text-green-600 font-medium gap-1",children:[e.jsx(ne,{className:"size-3"}),"WhatsApp"]})]})}),e.jsx(c,{className:"text-center",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin ml-1 inline text-muted-foreground"})]})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})})]},s.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:m.data.map(s=>e.jsx(v,{className:"overflow-hidden",children:e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin text-muted-foreground"})]})]}),(s.address||s.city)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mb-2",children:[s.address,s.city,s.state].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex justify-end gap-1 pt-2 border-t",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})]})},s.id))}),e.jsx("div",{className:"mt-6",children:e.jsx(se,{links:m.links})})]}),e.jsx(T,{open:!!t,onOpenChange:s=>!s&&l(null),children:e.jsxs(L,{className:"border-red-100",children:[e.jsxs(_,{children:[e.jsx(M,{children:"¿Eliminar esta sede?"}),e.jsxs(B,{children:["La sede ",e.jsx("span",{className:"font-bold text-gray-900",children:t?.name})," se eliminará de forma permanente.",t&&!t.is_main&&" Se perderán los datos de contacto y ubicación asociados.",t?.is_main&&" No se puede eliminar la sede principal."]})]}),e.jsxs(H,{children:[e.jsx(re,{className:"cursor-pointer",children:"Cancelar"}),t&&!t.is_main&&e.jsx(I,{variant:"destructive",onClick:G,className:"cursor-pointer",children:"Eliminar sede"})]})]})}),e.jsx(T,{open:!!z,onOpenChange:s=>!s&&g(null),children:e.jsxs(L,{className:"border-amber-200",children:[e.jsxs(_,{children:[e.jsx(M,{children:"No se puede eliminar la sede"}),e.jsx(B,{className:"text-left",children:z})]}),e.jsx(H,{children:e.jsx(I,{onClick:()=>g(null),className:"cursor-pointer",children:"Entendido"})})]})}),e.jsx(Y,{open:V,onOpenChange:h})]})}export{vs as default};
