import{c as B,r as m,t as i,u as F,j as e,H as K,a as I}from"./app-BWcZUh_k.js";import{A as G}from"./AdminLayout-B1UOdNJe.js";import{B as n}from"./button-Bx2UyVdr.js";import{I as x}from"./input-CMGBXTtX.js";import{L as l}from"./label-BlGb-xZ5.js";import{B as N}from"./badge-CBYtAEFo.js";import{C as R,a as q,b as $,d as J}from"./card-DoCIMrrQ.js";import{S as Q,b as W,c as X,d as Y,e as Z,f as ee}from"./sheet-CXe3NyIA.js";import{S as y,a as b,b as S,c as C,d as r}from"./select-CguSXwta.js";import{A as se,a as te,b as ae,c as re,d as ie,e as ne,f as le,g as oe}from"./alert-dialog-BycbrUrL.js";import{E as ce,a as de,e as me,c as xe,d as pe}from"./empty-DgxzTnjL.js";import{P as ue}from"./dropdown-menu-CAUtCpeY.js";import{T as he}from"./textarea-D4AQxnJE.js";import{S as je}from"./search-U4xIVMWd.js";import{P as z}from"./plus-CeP7VFm4.js";import{P as ge}from"./package-CsHU_uPD.js";import{S as ve}from"./square-pen-DpRZjwi6.js";import{T as fe}from"./trash-2-CET8ErO_.js";import"./utils-kbTUnUPe.js";import"./progress-xlTaPrZn.js";import"./index-C3JqQcmO.js";import"./index-Cr5NXUSq.js";import"./menuConfig-CEHCLp95.js";import"./video-CpkL3IeV.js";import"./createLucideIcon-DfYzJ-dS.js";import"./chef-hat-BQH1ZOqC.js";import"./table-DFCKiiJU.js";import"./user-D-VQ4bLa.js";import"./map-pin-BgI0Fwjd.js";import"./banknote-7cPYNmAK.js";import"./star-cbFfhcmw.js";import"./users-DVRxXIYk.js";import"./calendar-check-wNs4LiRY.js";import"./calendar-Do7Le9Bn.js";import"./briefcase-Ba4-n3eX.js";import"./truck-YC6dQT8N.js";import"./message-circle-CIDtOzq-.js";import"./credit-card-wYINwV0d.js";import"./shopping-bag-D1_yKv0G.js";import"./layout-dashboard-MM33-NJe.js";import"./badge-check-CDye1NaZ.js";import"./lock-eVECApui.js";import"./chevron-right-BEfVsxal.js";import"./sparkles-cnY1d8ny.js";import"./separator-RbFfPp9_.js";import"./external-link-C1tvWK6f.js";import"./chevron-down-B1sQTrrJ.js";import"./headphones-Bv4Q0kgK.js";import"./shield-CH8G-oHZ.js";import"./sonner-DUQUgho7.js";import"./index-CwGn2cVl.js";import"./index-POewg-3Z.js";import"./index-DR22RqQm.js";import"./index-CjaLlWml.js";import"./x-CnE69C72.js";import"./index-BdQq_4o_.js";import"./index-DqPTcVec.js";import"./index-nDWJybZ2.js";import"./index-B74vV9QQ.js";import"./index-gldBq1zT.js";import"./index-Co3vlqbW.js";import"./check-CmqAQkxG.js";import"./chevron-up-DzivkNok.js";import"./circle-check-DQmrUMdF.js";import"./dialog-BbHe0xOg.js";import"./index-_mriArsD.js";import"./index-q6x7vkRP.js";const Ne={kg:"Kilogramos",g:"Gramos",l:"Litros",ml:"Mililitros",units:"Unidades",pieces:"Piezas"};function Os({items:p,categories:P,locations:ye,filters:u}){const{currentTenant:h,currentUserRole:j,flash:o}=B().props,[O,E]=m.useState(!1),[L,c]=m.useState(!1),[d,A]=m.useState(null),[g,k]=m.useState(null);m.useEffect(()=>{o?.error&&i.error(o.error),o?.success&&i.success(o.success)},[o?.error,o?.success]);const M=s=>j?j.is_owner||j.permissions.includes("*")||j.permissions.includes(s):!1,v=(s,a,f)=>{s&&s.preventDefault(),M(a)?f():E(!0)},t=F({name:"",sku:"",description:"",unit:"units",cost_per_unit:"",category:"",status:"active"}),_=s=>{s?(A(s),t.setData({name:s.name,sku:s.sku||"",description:s.description||"",unit:s.unit,cost_per_unit:s.cost_per_unit?.toString()||"",category:s.category||"",status:s.status})):(A(null),t.reset()),c(!0)},U=s=>{s.preventDefault(),d?t.put(route("tenant.admin.inventory.update",{tenant:h.slug,inventoryItem:d.id}),{onSuccess:()=>{c(!1),i.success("Item actualizado correctamente.")},onError:()=>{i.error("No se pudo actualizar el item. Verifica los datos.")}}):t.post(route("tenant.admin.inventory.store",{tenant:h.slug}),{onSuccess:()=>{c(!1),t.reset(),i.success("Item creado correctamente.")},onError:()=>{i.error("No se pudo crear el item. Verifica los datos.")}})},H=()=>{g&&I.delete(route("tenant.admin.inventory.destroy",{tenant:h.slug,inventoryItem:g.id}),{onSuccess:()=>{k(null),i.success("Item eliminado correctamente.")},onError:()=>{i.error("No se pudo eliminar el item.")}})},w=(s,a)=>{I.get(route("tenant.admin.inventory.index",{tenant:h.slug}),{...u,[s]:a||void 0},{preserveState:!0,preserveScroll:!0})},T=s=>!s.stocks||s.stocks.length===0?0:s.stocks.reduce((a,f)=>a+f.quantity,0),V=s=>{T(s);const a=s.stocks?.some(D=>D.is_low_stock)||!1;return s.stocks?.some(D=>D.is_out_of_stock)||!1?e.jsx(N,{variant:"outline",className:"bg-red-100 text-red-800",children:"Sin stock"}):a?e.jsx(N,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Stock bajo"}):e.jsx(N,{variant:"outline",className:"bg-green-100 text-green-800",children:"Disponible"})};return e.jsxs(G,{title:"Inventario",breadcrumbs:[{label:"Gastronomía"},{label:"Inventario"}],children:[e.jsx(K,{title:"Inventario"}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-amber-900 mb-1",children:"Módulo en proceso de implementación"}),e.jsx("p",{className:"text-sm text-amber-800",children:"Actualmente puedes gestionar el catálogo de items. La funcionalidad completa (registro de movimientos, control de stock por sede y reportes) estará disponible próximamente."})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsx(x,{type:"text",placeholder:"Buscar por nombre, SKU o categoría...",value:u.search||"",onChange:s=>w("search",s.target.value),className:"pl-10 w-[300px]"})]}),e.jsxs(y,{value:u.category||"all",onValueChange:s=>w("category",s==="all"?"":s),children:[e.jsx(b,{className:"w-[180px]",children:e.jsx(S,{placeholder:"Todas las categorías"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"Todas las categorías"}),P.map(s=>e.jsx(r,{value:s,children:s},s))]})]}),e.jsxs(y,{value:u.status||"all",onValueChange:s=>w("status",s==="all"?"":s),children:[e.jsx(b,{className:"w-[150px]",children:e.jsx(S,{placeholder:"Todos"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"Todos"}),e.jsx(r,{value:"active",children:"Activos"}),e.jsx(r,{value:"inactive",children:"Inactivos"})]})]})]}),e.jsxs(n,{onClick:s=>v(s,"inventory.create",()=>_()),children:[e.jsx(z,{className:"w-4 h-4 mr-2"})," Nuevo Item"]})]}),p.data.length===0?e.jsxs(ce,{className:"border-2 border-dashed rounded-xl bg-white py-12",children:[e.jsxs(de,{children:[e.jsx(me,{variant:"icon",children:e.jsx(ge,{className:"size-4"})}),e.jsx(xe,{children:"No hay items de inventario"}),e.jsx(pe,{children:'Empieza creando un item como "Harina 00" o "Aceite de oliva".'})]}),e.jsxs(n,{className:"mt-4",onClick:s=>v(s,"inventory.create",()=>_()),children:[e.jsx(z,{className:"w-4 h-4 mr-2"})," Crear mi primer item"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.data.map(s=>e.jsxs(R,{className:"hover:shadow-md transition-shadow",children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx($,{className:"text-base font-bold",children:s.name}),s.sku&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["SKU: ",s.sku]})]}),V(s)]})}),e.jsxs(J,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Unidad:"}),e.jsx("span",{className:"font-medium",children:Ne[s.unit]})]}),s.category&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Categoría:"}),e.jsx(N,{variant:"outline",children:s.category})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Stock Total:"}),e.jsxs("span",{className:"font-bold text-indigo-600",children:[T(s).toFixed(2)," ",s.unit]})]}),s.cost_per_unit&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Costo/Unidad:"}),e.jsxs("span",{className:"font-medium",children:["$",s.cost_per_unit.toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(n,{variant:"outline",size:"sm",className:"flex-1",onClick:a=>v(a,"inventory.update",()=>_(s)),children:[e.jsx(ve,{className:"w-3 h-3 mr-1"})," Editar"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:a=>v(a,"inventory.delete",()=>k(s)),children:e.jsx(fe,{className:"w-3 h-3"})})]})]})]},s.id))}),p.last_page>1&&e.jsx("div",{className:"flex items-center justify-center gap-2 mt-6",children:p.links.map((s,a)=>e.jsx(n,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&I.get(s.url),dangerouslySetInnerHTML:{__html:s.label}},a))})]})]}),e.jsx(Q,{open:L,onOpenChange:c,children:e.jsxs(W,{className:"overflow-y-auto",children:[e.jsxs(X,{children:[e.jsx(Y,{children:d?"Editar Item":"Nuevo Item"}),e.jsx(Z,{children:d?"Actualiza la información del item de inventario.":"Crea un nuevo item de inventario (ingrediente o insumo)."})]}),e.jsxs("form",{onSubmit:U,className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Nombre *"}),e.jsx(x,{value:t.data.name,onChange:s=>t.setData("name",s.target.value),placeholder:"Ej: Harina 00, Aceite de oliva"}),t.errors.name&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"SKU (Código)"}),e.jsx(x,{value:t.data.sku,onChange:s=>t.setData("sku",s.target.value),placeholder:"Opcional"}),t.errors.sku&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.sku})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Unidad de Medida *"}),e.jsxs(y,{value:t.data.unit,onValueChange:s=>t.setData("unit",s),children:[e.jsx(b,{children:e.jsx(S,{})}),e.jsxs(C,{children:[e.jsx(r,{value:"kg",children:"Kilogramos (kg)"}),e.jsx(r,{value:"g",children:"Gramos (g)"}),e.jsx(r,{value:"l",children:"Litros (l)"}),e.jsx(r,{value:"ml",children:"Mililitros (ml)"}),e.jsx(r,{value:"units",children:"Unidades"}),e.jsx(r,{value:"pieces",children:"Piezas"})]})]}),t.errors.unit&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.unit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Categoría"}),e.jsx(x,{value:t.data.category,onChange:s=>t.setData("category",s.target.value),placeholder:"Ej: Lácteos, Carnes, Verduras"}),t.errors.category&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.category})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Costo por Unidad (Opcional)"}),e.jsx(x,{type:"number",step:"0.01",value:t.data.cost_per_unit,onChange:s=>t.setData("cost_per_unit",s.target.value),placeholder:"0.00"}),t.errors.cost_per_unit&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.cost_per_unit}),e.jsx("p",{className:"text-xs text-slate-500",children:"Se calculará automáticamente con las compras."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Descripción"}),e.jsx(he,{value:t.data.description,onChange:s=>t.setData("description",s.target.value),placeholder:"Información adicional del item...",rows:3}),t.errors.description&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Estado *"}),e.jsxs(y,{value:t.data.status,onValueChange:s=>t.setData("status",s),children:[e.jsx(b,{children:e.jsx(S,{})}),e.jsxs(C,{children:[e.jsx(r,{value:"active",children:"Activo"}),e.jsx(r,{value:"inactive",children:"Inactivo"})]})]}),t.errors.status&&e.jsx("p",{className:"text-xs text-red-600",children:t.errors.status})]}),e.jsxs(ee,{className:"mt-6",children:[e.jsx(n,{type:"button",variant:"ghost",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(n,{type:"submit",disabled:t.processing,children:t.processing?"Guardando...":d?"Actualizar":"Crear"})]})]})]})}),e.jsx(se,{open:!!g,onOpenChange:s=>!s&&k(null),children:e.jsxs(te,{children:[e.jsxs(ae,{children:[e.jsx(re,{children:"¿Eliminar este item?"}),e.jsxs(ie,{children:["Se eliminará ",e.jsx("strong",{children:g?.name})," y todos sus registros de stock. Esta acción no se puede deshacer."]})]}),e.jsxs(ne,{children:[e.jsx(le,{children:"Cancelar"}),e.jsx(oe,{variant:"destructive",onClick:H,children:"Eliminar"})]})]})}),e.jsx(ue,{open:O,onOpenChange:E})]})}export{Os as default};
