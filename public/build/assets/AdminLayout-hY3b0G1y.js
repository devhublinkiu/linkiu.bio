import{c as L,r as m,j as e,L as g,a as Q,t as f}from"./app-DvpAkplk.js";import{c as v}from"./utils-Bt66apXy.js";import{B as M}from"./button-DOQ0axlO.js";import{B as _}from"./badge-IfxeRtOE.js";import{C as Z,d as K}from"./card-CnT0l_PA.js";import{P as ee}from"./progress-BHe2VIPc.js";import{r as se,P as W,s as te,t as ae,S as re,a as ne,C as ie,b as O,c as oe,d as R,e as le,f as ce,g as de,h as ue,v as pe,y as he,z as me,E as xe,F as A,G as B,H as T,I as U,D as F,i as z,q as V,l as $,p as y,n as H,J as fe,A as ge,j as be,k as je,m as we,o as G,L as ve,N as Ne,w as ke,x as Se}from"./dropdown-menu-ubFSrLA8.js";import{V as q,c as ye,d as _e,e as Y,f as Ce,a as Me,S as Le}from"./menuConfig-CS7C2xYF.js";import{B as Ee}from"./badge-check-BhvL5u0B.js";import{L as I}from"./lock-DHVVRGwf.js";import{C as De}from"./chevron-right-wq5EBuGT.js";import{S as J}from"./sparkles-DyQnos2U.js";import{S as Pe}from"./separator-BG2VS_Fl.js";import{E as Ae}from"./external-link-DZTE9j3y.js";import{C as Ie}from"./chevron-down-tlhr8VnY.js";import{c as Oe}from"./createLucideIcon-BAweqaF3.js";import{H as Re}from"./headphones-Bg1cPLTV.js";import{U as Be}from"./user-CXZ9uqcX.js";import{S as Te}from"./shield-BW7u8GoI.js";import{T as Ue}from"./sonner-DgVci-2A.js";const Fe=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],ze=Oe("bug",Fe),Ve={dashboard:"dashboard.view",orders:"orders.view",categories:"categories.view",products:"products.view",product_drop:"products.view",variables:"products.view",files:"media.view",sliders:"sliders.view",inventory:"inventory.view",linkiupay:"billing.view",buildiu:"buildiu.view",whatsapp:"whatsapp.view",linkiulab:"linkiulab.view",integrations:"integrations.view",shipping:"shipping_zones.view",support:"support.view",services:"services.view",agenda:"agenda.view",appointments:"appointments.view",customers:"customers.view",team:"users.view",reviews:"reviews.view",payment_methods:"payment_methods.view",coupons:"coupons.view",tickers:"tickers.view",locations:"locations.view",settings:"settings.view",roles:"roles.view",profile:"profile.view",subscription:"billing.view",billing:"billing.view",linkiu_pos:"pos.view",digital_menu:"products.view",tables:"tables.view",reservations:"reservations.view",kitchen:"kitchen.view",waiters:"waiters.view",statistics:"statistics.view",logout:"dashboard.view"};function $e(N){const{auth:C,currentTenant:r,currentUserRole:n}=L().props,[u,x]=m.useState(!1),k=t=>{const a=Ve[t];return a?n?n.is_owner?!0:n.permissions.includes("*")||n.permissions.includes(a):!1:!0},w=(t,a,l)=>k(a)?l?(t.preventDefault(),t.stopPropagation(),k("billing")?(Q.get(route("tenant.subscription.index",{tenant:r.slug})),!1):(x(!0),!1)):!0:(t.preventDefault(),t.stopPropagation(),x(!0),!1),p=(r?.vertical?.slug?.toLowerCase()||"default").normalize("NFD").replace(/[\u0300-\u036f]/g,""),E=(q[p]||q.default).map(t=>{const a=Y[t]||Y.dashboard;let l=ye[t];const c=_e[p];return c&&l&&t==="integrations"&&(l=l.filter(d=>{const h=`integration_${d.label.toLowerCase().replace("é","e")}`;return c[h]===!0})),{label:Me[t]||t,route:Ce[t]||"#",icon:a,key:t,children:l}}),D=t=>{const a=r?.latest_subscription?.plan?.features;let l={};if(Array.isArray(a)){const c=a.find(d=>typeof d=="object"&&!Array.isArray(d));c&&(l=c)}else typeof a=="object"&&a!==null&&(l=a);return l[t]===!1};return e.jsxs(se,{variant:"inset",...N,children:[e.jsx(W,{open:u,onOpenChange:x}),e.jsx(te,{children:e.jsx("div",{className:"px-2 py-2 group-data-[state=collapsed]:hidden",children:e.jsxs(_,{variant:"outline",className:"w-full justify-center gap-2 py-2 border-blue-200 bg-blue-50/50 text-blue-700 hover:bg-blue-100/50",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-semibold",children:"Tienda Verificada"})]})})}),e.jsx(ae,{children:e.jsx(re,{children:e.jsx(ne,{children:E.map(t=>{const a=D(t.key),l=t.route!=="#"&&route().current(t.route),c=t.children&&t.children.length>0,d=k(t.key);return e.jsx(m.Fragment,{children:c?e.jsx(ie,{asChild:!0,defaultOpen:l,className:"group/collapsible",children:e.jsxs(O,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(R,{tooltip:t.label,isActive:l,onClick:h=>w(h,t.key,a),children:[e.jsx(t.icon,{className:v(!d&&"text-red-500")}),e.jsx("span",{className:v(!d&&"text-red-600 font-medium"),children:t.label}),d?a?e.jsx(_,{className:"ml-auto h-5 px-1.5 text-[10px] font-bold bg-amber-100 text-amber-700 border-amber-200 hover:bg-amber-100",children:"PRO"}):e.jsx(De,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}):e.jsx(I,{className:"ml-auto h-3.5 w-3.5 text-red-500 animate-pulse"})]})}),e.jsx(le,{children:e.jsx(ce,{children:t.children?.map(h=>e.jsx(de,{children:e.jsx(ue,{asChild:!0,children:e.jsxs(g,{href:d?a?route("tenant.subscription.index",{tenant:r.slug}):h.route==="#"?"#":route(h.route,{tenant:r.slug}):"#",onClick:P=>w(P,t.key,a),children:[e.jsx("span",{children:h.label}),d?a&&e.jsx(_,{className:"ml-auto h-4 px-1 text-[9px] font-bold bg-amber-100 text-amber-700 border-amber-200",children:"PRO"}):e.jsx(I,{className:"ml-auto h-3 w-3 text-red-500"})]})})},h.label))})})]})}):e.jsx(O,{children:e.jsx(R,{asChild:!0,tooltip:t.label,isActive:l,onClick:h=>w(h,t.key,a),children:e.jsxs(g,{href:d?a?route("tenant.subscription.index",{tenant:r.slug}):t.route==="#"?"#":route(t.route,{tenant:r.slug}):"#",children:[e.jsx(t.icon,{className:v(!d&&"text-red-500")}),e.jsx("span",{className:v(!d&&"text-red-600 font-medium"),children:t.label}),d?a&&e.jsx(_,{className:"ml-auto h-5 px-1.5 text-[10px] font-bold bg-amber-100 text-amber-700 border-amber-200 hover:bg-amber-100",children:"PRO"}):e.jsx(I,{className:"ml-auto h-3.5 w-3.5 text-red-500"})]})})})},t.key)})})})}),e.jsx(pe,{children:r?.latest_subscription&&e.jsxs("div",{className:"p-2",children:[e.jsx(Z,{className:"group-data-[state=collapsed]:hidden border-purple-200/50 bg-gradient-to-br from-purple-50 via-white to-blue-50",children:e.jsxs(K,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{variant:"secondary",className:"bg-purple-100 text-purple-700 hover:bg-purple-200",children:r.latest_subscription.plan?.name||"Pro"}),e.jsx(_,{variant:"outline",className:v(r.latest_subscription.days_remaining<=3&&"border-red-200 text-red-600"),children:r.latest_subscription.status==="trialing"?`${r.latest_subscription.trial_days_remaining} días`:`${r.latest_subscription.days_remaining} días`})]}),e.jsx(ee,{value:Math.max(5,r.latest_subscription.percent_completed)}),e.jsx(M,{asChild:!0,className:"w-full",children:e.jsxs(g,{href:route("tenant.subscription.index",{tenant:r.slug}),onClick:t=>w(t,"subscription",!1),children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Ver planes"]})})]})}),e.jsx("div",{className:"hidden group-data-[state=collapsed]:flex justify-center",children:e.jsx(g,{href:route("tenant.subscription.index",{tenant:r.slug}),children:e.jsx(J,{className:"h-5 w-5 text-purple-500"})})})]})})]})}function He({title:N,breadcrumbs:C}){const{auth:r,currentTenant:n,currentUserRole:u}=L().props,x=r?.user;L().url,u?.label,u?.is_owner;const[k,w]=m.useState(!1),b=s=>u?u.is_owner?!0:u.permissions.includes(s)||u.permissions.includes("*"):!1,p=(s,o)=>{b(o)||(s.preventDefault(),w(!0))},[j,E]=m.useState("");m.useEffect(()=>{E(window.location.host)},[]);const D=n?`${j}/${n.slug}`:j,[t,a]=m.useState(r?.notifications?.unread_count||0),[l,c]=m.useState(r?.notifications?.recent||[]),[d,h]=m.useState(!1);m.useEffect(()=>{r?.notifications&&(a(r.notifications.unread_count),c(r.notifications.recent))},[r?.notifications]),m.useEffect(()=>{window.Echo&&n?.id&&window.Echo.channel(`tenant-updates.${n.id}`).listen(".invoice.generated",s=>{f.info("¡Nueva factura generada!",{description:s.message}),a(i=>i+1);const o={id:Math.random().toString(),data:{message:s.message,type:"invoice_generated",url:s.url},created_at:new Date().toISOString(),read_at:null};c(i=>[o,...i.slice(0,4)])}).listen(".payment.status_updated",s=>{s.status==="paid"?f.success("¡Pago Aprobado!",{description:s.message}):f.error("Pago Rechazado",{description:s.message}),a(S=>S+1);const i={id:Math.random().toString(),data:{message:s.message,type:"payment_status_updated",url:s.url},created_at:new Date().toISOString(),read_at:null};c(S=>[i,...S.slice(0,4)])}).listen(".icon.status_updated",s=>{s.status==="approved"?f.success("¡Icono Aprobado!",{description:s.message}):f.error("Icono Rechazado",{description:s.message}),a(S=>S+1);const i={id:Math.random().toString(),data:{message:s.message,type:"icon_status_updated",url:s.url},created_at:new Date().toISOString(),read_at:null};c(S=>[i,...S.slice(0,4)])}).listen(".ticket.replied",s=>{if(s.is_staff){f.info("Nueva respuesta de soporte",{description:s.message,action:{label:"Ver",onClick:()=>window.location.href=route("tenant.support.show",{tenant:n.slug,support:s.ticket_id})}}),a(i=>i+1);const o={id:Math.random().toString(),data:{...s,type:"ticket_replied"},created_at:new Date().toISOString(),read_at:null};c(i=>[o,...i.slice(0,4)])}}).listen(".ticket.assigned",s=>{console.log("[Echo] Received .ticket.assigned event:",s),f.success("Ticket asignado",{description:s.message,action:{label:"Ver",onClick:()=>window.location.href=route("tenant.support.show",{tenant:n.slug,support:s.ticket_id})}}),a(i=>i+1);const o={id:Math.random().toString(),data:{...s,type:"ticket_assigned"},created_at:new Date().toISOString(),read_at:null};c(i=>[o,...i.slice(0,4)])})},[n?.id]);const P=s=>{c(o=>o.map(i=>i.id===s?{...i,read_at:new Date().toISOString()}:i)),a(o=>Math.max(0,o-1))},X=()=>{c(s=>s.map(o=>({...o,read_at:new Date().toISOString()}))),a(0)};return e.jsxs("header",{className:"h-14 bg-white/80 backdrop-blur-md border-b sticky top-0 z-40 transition-all duration-300",children:[e.jsx(W,{open:k,onOpenChange:w}),e.jsxs("div",{className:"h-full px-4 sm:px-8 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"-ml-1 md:hidden"}),e.jsx(me,{children:e.jsxs(xe,{children:[e.jsx(A,{className:"hidden md:block",children:e.jsx(B,{asChild:!0,children:e.jsx(g,{href:route("tenant.dashboard",{tenant:n.slug}),children:"Panel"})})}),e.jsx(T,{className:"hidden md:block"}),C?C.map((s,o)=>e.jsxs(m.Fragment,{children:[e.jsx(A,{children:s.href?e.jsx(B,{asChild:!0,children:e.jsx(g,{href:s.href,children:s.label})}):e.jsx(U,{children:s.label})}),o<C.length-1&&e.jsx(T,{})]},o)):e.jsx(A,{children:e.jsx(U,{children:N})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx(M,{asChild:!0,children:e.jsxs("a",{href:n?`//${D}`:"#",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ae,{}),"Ver Tienda"]})}),e.jsxs(F,{children:[e.jsx(z,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(M,{variant:"ghost",children:[e.jsx(V,{}),"Ayuda",e.jsx(Ie,{})]})}),e.jsxs($,{align:"end",children:[e.jsxs(y,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx(ze,{className:"w-4 h-4 text-rose-500"}),"Reportar error"]}),e.jsxs(y,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx(V,{className:"w-4 h-4 text-amber-500"}),"Tutoriales"]}),e.jsx(H,{}),e.jsxs(y,{className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:[e.jsx(Re,{className:"w-4 h-4"}),"Hablar con asesor"]})]})]}),e.jsx(Pe,{orientation:"vertical",className:"h-6 hidden sm:block"}),e.jsxs(M,{variant:"ghost",size:"icon",className:"relative text-muted-foreground hover:text-foreground",onClick:()=>h(!0),children:[e.jsx(fe,{className:"h-5 w-5"}),t>0&&e.jsx("span",{className:"absolute top-2 right-2 h-2 w-2 bg-rose-500 rounded-full border-2 border-white animate-pulse"})]}),e.jsxs(F,{children:[e.jsx(z,{asChild:!0,className:"outline-none ring-0",children:e.jsx(M,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:e.jsxs(ge,{className:"h-8 w-8",children:[e.jsx(be,{src:x?.profile_photo_url,alt:x?.name}),e.jsx(je,{children:x?.name?.charAt(0)})]})})}),e.jsxs($,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(we,{className:"font-normal border-b pb-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold leading-none",children:x?.name}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:x?.email}),e.jsx(_,{variant:"outline",className:"w-fit text-[10px] py-0",children:u?.label||"Linkiu Member"})]})}),e.jsxs(G,{className:"py-1",children:[e.jsx(y,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(g,{href:n?route("tenant.profile.edit",{tenant:n.slug}):"#",onClick:s=>p(s,"profile.view"),children:[e.jsx(Be,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Mi Perfil"})]})}),e.jsx(y,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(g,{href:n?route("tenant.settings.edit",{tenant:n.slug}):"#",onClick:s=>p(s,"settings.view"),children:[e.jsx(Le,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Configuración"})]})}),e.jsx(y,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none",children:e.jsxs(g,{href:n?route("tenant.roles.index",{tenant:n.slug}):"#",onClick:s=>p(s,"roles.view"),children:[e.jsx(Te,{className:"mr-3 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Roles y Permisos"})]})})]}),e.jsx(H,{className:"bg-slate-50"}),e.jsx(G,{children:e.jsx(y,{asChild:!0,className:"cursor-pointer ring-0 focus:ring-0 focus:outline-none text-destructive focus:text-destructive",children:e.jsxs(g,{href:n?route("tenant.logout",{tenant:n.slug}):"#",method:"post",as:"button",className:"w-full text-left",children:[e.jsx(ve,{className:"mr-3 h-4 w-4"}),"Cerrar Sesión"]})})})]})]})]})]}),e.jsx(Ne,{open:d,onOpenChange:h,notifications:l,onNotificationRead:P,onAllRead:X})]})}function Ge(){const N=new Date().getFullYear();return e.jsx("footer",{className:"py-6 px-8 bg-white border-t border-slate-100 rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[e.jsxs("span",{children:["© ",N]}),e.jsx(g,{href:"/",className:"font-bold text-slate-900 hover:text-primary transition-colors",children:"Linkiu.bio"}),e.jsx("span",{className:"hidden sm:inline text-slate-300",children:"•"}),e.jsx("span",{className:"hidden sm:inline",children:"Todos los derechos reservados."})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Privacidad"}),e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Términos"}),e.jsx("a",{href:"#",className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hover:text-primary transition-colors",children:"Soporte"})]})]})})}function ps({children:N,title:C,breadcrumbs:r,maxwidth:n="max-w-7xl",hideSidebar:u=!1,hideFooter:x=!1,hideNavbar:k=!1}){const{auth:w,flash:b,currentTenant:p}=L().props;return m.useEffect(()=>{b.success&&f.success(b.success),b.error&&f.error(b.error),b.warning&&f.warning(b.warning,{duration:8e3})},[b]),m.useEffect(()=>(typeof window<"u"&&window.Echo&&p?.id&&window.Echo.channel(`tenant.${p.id}.reservations`).listen(".reservation.created",j=>{f.info(j.message,{description:"Nueva reserva recibida",duration:1e4,action:{label:"Ver Reservas",onClick:()=>Q.get(route("tenant.admin.reservations.index",{tenant:p.slug}))}})}),()=>{try{if(typeof window<"u"&&window.Echo&&p?.id){const j=window.Echo;j.connector?.ably?.connection?.state==="connected"&&j.leave(`tenant.${p.id}.reservations`)}}catch{}}),[p?.id]),e.jsxs(ke,{children:[!u&&e.jsx($e,{}),e.jsxs(Se,{children:[!k&&e.jsx(He,{title:C,breadcrumbs:r}),e.jsxs("div",{className:v("flex-1 flex flex-col min-h-screen",!u&&"bg-slate-50/50"),children:[e.jsx("main",{className:v("flex-1 overflow-x-hidden",u?"p-0":"p-4 sm:p-8"),children:e.jsx("div",{className:v(u?"w-full":n+" mx-auto","animate-in fade-in slide-in-from-bottom-4 duration-700"),children:N})}),!x&&e.jsx(Ge,{})]})]}),e.jsx(Ue,{position:"bottom-center"})]})}export{ps as A};
