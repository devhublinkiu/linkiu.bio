import{r as d,j as e,L as q,u as G,b as W,a as Z,t as E,c as Q,H as X}from"./app-CzmtjlCW.js";import{A as J}from"./AdminLayout-8eumfWMV.js";import{C as h,a as N,b as w,d as y}from"./card-Cio2ZpWt.js";import{B as v}from"./button-DHDYV-Vu.js";import{s as L}from"./index-BsxvijQw.js";import{c}from"./utils-BH2tHD_A.js";import{C as K}from"./circle-alert-DEEKRgFJ.js";import{C as Y}from"./clock-D1X9wNgA.js";import{R as ee}from"./rocket-CgRI76YU.js";import{A}from"./arrow-right-B-ZkIkW9.js";import{a as se}from"./menuConfig-CPl-cWmx.js";import{D as te,a as ae,b as re,c as le,d as ie,e as ne}from"./dialog-CDtZpi6V.js";import{I as oe}from"./input-CkrKzdip.js";import{L as ce}from"./label-s6Z-YQDs.js";import{B as z}from"./badge-C86koyY8.js";import{S as D}from"./sparkles-p-mrIi5N.js";import{G as T}from"./globe-BMbKsIas.js";import{L as de}from"./loader-circle-CrqYqwPq.js";import{C as U}from"./check-CDpry8EA.js";import{X as me}from"./x-B2qOMX6F.js";import{Z as xe}from"./zap-DosQ5b7o.js";import{S as pe}from"./shopping-bag-BzAvYKks.js";import{U as ue}from"./users-CiV-Fhl_.js";import{S as he}from"./store-DXptSnWg.js";import"./progress-thUTkzo2.js";import"./index-CoSHAo9V.js";import"./index-B7u58P25.js";import"./dropdown-menu-CkPxOfJq.js";import"./createLucideIcon-CaH5oZCX.js";import"./chevron-right-CP3Al_6X.js";import"./index-DLCIQy2W.js";import"./index-Bik950zP.js";import"./index-tuvqS7go.js";import"./index-D4uLenfM.js";import"./circle-check-DxCp2NCp.js";import"./trash-2-D8FHOsLd.js";import"./credit-card-o3EdvoAE.js";import"./separator-C7VYnuGU.js";import"./sheet-BCCP-sjc.js";import"./index-0rkHg0Ic.js";import"./index-i2FoVhyH.js";import"./index-DewdYm7G.js";import"./index-Bdv8as05.js";import"./index-BKdn1L7U.js";import"./index-BPIYxXZn.js";import"./badge-check-bj2LNrR7.js";import"./lock-nV4mWcAC.js";import"./external-link-Ckra4gVk.js";import"./chevron-down-DmTOaxVY.js";import"./headphones-CE-eXCS3.js";import"./user-D2yrztw3.js";import"./shield-1cQx-8mE.js";import"./sonner-CR6Tr01l.js";import"./video-C_obWpYx.js";import"./chef-hat-DMkmJSds.js";import"./table-BzVM_9Rr.js";import"./map-pin-BE5u9cGW.js";import"./banknote-B4QtVHv_.js";import"./star-BWFeNTek.js";import"./calendar-check-BhZMHGo-.js";import"./calendar-CLz13BXv.js";import"./briefcase-BgyLfkCE.js";import"./truck-BuohTmzx.js";import"./message-circle-BMB1KwoB.js";import"./package-A6FRi7Sy.js";import"./layout-dashboard-C295RkTP.js";function fe({tenant:s}){const[f,r]=d.useState(""),[l,u]=d.useState(!1);return d.useEffect(()=>{if(!s?.trial_ends_at)return;const m=setInterval(()=>{const x=new Date().getTime(),p=new Date(s.trial_ends_at).getTime()-x;if(p<=0){u(!0),r("Expirado"),clearInterval(m);return}const i=Math.floor(p/(1e3*60*60)),n=Math.floor(p%(1e3*60*60)/(1e3*60));i>0?r(`${i}h ${n}m`):r(`${n}m`)},1e3*60);return()=>clearInterval(m)},[s?.trial_ends_at]),!s?.trial_ends_at||s?.latest_subscription&&s?.latest_subscription?.status!=="pending"?null:e.jsxs(h,{className:c("relative overflow-hidden border-none shadow-lg animate-in fade-in slide-in-from-top-4 duration-500",l?"bg-destructive/10 border-destructive/20":"bg-gradient-to-r from-blue-600 to-indigo-700"),children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 -mr-20 -mt-20 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative p-5 sm:p-6 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-center md:text-left",children:[e.jsx("div",{className:c("w-12 h-12 rounded-2xl flex items-center justify-center shadow-inner shrink-0",l?"bg-destructive/20 text-destructive":"bg-white/10 text-white"),children:l?e.jsx(K,{className:"w-6 h-6"}):e.jsx(Y,{className:"w-6 h-6 animate-pulse"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:c("text-lg font-black tracking-tight",l?"text-destructive":"text-white"),children:l?"Tu periodo de configuraci√≥n ha expirado":"Tu ventana de lanzamiento est√° activa"}),e.jsx("p",{className:c("text-sm font-medium opacity-90",l?"text-destructive/80":"text-white/80"),children:l?"Para que tus clientes puedan comprar, necesitas activar un plan ahora.":`Tienes ${f} para configurar y lanzar tu tienda.`})]})]}),e.jsx("div",{className:"flex items-center gap-3 shrink-0",children:e.jsx(q,{href:L("tenant.subscription.index",{tenant:s.slug}),children:e.jsxs(v,{variant:l?"destructive":"secondary",className:"font-bold shadow-sm active:scale-95 transition-all group px-6",children:[e.jsx(ee,{className:"w-4 h-4 mr-2 group-hover:rotate-12 transition-transform"}),l?"Activar ahora":"Elegir un Plan",e.jsx(A,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})})]})]})}function ge({tenant:s,plans:f}){const[r,l]=d.useState(!1),[u,m]=d.useState("search"),[x,j]=d.useState("monthly"),[p,i]=d.useState(!1),[n,C]=d.useState(null),[b,t]=d.useState(null),{data:o,setData:k,post:P,processing:_}=G({slug:s?.slug?.replace(/-\d{4}$/,"")||"",plan_id:null,billing_cycle:"monthly"});d.useEffect(()=>{r&&o.slug&&u==="search"&&R(o.slug)},[r]);const O=/-\d{4}$/.test(s?.slug||""),F=s?.trial_ends_at?new Date(s.trial_ends_at)>new Date:!1,S=!!(s?.latest_subscription?.plan?.allow_custom_slug&&s?.latest_subscription?.status==="active"),B=S||F;if(!O)return null;const I=a=>{const g=a.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-");k("slug",g),R(g)},R=async a=>{i(!0),t(null),C(null);try{const g=await W.post(L("onboarding.validate"),{field:"slug",value:a});g.data.valid?C(!0):(C(!1),t(g.data.message))}catch(g){console.error(g)}finally{i(!1)}},M=a=>{Z.post(L("tenant.subscription.change-plan",{tenant:s.slug}),{slug:o.slug,plan_id:a,billing_cycle:x},{onSuccess:()=>{l(!1),E.success("¬°Plan seleccionado y URL actualizada con √©xito!")},onError:g=>{E.error("Error al procesar el cambio de plan")}})},$=()=>{P(L("tenant.slug.update",{tenant:s.slug}),{onSuccess:()=>{l(!1),E.success("¬°URL y Plan actualizados con √©xito!")},onError:a=>{E.error(Object.values(a)[0])}})},V=a=>{a.preventDefault(),!b&&(S?$():m("pricing"))},H=a=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(a);return e.jsxs(e.Fragment,{children:[e.jsxs(h,{className:"p-1 border-none bg-gradient-to-r from-amber-50 to-orange-50 overflow-hidden relative group",children:[e.jsx(D,{className:"absolute -right-2 -top-2 w-12 h-12 text-amber-200/50 rotate-12 group-hover:scale-110 transition-transform"}),e.jsxs("div",{className:"p-4 sm:p-5 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center text-amber-600 shrink-0",children:e.jsx(T,{className:"w-5 h-5"})}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("h4",{className:"text-sm font-black text-slate-800 uppercase tracking-tight",children:"¬°Tu marca merece un link profesional!"}),e.jsxs("p",{className:"text-xs text-slate-500 font-medium",children:["Actualmente usas ",e.jsx("span",{className:"font-bold text-slate-700",children:s.slug}),".",B?"Reclama tu link corto ahora.":"P√°sate a Pro para eliminar los n√∫meros."]})]})]}),e.jsxs(v,{onClick:()=>l(!0),children:[S?"Personalizar URL":"Quitar n√∫meros",e.jsx(A,{className:"w-3.5 h-3.5 ml-2"})]})]})]}),e.jsx(te,{open:r,onOpenChange:a=>{l(a),a||m("search")},children:e.jsxs(ae,{className:c("rounded-[32px] border-none shadow-2xl px-8 py-6 transition-all duration-300",u==="pricing"?"sm:max-w-[700px]":"sm:max-w-[425px]"),children:[e.jsxs(re,{children:[e.jsx(le,{className:"text-2xl font-black tracking-tight flex items-center gap-2",children:u==="search"?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-6 h-6 text-primary"}),"Personaliza tu URL"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-6 h-6 text-amber-500"}),"Elige tu Plan Pro"]})}),e.jsx(ie,{className:"font-medium",children:u==="search"?"Elige una direcci√≥n web limpia y f√°cil de recordar para tus clientes.":"Activa tu link personalizado seleccionando el plan que prefieras."})]}),u==="search"?e.jsxs("form",{onSubmit:V,className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(ce,{htmlFor:"slug",className:"text-sm font-bold ml-1",children:"Nueva direcci√≥n web"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-sm",children:"linkiu.bio/"}),e.jsx(oe,{id:"slug",value:o.slug,onChange:I,placeholder:"tu-marca",className:c("h-14 pl-[85px] pr-10 rounded-2xl font-bold border-slate-100 bg-slate-50/50 transition-all text-lg",b?"ring-destructive/20 border-destructive":"focus:ring-primary/20 focus:border-primary")}),e.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[p&&e.jsx(de,{className:"w-4 h-4 text-primary animate-spin"}),!p&&n===!0&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 bg-green-500 rounded-full text-[10px] font-black text-white uppercase animate-in zoom-in duration-300",children:[e.jsx(U,{className:"w-3 h-3"}),"Disponible"]}),!p&&n===!1&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 bg-destructive rounded-full text-[10px] font-black text-white uppercase animate-in zoom-in duration-300",children:[e.jsx(me,{className:"w-3 h-3"}),"Ocupado"]})]})]}),b&&e.jsx("p",{className:"text-[11px] font-bold text-destructive ml-1",children:b})]}),e.jsxs("div",{className:"p-5 rounded-2xl bg-amber-50 border border-amber-100 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:"Estrategia de Marca"})]}),e.jsx("p",{className:"text-[11px] text-amber-900/70 font-bold leading-relaxed",children:S?"Como usuario Pro, puedes cambiar tu URL inmediatamente.":"Esta URL profesional se activar√° al elegir tu Plan Pro. ¬°Asegura tu nombre ahora!"})]}),e.jsx(ne,{children:e.jsxs(v,{type:"submit",disabled:_||p||!n||o.slug.length<3,className:"w-full h-10 font-black text-lg shadow-lg",children:[S?"Confirmar URL":"Continuar a Selecci√≥n de Plan",e.jsx(A,{className:"w-5 h-5 ml-2"})]})})]}):e.jsxs("div",{className:"py-6 space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-slate-100 p-1 rounded-2xl flex items-center gap-1",children:[e.jsx(v,{variant:x==="monthly"?"default":"ghost",size:"sm",onClick:()=>j("monthly"),className:c("h-10 px-6 rounded-xl font-black text-[10px] uppercase tracking-widest transition-all",x==="monthly"?"bg-white text-slate-900 shadow-sm":"text-slate-400"),children:"Mensual"}),e.jsxs(v,{variant:x==="yearly"?"default":"ghost",size:"sm",onClick:()=>j("yearly"),className:c("h-10 px-6 rounded-xl font-black text-[10px] uppercase tracking-widest transition-all",x==="yearly"?"bg-white text-slate-900 shadow-sm":"text-slate-400"),children:["Anual",e.jsx(z,{className:"ml-2 bg-green-500 text-[8px] py-0 px-1 border-none text-white",children:"-15%"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:f?.filter(a=>!a.name.toLowerCase().includes("free")).map(a=>e.jsx(je,{plan:a,billingCycle:x,processing:_,onSelect:M,formatCurrency:H},a.id))}),e.jsx("button",{onClick:()=>m("search"),className:"w-full text-center text-sm font-bold text-slate-900 hover:text-slate-600 transition-colors",children:"‚Üê Volver a buscar URL"})]})]})})]})}function je({plan:s,billingCycle:f,processing:r,onSelect:l,formatCurrency:u}){const[m,x]=d.useState(!1),j=s.name.toLowerCase().includes("pro"),p=f==="yearly"?s.yearly_price:s.monthly_price,i=s.features;let n=[];Array.isArray(i)?i.forEach(t=>{typeof t=="string"?n.push(t):typeof t=="object"&&t!==null&&Object.keys(t).forEach(o=>{(t[o]===!0||t[o]===1||t[o]==="1")&&n.push(o)})}):typeof i=="object"&&i!==null&&Object.keys(i).forEach(t=>{(i[t]===!0||i[t]===1||i[t]==="1")&&n.push(t)});const C=m?n:n.slice(0,5),b=n.length>5;return e.jsx(h,{className:c("p-6 rounded-3xl border-2 transition-all cursor-pointer group hover:scale-[1.02]",j?"border-primary bg-primary/5 shadow-xl shadow-primary/5":"border-slate-100"),onClick:()=>!r&&l(s.id),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h5",{className:"font-black uppercase tracking-tighter text-lg",children:s.name}),j&&e.jsx(z,{className:"bg-primary text-[8px] animate-pulse whitespace-nowrap",children:"RECOMENDADO"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-black",children:u(p)}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:["/",f==="monthly"?"mes":"a√±o"]})]}),e.jsx("ul",{children:C.map((t,o)=>{const k=t.startsWith("-"),P=k?t.substring(1):t,_=se[P]||P;return e.jsxs("li",{className:c("flex items-center gap-2 text-[11px] font-medium text-left",k?"text-slate-300 line-through":"text-slate-600"),children:[e.jsx(U,{className:c("w-3 h-3 shrink-0",k?"text-slate-200":"text-green-500")}),e.jsx("span",{className:"flex-1",children:_})]},o)})}),b&&e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),x(!m)},className:"w-full text-center text-[10px] font-black text-primary uppercase tracking-tight hover:underline flex items-center justify-center gap-1",children:m?"Ver menos":`Ver ${n.length-5} m√°s`}),e.jsx(v,{className:c(j?"bg-primary text-white":"w-full"),disabled:r,children:r?"Procesando...":"Seleccionar Plan"})]})})}function Ds({plans:s}){const{auth:f,currentTenant:r}=Q().props;return e.jsxs(J,{title:"Panel de Control",children:[e.jsx(X,{title:`Dashboard - ${r?.name||"Cargando..."}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(fe,{tenant:r}),e.jsx(ge,{tenant:r,plans:s}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("h2",{className:"text-2xl font-bold tracking-tight",children:["¬°Hola, ",f?.user?.name?.split(" ")[0]||"Usuario","! üëã"]}),e.jsxs("p",{className:"text-slate-500",children:["Bienvenido al centro de control de ",e.jsx("span",{className:"font-semibold text-slate-900",children:r?.name||"tu tienda"}),"."]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(h,{className:"border-none shadow-sm shadow-blue-100/50",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Ventas Totales"}),e.jsx(xe,{className:"h-4 w-4 text-primary"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"$0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+0% desde el mes anterior"})]})]}),e.jsxs(h,{className:"border-none shadow-sm shadow-blue-100/50",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Pedidos Nuevos"}),e.jsx(pe,{className:"h-4 w-4 text-primary"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+0 desde ayer"})]})]}),e.jsxs(h,{className:"border-none shadow-sm shadow-blue-100/50",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Clientes"}),e.jsx(ue,{className:"h-4 w-4 text-primary"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+0 nuevos este mes"})]})]}),e.jsxs(h,{className:"border-none shadow-sm shadow-blue-100/50",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Estado Tienda"}),e.jsx(he,{className:"h-4 w-4 text-primary"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Activa"}),e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Todo funciona correctamente"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[e.jsxs(h,{className:"col-span-4 border-none shadow-sm shadow-blue-100/50",children:[e.jsx(N,{children:e.jsx(w,{children:"Resumen de Actividad"})}),e.jsx(y,{className:"h-[200px] flex items-center justify-center border-2 border-dashed border-slate-100 rounded-xl m-1",children:e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Pronto ver√°s gr√°ficas de tus ventas aqu√≠"})})]}),e.jsxs(h,{className:"col-span-3 border-none shadow-sm shadow-blue-100/50",children:[e.jsx(N,{children:e.jsx(w,{children:"√öltimos Pedidos"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"p-8 text-center border-2 border-dashed border-slate-100 rounded-xl",children:e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"A√∫n no tienes pedidos"})})})})]})]})]})]})}export{Ds as default};
