import{u as z,r as f,j as e,H as G,L as H,a as $}from"./app-C6YMifTY.js";import{S as K}from"./SuperAdminLayout-owz7kWkR.js";import{B as x}from"./button-BdaJZ0B3.js";import{I as c}from"./input-Eblj3hbc.js";import{L as i}from"./label-D24g5yt_.js";import{T as W}from"./textarea-eT7ADchW.js";import{C as u,a as h,b as j,c as v,d as g}from"./card-B5tRKjHS.js";import{S as C,a as F,b as w,c as S,d as p}from"./select-kSnTiJyt.js";import{S as N}from"./switch-DYamz3TF.js";import{S as Y}from"./separator-BXKUKxOr.js";import{C as J}from"./checkbox-TBe_blUS.js";import{F as m}from"./field-Bkn0mlvj.js";import{M as Q,C as X}from"./MediaInput-D4XWKS2j.js";import{V as E,M as q,a as Z,L as ee}from"./menuConfig-DAYmXPHE.js";import{A as se}from"./arrow-left-KKKNVQlU.js";import{T as re}from"./trash-2-CdCRBxCQ.js";import{P as ae}from"./plus-Cqh028Vl.js";import"./dropdown-menu-SOMavdwh.js";import"./createLucideIcon-BySXGuRP.js";import"./index-BfC7CqbM.js";import"./utils-DyIEM9Hy.js";import"./chevron-right-C535Mj24.js";import"./dialog-IMN9tC2d.js";import"./index-Br9IGBm2.js";import"./index-E7WpQLQ8.js";import"./index-4n3Yzccs.js";import"./x-a1jEoxTs.js";import"./circle-check-nEbbNZYN.js";import"./check-C1SVBju5.js";import"./credit-card-DgCsg7Hg.js";import"./shopping-bag-Dvb7bWDl.js";import"./sheet-DSRsPMRX.js";import"./index-CpLyPKqI.js";import"./index-CYR4JIyf.js";import"./index-DiNYh9qr.js";import"./index-BqTUZrhs.js";import"./index-CZchoUT1.js";import"./index-FjXa2hFn.js";import"./index-qUve72FO.js";import"./chevrons-up-down-JhLTbBEJ.js";import"./badge-check-CV7QNrff.js";import"./ApplicationLogo-D_xOgOcd.js";import"./users-DrSXnRGz.js";import"./layout-grid-Sb-Eozqq.js";import"./index-BdQq_4o_.js";import"./index-D2SAaREN.js";import"./chevron-down-BPnUVb9f.js";import"./chevron-up-B3-_n9Ts.js";import"./MediaManagerModal-C57vdeD2.js";import"./scroll-area-BSN-kh5u.js";import"./alert-dialog-Bn8EVXlc.js";import"./empty-CoolEd1D.js";import"./upload-OkBc58Wx.js";import"./search-DJAv3Kik.js";import"./loader-circle-D53sf_hQ.js";import"./folder-plus-KRKeR-hq.js";import"./download-CfO00_Tl.js";import"./image-DjvMMtqO.js";import"./video-C0Ywn_TJ.js";import"./chef-hat-DCJyIcCS.js";import"./table-D42HSQkY.js";import"./user-DitzkkBA.js";import"./map-pin-mNUy7ITu.js";import"./banknote-S0aL_sZI.js";import"./star-DamxJ_Yp.js";import"./calendar-check-DYxKrS9Z.js";import"./calendar-BZ8a-Bsy.js";import"./briefcase-CsKd1tC9.js";import"./truck-9WCJqKH5.js";import"./message-circle-N4NBu5OJ.js";import"./package-CrEPQoFv.js";import"./layout-dashboard-C-FjtN6k.js";function bs({verticals:P}){const{data:r,setData:t,post:te,processing:I,errors:n}=z({name:"",slug:"",vertical_id:"",description:"",monthly_price:"",currency:"COP",quarterly_discount_percent:0,semiannual_discount_percent:0,yearly_discount_percent:0,trial_days:0,no_initial_payment_required:!1,support_level:"standard",allow_custom_slug:!0,is_public:!0,is_featured:!1,highlight_text:"",sort_order:0,cover:null,cover_path:"",cover_preview:null,features:[""]}),[_,L]=f.useState({}),[D,k]=f.useState({});f.useEffect(()=>{const s=r.name.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"");t("slug",s)},[r.name]);const M=(s,a)=>{const l=[...r.features];l[s]=a,t("features",l)},O=()=>{t("features",[...r.features,""])},T=s=>{const a=r.features.filter((l,o)=>o!==s);t("features",a)},y=(s,a)=>(parseFloat(r.monthly_price)||0)*s*(1-a/100);f.useEffect(()=>{if(r.vertical_id){const s=P.find(a=>a.id.toString()===r.vertical_id);if(s){let a=s.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");E[a]||(a="default");const l=E[a]||[],o={};l.forEach(d=>{o[d]=!0}),L(o)}}},[r.vertical_id]);const A=(s,a)=>{L(l=>({...l,[s]:a}))},V=(s,a)=>{k(l=>({...l,[s]:a}))},B=s=>{s.preventDefault();const l=[...r.features.filter(d=>typeof d=="string"&&d.trim()!==""),_],o={};Object.entries(D).forEach(([d,R])=>{const b=parseInt(R);if(!isNaN(b)&&b>0){const U=ee[d]??d;o[U]=b}}),$.post(route("plans.store"),{...r,features:l,limits:Object.keys(o).length>0?o:null})};return e.jsxs(K,{header:"Crear Nuevo Plan",children:[e.jsx(G,{title:"Crear Plan"}),e.jsxs("div",{className:"max-w-4xl mx-auto py-6",children:[e.jsx(x,{variant:"ghost",className:"mb-4 pl-0 hover:bg-transparent",asChild:!0,children:e.jsxs(H,{href:route("plans.index"),className:"flex items-center gap-2 text-muted-foreground hover:text-gray-900",children:[e.jsx(se,{className:"h-4 w-4"}),"Volver al listado"]})}),e.jsxs("form",{onSubmit:B,className:"space-y-8",children:[e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Información Básica"}),e.jsx(v,{children:"Detalles principales del plan y su vertical asociada."})]}),e.jsxs(g,{className:"grid gap-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"vertical",children:"Vertical de Negocio"}),e.jsxs(C,{value:r.vertical_id,onValueChange:s=>t("vertical_id",s),children:[e.jsx(F,{children:e.jsx(w,{placeholder:"Selecciona una vertical"})}),e.jsx(S,{children:P.map(s=>e.jsx(p,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(m,{children:n.vertical_id})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"currency",children:"Moneda"}),e.jsxs(C,{value:r.currency,onValueChange:s=>t("currency",s),children:[e.jsx(F,{children:e.jsx(w,{placeholder:"Moneda"})}),e.jsxs(S,{children:[e.jsx(p,{value:"COP",children:"Peso Colombiano (COP)"}),e.jsx(p,{value:"USD",children:"Dólar Americano (USD)"})]})]}),e.jsx(m,{children:n.currency})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"name",children:"Nombre del Plan"}),e.jsx(c,{id:"name",value:r.name,onChange:s=>t("name",s.target.value),placeholder:"Ej. Plan Emprendedor",required:!0}),e.jsx(m,{children:n.name})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"slug",children:"Slug (URL amigable)"}),e.jsx(c,{id:"slug",value:r.slug,onChange:s=>t("slug",s.target.value),placeholder:"plan-emprendedor",required:!0}),e.jsx(m,{children:n.slug})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"description",children:"Descripción Corta"}),e.jsx(W,{id:"description",value:r.description,onChange:s=>t("description",s.target.value),placeholder:"Breve descripción que aparecerá en la tarjeta del plan."}),e.jsx(m,{children:n.description})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{children:"Imagen de Portada / Icono"}),e.jsx(Q,{value:r.cover_preview,onChange:(s,a)=>{t(s?l=>({...l,cover_preview:s,cover_path:a?.path||""}):l=>({...l,cover_preview:null,cover_path:""}))},error:n.cover}),e.jsx("p",{className:"text-[0.75rem] text-muted-foreground mt-1",children:"Recomendado: 800x600px o Icono SVG."}),e.jsx(m,{children:n.cover})]})]})]}),e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-blue-600"}),e.jsx(j,{children:"Motor de Precios"})]}),e.jsx(v,{children:"Define el precio base mensual y los descuentos por permanencia."})]}),e.jsx(g,{className:"space-y-8",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[e.jsxs("div",{className:"p-6 bg-blue-50/50 rounded-xl border border-blue-100 flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"monthly_price",className:"text-base font-semibold text-blue-900",children:"Precio Base Mensual"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("span",{className:"absolute left-3 top-2.5 font-bold text-gray-500",children:"$"}),e.jsx(c,{id:"monthly_price",type:"number",min:"0",step:"0.01",className:"pl-8 text-lg font-bold",placeholder:"0.00",value:r.monthly_price,onChange:s=>t("monthly_price",s.target.value),required:!0})]}),e.jsx("p",{className:"text-xs text-blue-600/80 mt-1",children:"Este es el precio que pagará el usuario si elige facturación mes a mes."}),e.jsx(m,{children:n.monthly_price})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm uppercase tracking-wide",children:"Descuentos por Periodo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-40 flex-shrink-0 flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"quarterly",className:"text-xs text-gray-500 uppercase",children:"Trimestral (-%)"}),e.jsxs("div",{className:"relative mt-0.5",children:[e.jsx(c,{id:"quarterly",type:"number",min:"0",max:"100",value:r.quarterly_discount_percent,onChange:s=>t("quarterly_discount_percent",parseInt(s.target.value)||0)}),e.jsx("span",{className:"absolute right-3 top-2.5 text-xs font-bold text-gray-400",children:"%"})]})]}),e.jsxs("div",{className:"flex-1 pt-4",children:[e.jsx("div",{className:"text-[0.7rem] text-gray-500 uppercase tracking-tight",children:"Precio Final / periodo"}),e.jsx("div",{className:"font-bold text-green-700 text-lg",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:r.currency}).format(y(3,r.quarterly_discount_percent))})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-40 flex-shrink-0 flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"semiannual",className:"text-xs text-gray-500 uppercase",children:"Semestral (-%)"}),e.jsxs("div",{className:"relative mt-0.5",children:[e.jsx(c,{id:"semiannual",type:"number",min:"0",max:"100",value:r.semiannual_discount_percent,onChange:s=>t("semiannual_discount_percent",parseInt(s.target.value)||0)}),e.jsx("span",{className:"absolute right-3 top-2.5 text-xs font-bold text-gray-400",children:"%"})]})]}),e.jsxs("div",{className:"flex-1 pt-4",children:[e.jsx("div",{className:"text-[0.7rem] text-gray-500 uppercase tracking-tight",children:"Precio Final / periodo"}),e.jsx("div",{className:"font-bold text-green-700 text-lg",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:r.currency}).format(y(6,r.semiannual_discount_percent))})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-40 flex-shrink-0 flex flex-col gap-1.5",children:[e.jsx(i,{htmlFor:"yearly",className:"text-xs text-gray-500 uppercase",children:"Anual (-%)"}),e.jsxs("div",{className:"relative mt-0.5",children:[e.jsx(c,{id:"yearly",type:"number",min:"0",max:"100",value:r.yearly_discount_percent,onChange:s=>t("yearly_discount_percent",parseInt(s.target.value)||0)}),e.jsx("span",{className:"absolute right-3 top-2.5 text-xs font-bold text-gray-400",children:"%"})]})]}),e.jsxs("div",{className:"flex-1 pt-4",children:[e.jsx("div",{className:"text-[0.7rem] text-gray-500 uppercase tracking-tight",children:"Precio Final / periodo"}),e.jsx("div",{className:"font-bold text-green-700 text-lg",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:r.currency}).format(y(12,r.yearly_discount_percent))})]})]})]})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(u,{className:"h-full",children:[e.jsxs(h,{children:[e.jsx(j,{children:"Características (Features)"}),e.jsx(v,{children:"Lista de beneficios que verá el usuario."})]}),e.jsxs(g,{className:"space-y-4",children:[r.features.map((s,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{value:s,onChange:l=>M(a,l.target.value),placeholder:`Característica #${a+1}`}),e.jsx(x,{type:"button",variant:"ghost",size:"icon",onClick:()=>T(a),disabled:r.features.length===1,children:e.jsx(re,{className:"h-4 w-4 text-red-400"})})]},a)),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:O,className:"w-full border-dashed",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"})," Agregar Característica"]}),e.jsx(m,{children:n.features})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs(u,{children:[e.jsx(h,{children:e.jsx(j,{children:"Configuración"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{children:"Días de Prueba Gratis"}),e.jsx(c,{type:"number",min:"0",value:r.trial_days,onChange:s=>t("trial_days",parseInt(s.target.value)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between border p-3 rounded-lg",children:[e.jsx(i,{htmlFor:"no-payment",className:"text-sm cursor-pointer",children:"Sin Tarjeta Requerida"}),e.jsx(N,{id:"no-payment",checked:r.no_initial_payment_required,onCheckedChange:s=>t("no_initial_payment_required",s)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Si se activa, el usuario inicia la prueba sin pagar."}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(i,{children:"Nivel de Soporte"}),e.jsxs(C,{value:r.support_level,onValueChange:s=>t("support_level",s),children:[e.jsx(F,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(p,{value:"basic",children:"Básico (Email)"}),e.jsx(p,{value:"priority",children:"Prioritario (24h)"}),e.jsx(p,{value:"dedicated",children:"Dedicado (WhatsApp)"})]})]})]}),e.jsx(Y,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"cursor-pointer",htmlFor:"public",children:"Público"}),e.jsx(N,{id:"public",checked:r.is_public,onCheckedChange:s=>t("is_public",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"cursor-pointer",htmlFor:"featured",children:"Plan Destacado"}),e.jsx(N,{id:"featured",checked:r.is_featured,onCheckedChange:s=>t("is_featured",s)})]}),r.is_featured&&e.jsxs("div",{className:"flex flex-col gap-1.5 pt-2 animate-in fade-in slide-in-from-top-1",children:[e.jsx(i,{children:"Texto Destacado"}),e.jsx(c,{value:r.highlight_text,onChange:s=>t("highlight_text",s.target.value),placeholder:"Ej. Más Popular"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"cursor-pointer",htmlFor:"custom-slug",children:"Slug Personalizado"}),e.jsx(N,{id:"custom-slug",checked:r.allow_custom_slug,onCheckedChange:s=>t("allow_custom_slug",s)})]})]})]})})]}),e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Permisos de Módulos"}),e.jsx(v,{children:"Define qué módulos del sidebar estarán activos para este plan y sus límites."})]}),e.jsxs(g,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.keys(_).length>0?Object.entries(_).map(([s,a])=>e.jsxs("div",{className:"flex items-center gap-3 border p-3 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx(J,{id:`mod-${s}`,checked:a,onCheckedChange:l=>A(s,l)}),e.jsx(i,{htmlFor:`mod-${s}`,className:"cursor-pointer text-sm font-medium leading-none flex-1",children:Z[s]||s}),q[s]&&e.jsx(c,{type:"number",min:0,placeholder:"∞",className:"w-20 h-8 text-xs text-center",value:D[s]||"",onChange:l=>V(s,l.target.value),title:q[s],disabled:!a})]},s)):e.jsx("p",{className:"text-sm text-gray-500 col-span-full",children:"Selecciona una vertical para ver los módulos disponibles."})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"Los campos numéricos definen el máximo permitido. Vacío = ilimitado."})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Cancelar"}),e.jsx(x,{type:"submit",disabled:I,className:"min-w-[150px]",children:I?"Guardando...":"Crear Plan"})]})]})]})]})}export{bs as default};
