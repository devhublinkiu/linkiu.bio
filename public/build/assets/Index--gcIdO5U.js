import{c as K,r as j,j as e,H as Q,L as n,a as k,t as b}from"./app-BWcZUh_k.js";import{A as X}from"./AdminLayout-B1UOdNJe.js";import{P as Y}from"./dropdown-menu-CAUtCpeY.js";import{B as a}from"./button-Bx2UyVdr.js";import{C as v,d as y}from"./card-DoCIMrrQ.js";import{T as Z,a as $,b as P,c as d,d as ee,e as c}from"./table-C6BCtdGR.js";import{B as D}from"./badge-CBYtAEFo.js";import{S as E}from"./switch-BQU6MI2J.js";import{S as se}from"./Pagination-BYMXZyEJ.js";import{A as T,a as L,b as _,c as M,d as B,e as H,f as re,g as I}from"./alert-dialog-BycbrUrL.js";import{M as O}from"./map-pin-BgI0Fwjd.js";import{P as C}from"./plus-CeP7VFm4.js";import{S as te}from"./smartphone-DW9fmofx.js";import{c as ae}from"./createLucideIcon-DfYzJ-dS.js";import{L as F}from"./loader-circle-C3slwXZV.js";import{E as R}from"./eye-B_gDcSUm.js";import{S as q}from"./square-pen-DpRZjwi6.js";import{T as U}from"./trash-2-CET8ErO_.js";import"./utils-kbTUnUPe.js";import"./progress-xlTaPrZn.js";import"./index-C3JqQcmO.js";import"./index-Cr5NXUSq.js";import"./menuConfig-CEHCLp95.js";import"./video-CpkL3IeV.js";import"./chef-hat-BQH1ZOqC.js";import"./table-DFCKiiJU.js";import"./user-D-VQ4bLa.js";import"./banknote-7cPYNmAK.js";import"./star-cbFfhcmw.js";import"./users-DVRxXIYk.js";import"./calendar-check-wNs4LiRY.js";import"./calendar-Do7Le9Bn.js";import"./briefcase-Ba4-n3eX.js";import"./truck-YC6dQT8N.js";import"./message-circle-CIDtOzq-.js";import"./credit-card-wYINwV0d.js";import"./package-CsHU_uPD.js";import"./shopping-bag-D1_yKv0G.js";import"./layout-dashboard-MM33-NJe.js";import"./badge-check-CDye1NaZ.js";import"./lock-eVECApui.js";import"./chevron-right-BEfVsxal.js";import"./sparkles-cnY1d8ny.js";import"./separator-RbFfPp9_.js";import"./external-link-C1tvWK6f.js";import"./chevron-down-B1sQTrrJ.js";import"./headphones-Bv4Q0kgK.js";import"./shield-CH8G-oHZ.js";import"./sonner-DUQUgho7.js";import"./index-CwGn2cVl.js";import"./index-POewg-3Z.js";import"./index-DR22RqQm.js";import"./index-CjaLlWml.js";import"./circle-check-DQmrUMdF.js";import"./check-CmqAQkxG.js";import"./dialog-BbHe0xOg.js";import"./x-CnE69C72.js";import"./input-CMGBXTtX.js";import"./sheet-CXe3NyIA.js";import"./index-B74vV9QQ.js";import"./index-gldBq1zT.js";import"./index-_mriArsD.js";import"./index-DqPTcVec.js";import"./index-nDWJybZ2.js";import"./index-q6x7vkRP.js";import"./index-Co3vlqbW.js";import"./ellipsis-Cjb3yZJR.js";import"./chevron-left-Dbk6k2rI.js";const ie=[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]],ne=ae("navigation-2",ie);function vs({locations:m,locations_limit:x,locations_count:S}){const{currentTenant:i,currentUserRole:p}=K().props,[t,l]=j.useState(null),[z,g]=j.useState(null),[V,h]=j.useState(!1),[u,f]=j.useState(null),N=s=>p?p.is_owner===!0||p.permissions?.includes("*")===!0||p.permissions?.includes(s)===!0:!1,w=x!==null&&S>=x,G=()=>{if(t){if(!N("locations.delete")){h(!0);return}k.delete(route("tenant.locations.destroy",[i?.slug,t.id]),{onSuccess:()=>{b.success("Sede eliminada correctamente"),l(null)},onError:s=>{const r=s?.delete??Object.values(s??{})[0],J=Array.isArray(r)?r[0]:r;l(null),g(J||"Error al eliminar la sede")}})}},A=s=>{if(!N("locations.update")){h(!0);return}f(s.id),s.is_active,k.patch(route("tenant.locations.toggle-active",[i?.slug,s.id]),{},{preserveScroll:!0,onSuccess:()=>b.success("Estado actualizado"),onError:()=>{b.error("No se pudo actualizar el estado"),f(null)},onFinish:()=>f(null)})},o=(s,r)=>{N(r)||(s.preventDefault(),s.stopPropagation(),h(!0))},W=m.data.length===0;return e.jsxs(X,{title:"Gestión de Sedes",children:[e.jsx(Q,{title:"Sedes y Puntos de Venta"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(O,{className:"size-6 text-primary"}),"Sedes y Puntos de Venta"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Administra las ubicaciones físicas de tu negocio y sus horarios.",x!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",S," / ",x," usados)"]})]})]}),w?e.jsxs(a,{className:"cursor-pointer font-bold",disabled:!0,title:"Has alcanzado el máximo de sedes permitidas en tu plan",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]}):e.jsx(n,{href:route("tenant.locations.create",i?.slug),onClick:s=>o(s,"locations.create"),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]})})]}),W?e.jsx(v,{className:"border-dashed",children:e.jsxs(y,{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-4 mb-4",children:e.jsx(O,{className:"size-12 text-primary"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"No tienes sedes registradas"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-sm",children:"Crea tu primera sede para gestionar ubicaciones, horarios y contacto."}),!w&&e.jsx(n,{href:route("tenant.locations.create",i?.slug),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Crear primera sede"]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"hidden md:block",children:e.jsx(y,{className:"p-0",children:e.jsxs(Z,{children:[e.jsx($,{className:"bg-slate-50",children:e.jsxs(P,{children:[e.jsx(d,{className:"font-bold",children:"Sede"}),e.jsx(d,{className:"font-bold",children:"Ubicación"}),e.jsx(d,{className:"font-bold",children:"Contacto"}),e.jsx(d,{className:"text-center font-bold",children:"Estado"}),e.jsx(d,{className:"text-right font-bold",children:"Acciones"})]})}),e.jsx(ee,{children:m.data.map(s=>e.jsxs(P,{className:"hover:bg-slate-50/50 transition-colors",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase tracking-wider py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col max-w-[250px]",children:[e.jsx("span",{className:"text-sm truncate",title:s.address||"—",children:s.address||"—"}),e.jsxs("span",{className:"text-xs text-muted-foreground lowercase",children:[s.city,", ",s.state]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.phone&&e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-1",children:[e.jsx(te,{className:"size-3"}),s.phone]}),s.whatsapp&&e.jsxs("div",{className:"flex items-center text-xs text-green-600 font-medium gap-1",children:[e.jsx(ne,{className:"size-3"}),"WhatsApp"]})]})}),e.jsx(c,{className:"text-center",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin ml-1 inline text-muted-foreground"})]})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})})]},s.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:m.data.map(s=>e.jsx(v,{className:"overflow-hidden",children:e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin text-muted-foreground"})]})]}),(s.address||s.city)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mb-2",children:[s.address,s.city,s.state].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex justify-end gap-1 pt-2 border-t",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})]})},s.id))}),e.jsx("div",{className:"mt-6",children:e.jsx(se,{links:m.links})})]}),e.jsx(T,{open:!!t,onOpenChange:s=>!s&&l(null),children:e.jsxs(L,{className:"border-red-100",children:[e.jsxs(_,{children:[e.jsx(M,{children:"¿Eliminar esta sede?"}),e.jsxs(B,{children:["La sede ",e.jsx("span",{className:"font-bold text-gray-900",children:t?.name})," se eliminará de forma permanente.",t&&!t.is_main&&" Se perderán los datos de contacto y ubicación asociados.",t?.is_main&&" No se puede eliminar la sede principal."]})]}),e.jsxs(H,{children:[e.jsx(re,{className:"cursor-pointer",children:"Cancelar"}),t&&!t.is_main&&e.jsx(I,{variant:"destructive",onClick:G,className:"cursor-pointer",children:"Eliminar sede"})]})]})}),e.jsx(T,{open:!!z,onOpenChange:s=>!s&&g(null),children:e.jsxs(L,{className:"border-amber-200",children:[e.jsxs(_,{children:[e.jsx(M,{children:"No se puede eliminar la sede"}),e.jsx(B,{className:"text-left",children:z})]}),e.jsx(H,{children:e.jsx(I,{onClick:()=>g(null),className:"cursor-pointer",children:"Entendido"})})]})}),e.jsx(Y,{open:V,onOpenChange:h})]})}export{vs as default};
