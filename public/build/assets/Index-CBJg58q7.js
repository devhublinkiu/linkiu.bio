import{c as K,r as j,j as e,H as Q,L as n,a as k,t as b}from"./app-D9wldZxo.js";import{A as X}from"./AdminLayout-C86srUOQ.js";import{P as Y}from"./dropdown-menu-C4-9o8Rw.js";import{B as a}from"./button-Dadb_Lep.js";import{C as v,d as y}from"./card-DbFVjWqh.js";import{T as Z,a as $,b as P,c as d,d as ee,e as c}from"./table-B6cmMBvL.js";import{B as D}from"./badge-DyYF213F.js";import{S as E}from"./switch-BIQUlD4u.js";import{S as se}from"./Pagination-3BS96hmy.js";import{A as T,a as L,b as _,c as M,d as B,e as H,f as re,g as I}from"./alert-dialog-BL6dXcRY.js";import{M as O}from"./map-pin-Du3W4-OO.js";import{P as C}from"./plus-evWAfx61.js";import{S as te}from"./smartphone-DBW9K0YR.js";import{c as ae}from"./createLucideIcon-CJjlOp5I.js";import{L as F}from"./loader-circle-B4dqvKUy.js";import{E as R}from"./eye-C5KGdmx8.js";import{S as q}from"./square-pen-BhQcQCyk.js";import{T as U}from"./trash-2-CMPgRqgc.js";import"./echo-CmTENghG.js";import"./utils-B0KHI9vB.js";import"./progress-D5NiGDeK.js";import"./index-DdTS5Ad2.js";import"./index-CZBSMaku.js";import"./menuConfig-GyORRgsI.js";import"./video-DRtFkuCB.js";import"./chef-hat-D6sEz8YW.js";import"./table-rgWYlWzZ.js";import"./user-D9c6nVY3.js";import"./banknote-DTNMynPY.js";import"./star-D-Iirb7f.js";import"./users-OjDIvTV8.js";import"./calendar-check-fjlZrFwy.js";import"./calendar-BW0rhnMu.js";import"./briefcase-Crq0rSJT.js";import"./truck-Db-Ebch9.js";import"./message-circle-DrNrCoj8.js";import"./credit-card-CPDlDYf1.js";import"./package-BPq1-jLc.js";import"./shopping-bag-CQGcPT0-.js";import"./layout-dashboard-BqLojFjH.js";import"./badge-check-CEpGdEtW.js";import"./lock-BHZn93rL.js";import"./chevron-right-BSwXEIvG.js";import"./sparkles-JbdQIbjf.js";import"./separator-L5pP8n2q.js";import"./external-link-pORnC0H4.js";import"./chevron-down-Dux0wLDw.js";import"./headphones-DD_UyCnk.js";import"./shield-BtuNH23d.js";import"./sonner-DQ2kSMfY.js";import"./index-BDWpq_YI.js";import"./index-BrcTw33p.js";import"./index-BMdzuiHN.js";import"./index-tfOuMV4B.js";import"./circle-check-CN90YBLh.js";import"./check-BAxbGpAF.js";import"./dialog-C0Lg02Tk.js";import"./x-dvUxMxq3.js";import"./input-rMsYcH4C.js";import"./sheet-BP6KOnln.js";import"./index-CbR7iZJO.js";import"./index-DeHGgcwY.js";import"./index-CXzOyCXW.js";import"./index-fFU5c_p6.js";import"./index-Dvu8qGWr.js";import"./index-D4lOZYra.js";import"./index--Jev_GdI.js";import"./ellipsis-BfbyL5_C.js";import"./chevron-left-BFxUkP0a.js";const ie=[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]],ne=ae("navigation-2",ie);function ys({locations:m,locations_limit:x,locations_count:S}){const{currentTenant:i,currentUserRole:p}=K().props,[t,l]=j.useState(null),[z,g]=j.useState(null),[V,h]=j.useState(!1),[u,f]=j.useState(null),N=s=>p?p.is_owner===!0||p.permissions?.includes("*")===!0||p.permissions?.includes(s)===!0:!1,w=x!==null&&S>=x,G=()=>{if(t){if(!N("locations.delete")){h(!0);return}k.delete(route("tenant.locations.destroy",[i?.slug,t.id]),{onSuccess:()=>{b.success("Sede eliminada correctamente"),l(null)},onError:s=>{const r=s?.delete??Object.values(s??{})[0],J=Array.isArray(r)?r[0]:r;l(null),g(J||"Error al eliminar la sede")}})}},A=s=>{if(!N("locations.update")){h(!0);return}f(s.id),s.is_active,k.patch(route("tenant.locations.toggle-active",[i?.slug,s.id]),{},{preserveScroll:!0,onSuccess:()=>b.success("Estado actualizado"),onError:()=>{b.error("No se pudo actualizar el estado"),f(null)},onFinish:()=>f(null)})},o=(s,r)=>{N(r)||(s.preventDefault(),s.stopPropagation(),h(!0))},W=m.data.length===0;return e.jsxs(X,{title:"Gestión de Sedes",children:[e.jsx(Q,{title:"Sedes y Puntos de Venta"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(O,{className:"size-6 text-primary"}),"Sedes y Puntos de Venta"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Administra las ubicaciones físicas de tu negocio y sus horarios.",x!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",S," / ",x," usados)"]})]})]}),w?e.jsxs(a,{className:"cursor-pointer font-bold",disabled:!0,title:"Has alcanzado el máximo de sedes permitidas en tu plan",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]}):e.jsx(n,{href:route("tenant.locations.create",i?.slug),onClick:s=>o(s,"locations.create"),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Nueva Sede"]})})]}),W?e.jsx(v,{className:"border-dashed",children:e.jsxs(y,{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-4 mb-4",children:e.jsx(O,{className:"size-12 text-primary"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"No tienes sedes registradas"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-sm",children:"Crea tu primera sede para gestionar ubicaciones, horarios y contacto."}),!w&&e.jsx(n,{href:route("tenant.locations.create",i?.slug),children:e.jsxs(a,{className:"cursor-pointer font-bold",children:[e.jsx(C,{className:"mr-2 size-4"})," Crear primera sede"]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"hidden md:block",children:e.jsx(y,{className:"p-0",children:e.jsxs(Z,{children:[e.jsx($,{className:"bg-slate-50",children:e.jsxs(P,{children:[e.jsx(d,{className:"font-bold",children:"Sede"}),e.jsx(d,{className:"font-bold",children:"Ubicación"}),e.jsx(d,{className:"font-bold",children:"Contacto"}),e.jsx(d,{className:"text-center font-bold",children:"Estado"}),e.jsx(d,{className:"text-right font-bold",children:"Acciones"})]})}),e.jsx(ee,{children:m.data.map(s=>e.jsxs(P,{className:"hover:bg-slate-50/50 transition-colors",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase tracking-wider py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col max-w-[250px]",children:[e.jsx("span",{className:"text-sm truncate",title:s.address||"—",children:s.address||"—"}),e.jsxs("span",{className:"text-xs text-muted-foreground lowercase",children:[s.city,", ",s.state]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.phone&&e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-1",children:[e.jsx(te,{className:"size-3"}),s.phone]}),s.whatsapp&&e.jsxs("div",{className:"flex items-center text-xs text-green-600 font-medium gap-1",children:[e.jsx(ne,{className:"size-3"}),"WhatsApp"]})]})}),e.jsx(c,{className:"text-center",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin ml-1 inline text-muted-foreground"})]})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-slate-600 hover:text-primary hover:bg-primary/5 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"icon",variant:"ghost",className:"h-9 w-9 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})})]},s.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:m.data.map(s=>e.jsx(v,{className:"overflow-hidden",children:e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-bold text-gray-900",children:s.name}),s.is_main&&e.jsx(D,{className:"bg-blue-100 text-blue-700 border-blue-200 text-[10px] uppercase py-0",children:"Principal"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.manager||"Sin encargado"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{checked:s.is_active,onCheckedChange:()=>A(s),disabled:u===s.id,className:"cursor-pointer"}),u===s.id&&e.jsx(F,{className:"size-4 animate-spin text-muted-foreground"})]})]}),(s.address||s.city)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mb-2",children:[s.address,s.city,s.state].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex justify-end gap-1 pt-2 border-t",children:[e.jsx(n,{href:route("tenant.locations.show",[i?.slug,s.id]),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(R,{className:"size-4"})})}),e.jsx(n,{href:route("tenant.locations.edit",[i?.slug,s.id]),onClick:r=>o(r,"locations.update"),children:e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 cursor-pointer",children:e.jsx(q,{className:"size-4"})})}),e.jsx(a,{size:"sm",variant:"ghost",className:"h-8 text-red-600 hover:bg-red-50 cursor-pointer",onClick:r=>{o(r,"locations.delete"),l(s)},children:e.jsx(U,{className:"size-4"})})]})]})},s.id))}),e.jsx("div",{className:"mt-6",children:e.jsx(se,{links:m.links})})]}),e.jsx(T,{open:!!t,onOpenChange:s=>!s&&l(null),children:e.jsxs(L,{className:"border-red-100",children:[e.jsxs(_,{children:[e.jsx(M,{children:"¿Eliminar esta sede?"}),e.jsxs(B,{children:["La sede ",e.jsx("span",{className:"font-bold text-gray-900",children:t?.name})," se eliminará de forma permanente.",t&&!t.is_main&&" Se perderán los datos de contacto y ubicación asociados.",t?.is_main&&" No se puede eliminar la sede principal."]})]}),e.jsxs(H,{children:[e.jsx(re,{className:"cursor-pointer",children:"Cancelar"}),t&&!t.is_main&&e.jsx(I,{variant:"destructive",onClick:G,className:"cursor-pointer",children:"Eliminar sede"})]})]})}),e.jsx(T,{open:!!z,onOpenChange:s=>!s&&g(null),children:e.jsxs(L,{className:"border-amber-200",children:[e.jsxs(_,{children:[e.jsx(M,{children:"No se puede eliminar la sede"}),e.jsx(B,{className:"text-left",children:z})]}),e.jsx(H,{children:e.jsx(I,{onClick:()=>g(null),className:"cursor-pointer",children:"Entendido"})})]})}),e.jsx(Y,{open:V,onOpenChange:h})]})}export{ys as default};
