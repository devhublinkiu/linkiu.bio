import{c as K,r as a,u as Q,j as e,H as W,a as P}from"./app-CzmtjlCW.js";import{A as X,a as Y,b as Z,c as ee,d as se,e as ae,f as le,g as re}from"./alert-dialog-BdvmeaMn.js";import{B as o}from"./button-DHDYV-Vu.js";import{C as te,d as ie}from"./card-Cio2ZpWt.js";import{D as oe,a as ne,b as ce,c as de,e as me}from"./dialog-CDtZpi6V.js";import{E as pe,a as ue,c as he,d as xe}from"./empty-CWOb4KhK.js";import{F as N}from"./field-l6HuMPt2.js";import{I as k}from"./input-CkrKzdip.js";import{I as ge,a as je,b as fe}from"./input-group-DCsiFJcf.js";import{L as d}from"./label-s6Z-YQDs.js";import{S as u,a as h,b as x,c as g,d as t}from"./select-BsP5-Mx7.js";import{S as be}from"./switch-aRq7TNgc.js";import{P as ve}from"./dropdown-menu-CkPxOfJq.js";import{S as _e}from"./SuperAdminLayout-A6iBy4mt.js";import{S as ye}from"./Pagination-BXFtDScs.js";import{S as Ne}from"./search-CetFsz5w.js";import{P as Se}from"./plus-BCBDbY-P.js";import{S as Ce}from"./square-pen-ByOUPXIB.js";import{T as we}from"./trash-2-D8FHOsLd.js";import"./utils-BH2tHD_A.js";import"./index-DLCIQy2W.js";import"./index-Bik950zP.js";import"./index-tuvqS7go.js";import"./index-D4uLenfM.js";import"./x-B2qOMX6F.js";import"./createLucideIcon-CaH5oZCX.js";import"./separator-C7VYnuGU.js";import"./index-B7u58P25.js";import"./textarea-BVs60Bnz.js";import"./index-BdQq_4o_.js";import"./index-Bdv8as05.js";import"./index-BKdn1L7U.js";import"./index-0rkHg0Ic.js";import"./index-i2FoVhyH.js";import"./index-CqTlmCQK.js";import"./chevron-down-DmTOaxVY.js";import"./check-CDpry8EA.js";import"./chevron-up-Dd6KBSzl.js";import"./chevron-right-CP3Al_6X.js";import"./circle-check-DxCp2NCp.js";import"./credit-card-o3EdvoAE.js";import"./shopping-bag-BzAvYKks.js";import"./sheet-BCCP-sjc.js";import"./index-DewdYm7G.js";import"./index-CoSHAo9V.js";import"./index-BPIYxXZn.js";import"./chevrons-up-down-DP41UalB.js";import"./badge-check-bj2LNrR7.js";import"./ApplicationLogo-CUFauJCk.js";import"./users-CiV-Fhl_.js";import"./layout-grid-Do7wAopY.js";import"./ellipsis-tJHsxw3Y.js";import"./chevron-left-BrVnOOoC.js";function Ds({icons:j,verticals:S,businessCategories:C,filters:m}){const{auth:G}=K().props,w=G.permissions||[],f=s=>w.includes("*")||w.includes(s),[D,V]=a.useState(m.search||""),[n,O]=a.useState(m.vertical_id||"all"),[I,De]=a.useState(m.business_category_id||"all"),[b,M]=a.useState(m.is_global||"all"),[q,p]=a.useState(!1);n!=="all"&&C.filter(s=>s.vertical_id.toString()===n);const[B,i]=a.useState(!1),[c,F]=a.useState(null),[v,_]=a.useState(null),{data:l,setData:r,post:E,processing:T,errors:y,reset:H,clearErrors:A}=Q({name:"",icon:null,vertical_id:"",business_category_id:"",is_global:!1,_method:"POST"}),L=s=>{s.preventDefault(),P.get(route("category-icons.index"),{search:D,vertical_id:n==="all"?null:n,business_category_id:I==="all"?null:I,is_global:b==="all"?null:b},{preserveState:!0})},z=()=>{F(null),H(),A(),r({name:"",icon:null,vertical_id:"",business_category_id:"",is_global:!1,_method:"POST"}),i(!0)},R=s=>{F(s),A(),r({name:s.name,icon:null,vertical_id:s.vertical_id?s.vertical_id.toString():"",business_category_id:s.business_category_id?s.business_category_id.toString():"",is_global:s.is_global,_method:"PUT"}),i(!0)},U=s=>{s.preventDefault(),c?E(route("category-icons.update",c.id),{onSuccess:()=>i(!1)}):E(route("category-icons.store"),{onSuccess:()=>i(!1)})},$=s=>{_(s)},J=()=>{v&&P.delete(route("category-icons.destroy",v),{onSuccess:()=>_(null)})};return e.jsxs(_e,{header:e.jsx("h2",{className:"font-semibold text-base text-gray-800 leading-tight",children:"Gestión de Iconos y Categorías"}),children:[e.jsx(W,{title:"Iconos de Categorías"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6",children:[e.jsxs("form",{onSubmit:L,className:"flex gap-2 items-center flex-wrap w-full md:w-auto",children:[e.jsx("div",{className:"w-full md:w-64",children:e.jsxs(ge,{children:[e.jsx(je,{children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(fe,{placeholder:"Buscar...",value:D,onChange:s=>V(s.target.value)})]})}),e.jsxs(u,{value:n,onValueChange:s=>O(s),children:[e.jsx(h,{className:"w-full md:w-[220px]",children:e.jsx(x,{placeholder:"Todas las Verticales"})}),e.jsxs(g,{children:[e.jsx(t,{value:"all",children:"Todas las Verticales"}),S.map(s=>e.jsx(t,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(u,{value:b,onValueChange:s=>M(s),children:[e.jsx(h,{className:"w-full md:w-[170px]",children:e.jsx(x,{placeholder:"Tipo de Icono"})}),e.jsxs(g,{children:[e.jsx(t,{value:"all",children:"Todos los tipos"}),e.jsx(t,{value:"true",children:"Globales"}),e.jsx(t,{value:"false",children:"Específicos"})]})]}),e.jsx(o,{type:"submit",variant:"secondary",className:"w-full md:w-auto px-6",children:"Filtrar"})]}),e.jsxs(o,{onClick:s=>{f("sa.categories.create")?z():(s.preventDefault(),p(!0))},className:"w-full md:w-auto",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"})," Nuevo Icono"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:j.data.map(s=>e.jsxs(te,{className:"relative group overflow-hidden shadow-none",children:[e.jsx("div",{className:" bg-gray-50 flex items-center justify-center p-4",children:e.jsx("img",{src:`/media/${s.path}`,alt:s.name,className:"w-16 h-16 object-contain border rounded-md"})}),e.jsxs(ie,{className:"p-3",children:[e.jsx("p",{className:"font-semibold truncate text-center text-sm",title:s.name,children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:s.is_global?"Global":e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block font-medium text-blue-600",children:s.vertical?.name||"N/A"}),s.business_category&&e.jsx("span",{className:"block text-gray-400",children:s.business_category.name})]})})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-all duration-200 transform translate-y-1 group-hover:translate-y-0",children:[e.jsx(o,{size:"icon",variant:"secondary",className:"h-8 w-8 shadow-sm",onClick:()=>{f("sa.categories.edit")?R(s):p(!0)},children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx(o,{size:"icon",variant:"destructive",className:"h-8 w-8 shadow-sm",onClick:()=>{f("sa.categories.delete")?$(s.id):p(!0)},children:e.jsx(we,{className:"h-4 w-4"})})]})]},s.id))}),j.data.length===0&&e.jsx("div",{className:"py-12",children:e.jsx(pe,{children:e.jsxs(ue,{children:[e.jsx(he,{children:"No se encontraron iconos"}),e.jsx(xe,{children:"No hay iconos registrados que coincidan con tu búsqueda."})]})})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(ye,{links:j.links})})]})})}),e.jsx(oe,{open:B,onOpenChange:i,children:e.jsxs(ne,{children:[e.jsx(ce,{children:e.jsx(de,{children:c?"Editar Icono":"Nuevo Icono"})}),e.jsxs("form",{onSubmit:U,className:"space-y-5",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(d,{htmlFor:"name",children:"Nombre"}),e.jsx(k,{id:"name",value:l.name,onChange:s=>r("name",s.target.value),required:!0}),e.jsx(N,{children:y.name})]}),e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx(be,{id:"is_global",checked:l.is_global,onCheckedChange:s=>r("is_global",s)}),e.jsx(d,{htmlFor:"is_global",children:"Es Global (Disponible para todos)"})]}),!l.is_global&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(d,{htmlFor:"vertical",children:"Vertical"}),e.jsxs(u,{value:l.vertical_id,onValueChange:s=>r("vertical_id",s),children:[e.jsx(h,{className:"border-blue-100 bg-blue-50/30",children:e.jsx(x,{placeholder:"Selecciona Vertical"})}),e.jsx(g,{children:S.map(s=>e.jsx(t,{value:s.id.toString(),children:s.name},s.id))})]})]}),l.vertical_id&&e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(d,{htmlFor:"business_category",children:"Categoría de Negocio (Nicho) - Opcional"}),e.jsxs(u,{value:l.business_category_id,onValueChange:s=>r("business_category_id",s),children:[e.jsx(h,{className:"border-blue-100 bg-blue-50/30",children:e.jsx(x,{placeholder:"Selecciona Categoría"})}),e.jsx(g,{children:C.filter(s=>s.vertical_id.toString()===l.vertical_id).map(s=>e.jsx(t,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(N,{children:y.business_category_id})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs(d,{htmlFor:"icon",children:["Icono (Imagen) ",c&&"(Opcional)"]}),e.jsx(k,{id:"icon",type:"file",accept:"image/*",onChange:s=>r("icon",s.target.files?s.target.files[0]:null),required:!c,className:"cursor-pointer"}),e.jsx("p",{className:"text-[0.75rem] text-muted-foreground",children:"Máximo 2MB"}),e.jsx(N,{children:y.icon})]}),e.jsxs(me,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(o,{type:"submit",disabled:T,children:T?"Guardando...":"Guardar"})]})]})]})}),e.jsx(X,{open:!!v,onOpenChange:s=>!s&&_(null),children:e.jsxs(Y,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"¿Estás seguro?"}),e.jsx(se,{children:"Esta acción no se puede deshacer. Esto eliminará permanentemente el icono."})]}),e.jsxs(ae,{children:[e.jsx(le,{children:"Cancelar"}),e.jsx(re,{onClick:J,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),e.jsx(ve,{open:q,onOpenChange:p})]})}export{Ds as default};
