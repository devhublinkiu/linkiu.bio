import{c as se,r as c,j as e,H as te,a as P,t as N}from"./app-BxeeMXn5.js";import{A as ae}from"./AdminLayout-qCE3vY7L.js";import{B as n}from"./button-7JWLOcK_.js";import{C as A,d as D}from"./card-CZ4HJuOG.js";import{I as S}from"./input-DAizBa_g.js";import{L as p}from"./label-DvE9LE6F.js";import{S as I}from"./switch-DaaS2XD2.js";import{T as re,a as oe,b as q,c as u,d as ne,e as h}from"./table-3dZB4sa5.js";import{S as ie,a as le,b as ce,c as de,d as me}from"./sheet-Bbp6VhsK.js";import{A as xe,a as pe,b as ue,c as he,d as je,e as ge,f as ve,g as fe}from"./alert-dialog-M1Oqq8sv.js";import{P as Ne,a as be,b as ye}from"./popover-cHKyHqFI.js";import{E as ke,a as Ce,e as we,c as _e,d as Ee}from"./empty-gUYn75xU.js";import{c as Se}from"./utils-C-R0dfCD.js";import{P as Te}from"./dropdown-menu-y9rp4bWE.js";import{S as Fe}from"./Pagination-CnT440XL.js";import{P as V}from"./plus-CGb4S1OW.js";import{g as Pe}from"./menuConfig--lJI1wgO.js";import{E as G}from"./external-link-BEZwjyKz.js";import{S as J}from"./square-pen-DyMbWI9a.js";import{T as U}from"./trash-2-Cefy4eHW.js";import{c as Ae}from"./createLucideIcon-MMsaX1RM.js";import{L as De}from"./link-CwXHdWwm.js";import{P as Ie}from"./palette-DTt5YpjO.js";import"./badge-lrHzGyyu.js";import"./progress-BPtmN4cS.js";import"./index-D1_1hXqK.js";import"./index-Dtj3r8is.js";import"./badge-check-DHBa0N5U.js";import"./lock-D8DYOORy.js";import"./chevron-right-DPgD6mkS.js";import"./sparkles-Bns8Lzd1.js";import"./separator-0SREGApO.js";import"./chevron-down-CUwoWnp1.js";import"./headphones-DG2WmJqQ.js";import"./user-CUi44rAN.js";import"./shield-Bco25DSE.js";import"./sonner-CzgRTX_z.js";import"./index-BAK1YxAc.js";import"./index-YFI2wHgC.js";import"./index-CYQStCBS.js";import"./index-B6sjIBFy.js";import"./index-B6i64pSH.js";import"./index-qgmO2-AH.js";import"./x-CpN8cc9J.js";import"./index-BUGEk3O6.js";import"./circle-check-BQHjiPz9.js";import"./check-DyXxeGP9.js";import"./credit-card-DdNcKhKR.js";import"./shopping-bag-CWfZSTHo.js";import"./dialog-bj0tKiGn.js";import"./index-D8L8_pCG.js";import"./index-DWUEdQX6.js";import"./index-B9B_fttR.js";import"./ellipsis-BUaddE5J.js";import"./chevron-left-C6qfJShI.js";import"./video-BBI0Mdxh.js";import"./chef-hat-BUkOBHO9.js";import"./table-YYiP2uiH.js";import"./map-pin-DbqcMmJZ.js";import"./banknote-o40mAnOF.js";import"./star-Cxzywz77.js";import"./users-Bu-h6n7y.js";import"./calendar-check-DZWxogn-.js";import"./calendar-BmHj6uld.js";import"./briefcase-ClT8Apdn.js";import"./truck-Dctgs6Id.js";import"./message-circle-BPpK8KIf.js";import"./package-1Cz2kpnt.js";import"./layout-dashboard-BHjPtgyJ.js";const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Me=Ae("smile",Le),Re=[{name:"Negro",value:"#000000"},{name:"Rojo",value:"#EF4444"},{name:"Azul",value:"#3B82F6"},{name:"Verde",value:"#22C55E"},{name:"Naranja",value:"#F97316"},{name:"PÃºrpura",value:"#A855F7"},{name:"Blanco",value:"#FFFFFF"}],ze=["ğŸ”¥","ğŸ‰","ğŸš€","ğŸ“¢","ğŸ·ï¸","ğŸ","ğŸ’","âœ¨","â­","âš¡","ğŸšš","ğŸ“¦","ğŸ’³","ğŸ“","ğŸ‘‰","âš ï¸","âœ…","ğŸ†•","ğŸ”","ğŸ•","ğŸ£","ğŸ¥—","â˜•","ğŸº","ğŸ·","ğŸ°","â¤ï¸","ğŸ’¯"],K={content:"",link:"",background_color:"#000000",text_color:"#FFFFFF",order:0,is_active:!0};function et({tickers:j,tickers_limit:b,tickers_count:L}){const{currentTenant:y,currentUserRole:k}=se().props,[Q,g]=c.useState(!1),[d,M]=c.useState(null),[T,C]=c.useState(null),[W,R]=c.useState(!1),[r,F]=c.useState(K),[w,m]=c.useState(!1),[i,_]=c.useState({}),z=c.useRef(null),x=b!==null&&L>=b,X=s=>k?k.is_owner||k.permissions.includes("*")||k.permissions.includes(s):!1,l=(s,a)=>{X(s)?a():R(!0)},o=(s,a)=>{F(t=>({...t,[s]:a})),_(t=>{const v={...t};return delete v[s],v})},Y=s=>{const a=z.current;if(a){const t=a.selectionStart||0,v=a.selectionEnd||0,E=r.content.substring(0,t)+s+r.content.substring(v);o("content",E),setTimeout(()=>{a.focus();const f=t+s.length;a.setSelectionRange(f,f)},0)}else o("content",r.content+s)},O=()=>{M(null),F({...K,order:j.total}),_({}),g(!0)},H=s=>{M(s),F({content:s.content,link:s.link||"",background_color:s.background_color,text_color:s.text_color,order:s.order,is_active:s.is_active}),_({}),g(!0)},Z=s=>{s.preventDefault(),l(d?"tickers.update":"tickers.create",()=>{m(!0);const t=d?route("tenant.admin.tickers.update",[y?.slug,d.id]):route("tenant.admin.tickers.store",y?.slug);P[d?"put":"post"](t,{...r},{preserveScroll:!0,onSuccess:()=>{N.success(d?"Ticker actualizado correctamente":"Ticker creado correctamente"),g(!1),m(!1)},onError:E=>{_(E);const f=E?.limit;N.error(typeof f=="string"?f:"Revisa los campos del formulario"),m(!1)}})})},ee=()=>{T&&(m(!0),P.delete(route("tenant.admin.tickers.destroy",[y?.slug,T.id]),{preserveScroll:!0,onSuccess:()=>{N.success("Ticker eliminado correctamente"),C(null),m(!1)},onError:()=>{N.error("Error al eliminar el ticker"),m(!1)}}))},$=s=>{l("tickers.update",()=>{P.put(route("tenant.admin.tickers.update",[y?.slug,s.id]),{content:s.content,link:s.link||"",background_color:s.background_color,text_color:s.text_color,order:s.order,is_active:!s.is_active},{preserveScroll:!0,onSuccess:()=>N.success(s.is_active?"Ticker desactivado":"Ticker activado")})})},B=({label:s,field:a})=>e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{children:s}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Re.map(t=>e.jsx("button",{type:"button",onClick:()=>o(a,t.value),className:Se("w-8 h-8 rounded-full border border-gray-200 transition-all hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-900",r[a]===t.value&&"ring-2 ring-offset-2 ring-slate-900 scale-110",t.value==="#FFFFFF"&&"border-gray-300"),style:{backgroundColor:t.value},title:t.name,"aria-label":`Color ${t.name}`},t.value))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx(S,{value:r[a],onChange:t=>o(a,t.target.value),className:"pl-9 font-mono",placeholder:"#000000"})]}),e.jsx("input",{type:"color",value:r[a],onChange:t=>o(a,t.target.value),className:"h-10 w-10 p-1 rounded-md border cursor-pointer","aria-label":`Selector de ${s.toLowerCase()}`})]}),i[a]&&e.jsx("p",{className:"text-destructive text-xs",children:i[a]})]});return e.jsxs(ae,{title:"Tickers Promocionales",children:[e.jsx(te,{title:"Tickers Promocionales"}),e.jsx(Te,{open:W,onOpenChange:R}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Tickers Promocionales"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Barra de anuncios y promociones en la parte superior de tu tienda.",b!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",L," / ",b," usados)"]})]})]}),e.jsxs(n,{onClick:()=>l("tickers.create",()=>!x&&O()),disabled:x,className:"gap-2",title:x?"Has alcanzado el mÃ¡ximo de tickers permitidos en tu plan":void 0,children:[e.jsx(V,{className:"w-4 h-4"})," Nuevo Ticker"]})]}),j.data.length===0?e.jsx(A,{children:e.jsx(D,{className:"py-16",children:e.jsxs(ke,{children:[e.jsxs(Ce,{children:[e.jsx(we,{variant:"icon",children:e.jsx(Pe,{className:"h-5 w-5"})}),e.jsx(_e,{children:"No hay tickers creados"}),e.jsx(Ee,{children:"Los tickers promocionales aparecen como una barra animada en la parte superior de tu tienda. Crea el primero para empezar a comunicar ofertas y novedades."})]}),e.jsxs(n,{onClick:()=>l("tickers.create",()=>!x&&O()),disabled:x,className:"gap-2 mt-4",title:x?"Has alcanzado el mÃ¡ximo de tickers permitidos en tu plan":void 0,children:[e.jsx(V,{className:"w-4 h-4"})," Crear primer ticker"]})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"hidden md:block",children:e.jsx(D,{className:"p-0",children:e.jsxs(re,{children:[e.jsx(oe,{children:e.jsxs(q,{children:[e.jsx(u,{className:"w-[40px]",children:"#"}),e.jsx(u,{className:"w-[300px]",children:"Mensaje"}),e.jsx(u,{children:"Colores"}),e.jsx(u,{children:"Enlace"}),e.jsx(u,{className:"text-center",children:"Estado"}),e.jsx(u,{className:"text-right",children:"Acciones"})]})}),e.jsx(ne,{children:j.data.map(s=>e.jsxs(q,{children:[e.jsx(h,{className:"text-muted-foreground font-mono text-xs",children:s.order}),e.jsx(h,{className:"font-medium max-w-[300px] truncate",children:s.content}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border shadow-sm flex items-center justify-center text-[8px] font-bold",style:{backgroundColor:s.background_color,color:s.text_color},title:`Fondo: ${s.background_color} | Texto: ${s.text_color}`,children:"Aa"}),e.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:s.background_color})]})}),e.jsx(h,{children:s.link?e.jsxs("a",{href:s.link,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-sm text-blue-600 hover:underline",children:[e.jsx(G,{className:"w-3 h-3"})," Ver enlace"]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"â€”"})}),e.jsx(h,{className:"text-center",children:e.jsx(I,{checked:s.is_active,onCheckedChange:()=>$(s),"aria-label":`${s.is_active?"Desactivar":"Activar"} ticker`})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(n,{size:"icon",variant:"ghost",onClick:()=>l("tickers.update",()=>H(s)),"aria-label":"Editar ticker",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(n,{size:"icon",variant:"ghost",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>l("tickers.delete",()=>C(s)),"aria-label":"Eliminar ticker",children:e.jsx(U,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:j.data.map(s=>e.jsx(A,{children:e.jsxs(D,{className:"p-4",children:[e.jsx("div",{className:"w-full py-2 px-3 text-sm font-bold rounded-md mb-3 truncate",style:{backgroundColor:s.background_color,color:s.text_color},children:s.content}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{checked:s.is_active,onCheckedChange:()=>$(s),"aria-label":`${s.is_active?"Desactivar":"Activar"} ticker`}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.is_active?"Activo":"Inactivo"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>l("tickers.update",()=>H(s)),"aria-label":"Editar ticker",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(n,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>l("tickers.delete",()=>C(s)),"aria-label":"Eliminar ticker",children:e.jsx(U,{className:"w-4 h-4"})})]})]})]})},s.id))}),e.jsx("div",{className:"mt-6",children:e.jsx(Fe,{links:j.links})})]}),e.jsx(ie,{open:Q,onOpenChange:g,children:e.jsxs(le,{className:"w-full sm:max-w-md overflow-y-auto",children:[e.jsxs(ce,{children:[e.jsx(de,{children:d?"Editar Ticker":"Nuevo Ticker"}),e.jsx(me,{children:"Configura el mensaje y estilo de tu barra promocional."})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Vista previa"}),e.jsx("div",{className:"overflow-hidden rounded-lg",children:e.jsxs("div",{className:"w-full py-2.5 px-4 font-bold text-center text-sm flex items-center justify-center gap-2 whitespace-nowrap",style:{backgroundColor:r.background_color,color:r.text_color},children:[e.jsx("span",{children:r.content||"Escribe tu mensaje..."}),r.link&&e.jsx(G,{className:"w-3 h-3 shrink-0"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"content",children:"Mensaje"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{id:"content",ref:z,value:r.content,onChange:s=>o("content",s.target.value),placeholder:"Ej: ğŸ”¥ EnvÃ­os gratis por compras superiores a $50.000",required:!0,maxLength:255,className:"flex-1"}),e.jsxs(Ne,{children:[e.jsx(be,{asChild:!0,children:e.jsx(n,{type:"button",variant:"outline",size:"icon",className:"shrink-0",title:"Agregar emoji",children:e.jsx(Me,{className:"w-5 h-5 text-gray-500"})})}),e.jsx(ye,{className:"w-48 p-2",align:"end",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:ze.map(s=>e.jsx("button",{type:"button",onClick:()=>Y(s),className:"h-8 w-8 flex items-center justify-center text-lg hover:bg-slate-100 rounded transition-colors","aria-label":`Insertar ${s}`,children:s},s))})})]})]}),i.content&&e.jsx("p",{className:"text-destructive text-xs",children:i.content})]}),e.jsx(B,{label:"Color de fondo",field:"background_color"}),e.jsx(B,{label:"Color de texto",field:"text_color"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"link",className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"})," Enlace (opcional)"]}),e.jsx(S,{id:"link",value:r.link,onChange:s=>o("link",s.target.value),placeholder:"https://...",type:"url"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Si agregas un enlace, toda la barra serÃ¡ cliqueable."}),i.link&&e.jsx("p",{className:"text-destructive text-xs",children:i.link})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"order",children:"Orden de apariciÃ³n"}),e.jsx(S,{id:"order",type:"number",min:0,value:r.order,onChange:s=>o("order",parseInt(s.target.value)||0)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Menor nÃºmero = aparece primero."}),i.order&&e.jsx("p",{className:"text-destructive text-xs",children:i.order})]}),e.jsxs("div",{className:"flex items-center justify-between border p-3 rounded-lg bg-slate-50",children:[e.jsx(p,{htmlFor:"is_active",className:"cursor-pointer",children:"Activar inmediatamente"}),e.jsx(I,{id:"is_active",checked:r.is_active,onCheckedChange:s=>o("is_active",s)})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancelar"}),e.jsx(n,{type:"submit",disabled:w,children:w?"Guardando...":d?"Guardar cambios":"Crear ticker"})]})]})]})}),e.jsx(xe,{open:!!T,onOpenChange:s=>!s&&C(null),children:e.jsxs(pe,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Â¿Eliminar ticker?"}),e.jsx(je,{children:"Esta acciÃ³n no se puede deshacer. El ticker dejarÃ¡ de mostrarse en tu tienda."})]}),e.jsxs(ge,{children:[e.jsx(ve,{children:"Cancelar"}),e.jsx(fe,{onClick:ee,disabled:w,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:w?"Eliminando...":"Eliminar"})]})]})})]})}export{et as default};
