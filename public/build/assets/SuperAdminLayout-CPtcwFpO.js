import{j as e,a as V,c as L,r as p,t as h,L as w,R as G}from"./app-D9wldZxo.js";import{B as H}from"./button-Dadb_Lep.js";import{S as $,a as b,b as k,C as Y,c as J,d as g,e as K,f as Q,g as X,h as Z,u as ee,D as se,i as te,A as y,j as C,k as M,l as ie,m as ae,n as _,o as ne,p as f,L as re,B as oe,q as le,r as ce,s as de,t as ue,v as pe,w as he,P as xe,x as me,y as ge,z as fe,E as je,F as j,G as A,H as E,I as B,J as be,N as ke}from"./dropdown-menu-C4-9o8Rw.js";import{g as ve}from"./echo-CmTENghG.js";import{C as Ne}from"./chevron-right-BSwXEIvG.js";import{C as Se}from"./chevrons-up-down-Cepco8Sn.js";import{B as we}from"./badge-check-CEpGdEtW.js";import{c as v}from"./createLucideIcon-CJjlOp5I.js";import{A as D}from"./ApplicationLogo-DuPOXIDR.js";import{U as ye}from"./users-OjDIvTV8.js";import{L as Ce}from"./layout-grid-DMUl8Ye2.js";const Me=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],_e=v("bot",Me);const Ae=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],R=v("settings-2",Ae);const Ee=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],Be=v("square-terminal",Ee);function De({items:n}){return e.jsx($,{children:e.jsx(b,{children:n.map(a=>e.jsx(k,{children:a.items?.length?e.jsx(Y,{asChild:!0,defaultOpen:a.isActive,className:"group/collapsible",children:e.jsxs("div",{children:[e.jsx(J,{asChild:!0,children:e.jsxs(g,{tooltip:a.title,children:[a.icon&&e.jsx(a.icon,{}),e.jsx("span",{children:a.title}),e.jsx(Ne,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),e.jsx(K,{children:e.jsx(Q,{children:a.items?.map(c=>e.jsx(X,{children:e.jsx(Z,{asChild:!0,children:e.jsx("a",{href:c.url,children:e.jsx("span",{children:c.title})})})},c.title))})})]})}):e.jsx(g,{asChild:!0,tooltip:a.title,children:e.jsxs("a",{href:a.url,children:[a.icon&&e.jsx(a.icon,{}),e.jsx("span",{children:a.title})]})})},a.title))})})}function Le({user:n}){const{isMobile:a}=ee();return e.jsx(b,{children:e.jsx(k,{children:e.jsxs(se,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(g,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground outline-none ring-0 focus:ring-0 focus:outline-none",children:[e.jsxs(y,{className:"h-8 w-8 rounded-lg",children:[e.jsx(C,{src:n.avatar,alt:n.name}),e.jsx(M,{className:"rounded-lg",children:"CN"})]}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-medium",children:n.name}),e.jsx("span",{className:"truncate text-xs",children:n.email})]}),e.jsx(Se,{className:"ml-auto size-4"})]})}),e.jsxs(ie,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg",side:a?"bottom":"right",align:"end",sideOffset:4,children:[e.jsx(ae,{className:"p-0 font-normal",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[e.jsxs(y,{className:"h-8 w-8 rounded-lg",children:[e.jsx(C,{src:n.avatar,alt:n.name}),e.jsx(M,{className:"rounded-lg",children:"CN"})]}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-medium",children:n.name}),e.jsx("span",{className:"truncate text-xs",children:n.email})]})]})}),e.jsx(_,{}),e.jsxs(ne,{children:[e.jsx(f,{asChild:!0,className:"cursor-pointer outline-none ring-0 focus:ring-0 focus:outline-none",children:e.jsxs("a",{href:"/superlinkiu/profile",children:[e.jsx(we,{}),"Perfil"]})}),e.jsx(f,{asChild:!0,className:"cursor-pointer outline-none ring-0 focus:ring-0 focus:outline-none",children:e.jsxs("a",{href:"/superlinkiu/settings",children:[e.jsx(R,{}),"Configuración"]})})]}),e.jsx(_,{}),e.jsxs(f,{className:"cursor-pointer text-red-500 focus:text-red-500 focus:bg-red-50 hover:text-red-600 outline-none ring-0 focus:ring-0 focus:outline-none",onClick:()=>V.post(route("logout")),children:[e.jsx(re,{}),"Cerrar Sesión"]})]})]})})})}function Re({user:n,logo:a,...c}){const{url:t}=L(),x=p.useMemo(()=>[{title:"Dashboard",url:"/superlinkiu/dashboard",icon:Be,isActive:t.startsWith("/superlinkiu/dashboard")},{title:"Tenants",url:"/superlinkiu/tenants",icon:_e,isActive:t.startsWith("/superlinkiu/tenants")},{title:"Usuarios",url:"/superlinkiu/users",icon:ye,isActive:t.startsWith("/superlinkiu/users")},{title:"Facturación",url:"#",icon:oe,isActive:t.startsWith("/superlinkiu/plans")||t.startsWith("/superlinkiu/subscriptions")||t.startsWith("/superlinkiu/payments"),items:[{title:"Planes",url:"/superlinkiu/plans"},{title:"Suscripciones",url:"/superlinkiu/subscriptions"},{title:"Pagos",url:"/superlinkiu/payments"}]},{title:"Contenido",url:"#",icon:Ce,isActive:t.startsWith("/superlinkiu/categories")||t.startsWith("/superlinkiu/category-icons")||t.startsWith("/superlinkiu/release-notes")||t.startsWith("/superlinkiu/release-note-categories")||t.startsWith("/superlinkiu/support/requests")||t.startsWith("/superlinkiu/media"),items:[{title:"Categorías de negocio",url:"/superlinkiu/categories"},{title:"Release Notes",url:"/superlinkiu/release-notes"},{title:"Categorías e Iconos",url:"/superlinkiu/category-icons"},{title:"Solicitudes de iconos",url:"/superlinkiu/support/requests"},{title:"Mis archivos",url:"/superlinkiu/media"}]},{title:"Atención",url:"#",icon:le,isActive:t.startsWith("/superlinkiu/support")&&!t.startsWith("/superlinkiu/support/requests")||t.startsWith("/superlinkiu/reportes-tiendas"),items:[{title:"Tickets de Soporte",url:"/superlinkiu/support"},{title:"Reportes tiendas",url:"/superlinkiu/reportes-tiendas"}]},{title:"Configuración",url:"#",icon:R,isActive:t.startsWith("/superlinkiu/roles")||t.startsWith("/superlinkiu/settings"),items:[{title:"Ajustes generales",url:"/superlinkiu/settings"},{title:"Roles y Permisos",url:"/superlinkiu/roles"}]}],[t]);return e.jsxs(ce,{variant:"inset",...c,children:[e.jsx(de,{children:e.jsx(b,{children:e.jsx(k,{children:e.jsx(g,{size:"lg",asChild:!0,className:"group-data-[state=expanded]:bg-transparent group-data-[state=expanded]:hover:bg-transparent ring-0 group-data-[state=expanded]:h-14 group-data-[state=expanded]:p-4 group-data-[state=expanded]:pl-8",children:e.jsxs("a",{href:"/superlinkiu/dashboard",children:[e.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[state=expanded]:hidden",children:e.jsx(D,{className:"size-6"})}),e.jsx("div",{className:"hidden group-data-[state=expanded]:block",children:a?.url?e.jsx("img",{src:a.url,alt:a.name||"Logo",className:"h-8 w-auto object-contain max-w-[200px]"}):e.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl tracking-tight text-sidebar-foreground",children:[e.jsx("div",{className:"h-8 w-8 flex items-center justify-center bg-primary p-1.5 rounded-lg",children:e.jsx(D,{className:"size-5 text-primary-foreground"})}),e.jsx("span",{children:a?.name||"Linkiu.bio"})]})})]})})})})}),e.jsx(ue,{children:e.jsx(De,{items:x})}),e.jsx(pe,{children:e.jsx(Le,{user:{name:n.name,email:n.email,avatar:n.profile_photo_url||`https://ui-avatars.com/api/?name=${n.name}&background=0D8ABC&color=fff`}})})]})}function $e({children:n,header:a,breadcrumbs:c}){const{auth:t,flash:x,site_settings:N}=L().props,I=t.user;t.permissions;const[W,d]=p.useState(t.notifications?.unread_count||0),[O,u]=p.useState(t.notifications?.recent||[]),[Ie,q]=p.useState(0),[z,S]=p.useState(!1),[P,T]=p.useState(!1);p.useEffect(()=>{t.notifications&&(d(t.notifications.unread_count),u(t.notifications.recent))},[t.notifications]);const U=r=>{u(o=>o.map(m=>m.id===r?{...m,read_at:new Date().toISOString()}:m)),d(o=>Math.max(0,o-1))},F=()=>{u(r=>r.map(o=>({...o,read_at:new Date().toISOString()}))),d(0)};return p.useEffect(()=>{const r=ve();if(r){console.log("[Echo] Subscribing to superadmin-updates channel..."),r.channel("superadmin-updates").listen(".tenant.created",s=>{console.log("[Echo] Received .tenant.created event:",s),h.info("¡Nueva tienda registrada!",{description:s.message}),q(i=>i+1),d(i=>i+1);const l={id:Math.random().toString(),data:{...s,type:"tenant_created"},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}).listen(".ticket.created",s=>{console.log("[Echo] Received .ticket.created event:",s),h.info("¡Nuevo ticket de soporte!",{description:s.message,action:{label:"Ver",onClick:()=>window.location.href=s.url}}),d(i=>i+1);const l={id:Math.random().toString(),data:{...s,type:"ticket_created"},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}).listen(".ticket.replied",s=>{console.log("[Echo] Received .ticket.replied event:",s),h.info("Nueva respuesta en ticket",{description:s.message,action:{label:"Ver",onClick:()=>window.location.href=s.url}}),d(i=>i+1);const l={id:Math.random().toString(),data:{...s,type:"ticket_replied"},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}).listen(".ticket.assigned",s=>{console.log("[Echo] Received .ticket.assigned event:",s),h.success("Ticket asignado",{description:s.message,action:{label:"Ver",onClick:()=>window.location.href=s.url}}),d(i=>i+1);const l={id:Math.random().toString(),data:{...s,type:"ticket_assigned"},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}).listen(".payment.reported",s=>{console.log("[Echo] Received .payment.reported event:",s),h.success("¡Nuevo pago reportado!",{description:s.message}),d(i=>i+1);const l={id:Math.random().toString(),data:{message:s.message,type:"payment_reported",url:s.url},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}).listen(".icon.requested",s=>{console.log("[Echo] Received .icon.requested event:",s),h.info("¡Nueva solicitud de icono!",{description:s.message}),d(i=>i+1);const l={id:Math.random().toString(),data:{message:s.message,type:"icon_requested",url:s.url},created_at:new Date().toISOString(),read_at:null};u(i=>[l,...i.slice(0,4)])}),console.log("[Echo] Listeners attached to superadmin-updates");const o=r.connector?.ably?.connection;o?.state==="connected"?console.log("[Echo] Status: Connected"):o&&(console.log("[Echo] Status:",o.state),o.on("connected",()=>console.log("[Echo] Connected!")));const m=r.connector?.ably?.channels?.get("superadmin-updates");m&&m.subscribe(s=>{console.log("[Ably Raw] Message received:",s.name,s.data)})}else console.warn("[Echo] Echo not available (no VITE_ABLY_KEY or init failed)")},[]),p.useEffect(()=>{x.success&&h.success(x.success),x.error&&h.error(x.error)},[x]),e.jsxs(he,{children:[e.jsx(xe,{open:P,onOpenChange:T}),e.jsx(Re,{user:I,logo:{url:N?.logo_url||null,name:N?.app_name||"Linkiu"}}),e.jsxs(me,{children:[e.jsxs("header",{className:"bg-background/80 backdrop-blur-md rounded-t-3xl border-b border-border h-12 flex items-center justify-between px-4 sticky top-0 z-30 gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"-ml-1 md:hidden"}),e.jsx(fe,{children:e.jsxs(je,{children:[e.jsx(j,{className:"hidden md:block",children:e.jsx(A,{asChild:!0,children:e.jsx(w,{href:route("superadmin.dashboard"),children:"SuperLinkiu"})})}),e.jsx(E,{className:"hidden md:block"}),c?c.map((r,o)=>e.jsxs(G.Fragment,{children:[e.jsx(j,{children:r.href?e.jsx(A,{asChild:!0,children:e.jsx(w,{href:r.href,children:r.label})}):e.jsx(B,{children:r.label})}),o<c.length-1&&e.jsx(E,{})]},o)):e.jsx(j,{children:e.jsx(B,{children:a})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{variant:"ghost",size:"icon",className:"relative text-muted-foreground hover:text-foreground",onClick:()=>S(!0),children:[e.jsx(be,{className:"h-5 w-5"}),W>0&&e.jsx("span",{className:"absolute top-2 right-2 h-2 w-2 bg-destructive rounded-full animate-pulse ring-2 ring-background"})]}),e.jsx(ke,{open:z,onOpenChange:S,notifications:O,onNotificationRead:U,onAllRead:F})]})]}),e.jsx("div",{className:"flex-1 p-4 md:px-8 overflow-auto",children:n}),e.jsx("footer",{className:"border-t border-border bg-background px-6 py-2 text-center rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center p-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["© 2026 ",e.jsx("strong",{children:"Linkiu.bio"}),". Todos los derechos reservados."]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 md:mt-0",children:[e.jsx("span",{children:"v1.0.0 (Beta)"}),e.jsx("span",{className:"h-3 w-px bg-border"}),e.jsx("a",{href:"#",className:"hover:text-foreground",children:"Soporte"})]})]})})]})]})}export{$e as S};
