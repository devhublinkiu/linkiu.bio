import{c as re,r,u as S,j as e,H as te,a as y}from"./app-DvpAkplk.js";import{B as h}from"./badge-IfxeRtOE.js";import{B as t}from"./button-DOQ0axlO.js";import{C,d as w,a as ie,b as oe,c as ne}from"./card-CnT0l_PA.js";import{D as _,a as k,b as R,c as D,d as A,e as T}from"./dialog-Cjxgu9dZ.js";import{E as le,a as ce,b as de,c as me,d as pe}from"./empty-vm7NwIVH.js";import{F as he}from"./field-DZAR5qV8.js";import{L as x}from"./label-BjDu_9e_.js";import{T as xe,a as ue,b as u,c as i,d as je,e as a}from"./table-U0RLv7Tr.js";import{T as E}from"./textarea-5cNYjyN9.js";import{I as fe}from"./input-Bv-dfyAA.js";import{S as ge,a as be,b as ve,c as Ne,d as c}from"./select-AGOQu6Sd.js";import{P as Se}from"./dropdown-menu-ubFSrLA8.js";import{S as ye}from"./SuperAdminLayout-C3nsWUEf.js";import{S as Ce}from"./Pagination-CS-xDxOF.js";import{S as P}from"./search-CKT4fYdU.js";import{C as we}from"./check-BnQaAa8B.js";import{X as _e}from"./x-C_qF6Mva.js";import{f as ke}from"./format-Du31obhd.js";import{e as Re}from"./es-BteQoBuv.js";import"./utils-Bt66apXy.js";import"./index-Bw9aTihY.js";import"./index-D8KCWmzE.js";import"./index-DxV-pwI8.js";import"./index-DvNjLHaW.js";import"./separator-BG2VS_Fl.js";import"./index-CnuaM2Cu.js";import"./index-BdQq_4o_.js";import"./index-ahKcmWZ5.js";import"./index-Dcod572x.js";import"./index-2KDpKUG2.js";import"./index-DAaNBk-s.js";import"./index-uxDWIACH.js";import"./chevron-down-tlhr8VnY.js";import"./createLucideIcon-BAweqaF3.js";import"./chevron-up-C_1MuBUq.js";import"./chevron-right-wq5EBuGT.js";import"./circle-check-DihymiLa.js";import"./trash-2-Cl32KA5j.js";import"./credit-card-fEKVAskI.js";import"./shopping-bag-DhB74yIJ.js";import"./sheet-DsGG5XCT.js";import"./index-DGLOWnr1.js";import"./index-CVnMJ0kl.js";import"./index-CD1tTlGF.js";import"./chevrons-up-down-BCSgY-k4.js";import"./badge-check-BhvL5u0B.js";import"./ApplicationLogo-BXyMc5eR.js";import"./users-BDTVDblz.js";import"./layout-grid-C-nhVdiA.js";import"./ellipsis-TzpxLlOx.js";import"./chevron-left-CFFX0xaS.js";function Rs({requests:d,filters:j}){const{auth:z}=re().props,f=z.permissions||[],g=s=>f.includes("*")||f.includes(s),[o,b]=r.useState(null),[H,n]=r.useState(!1),[I,l]=r.useState(!1),[F,m]=r.useState(!1),[p,O]=r.useState(j.search||""),[v,B]=r.useState(j.status||"all"),M=s=>{s.preventDefault(),y.get(route("icon-requests.index"),{search:p,status:v},{preserveState:!0,replace:!0})},L=s=>{B(s),y.get(route("icon-requests.index"),{search:p,status:s},{preserveState:!0,replace:!0})},{data:V,setData:N,post:$,processing:G,errors:De,reset:X}=S({name:"",icon:null,vertical_id:"",is_global:!1,admin_feedback:"",_method:"PATCH"}),{data:Z,setData:J,post:K,processing:Q,errors:U,reset:W}=S({admin_feedback:"",_method:"PATCH"}),Y=s=>{b(s),X(),N({name:s.requested_name,icon:null,vertical_id:"",is_global:!1,admin_feedback:"",_method:"PATCH"}),n(!0)},q=s=>{b(s),W(),l(!0)},ee=s=>{s.preventDefault(),o&&$(route("icon-requests.approve",o.id),{onSuccess:()=>n(!1)})},se=s=>{s.preventDefault(),o&&K(route("icon-requests.reject",o.id),{onSuccess:()=>l(!1)})},ae=s=>{switch(s){case"approved":return e.jsx(h,{className:"bg-green-100 text-green-700 border-green-200 hover:bg-green-100",children:"Aprobado"});case"rejected":return e.jsx(h,{variant:"destructive",children:"Rechazado"});default:return e.jsx(h,{variant:"secondary",className:"bg-yellow-100 text-yellow-700 border-yellow-200 hover:bg-yellow-100",children:"Pendiente"})}};return e.jsxs(ye,{header:"Centro de Solicitudes",children:[e.jsx(te,{title:"Solicitudes"}),e.jsxs("div",{className:"max-w-7xl mx-auto py-6",children:[e.jsx(C,{className:"mb-6",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center",children:[e.jsxs("form",{onSubmit:M,className:"relative w-full sm:w-80",children:[e.jsx(P,{className:"absolute left-3 top-2 h-4 w-4 text-gray-400"}),e.jsx(fe,{placeholder:"Buscar por nombre o tienda...",value:p,onChange:s=>O(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(x,{className:"text-sm font-medium text-muted-foreground whitespace-nowrap",children:"Estado:"}),e.jsxs(ge,{value:v,onValueChange:L,children:[e.jsx(be,{className:"w-[180px]",children:e.jsx(ve,{placeholder:"Filtrar estado"})}),e.jsxs(Ne,{children:[e.jsx(c,{value:"all",children:"Todas las solicitudes"}),e.jsx(c,{value:"pending",children:"Pendientes"}),e.jsx(c,{value:"approved",children:"Aprobadas"}),e.jsx(c,{value:"rejected",children:"Rechazadas"})]})]})]})]})})}),e.jsxs(C,{children:[e.jsxs(ie,{children:[e.jsx(oe,{children:"Solicitudes Recientes"}),e.jsx(ne,{children:"Gestiona las peticiones de iconografía y otros requerimientos de los tenants."})]}),e.jsxs(w,{children:[e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(u,{children:[e.jsx(i,{children:"Fecha"}),e.jsx(i,{children:"Tienda"}),e.jsx(i,{children:"Icono Sugerido"}),e.jsx(i,{children:"Referencia"}),e.jsx(i,{children:"Estado"}),e.jsx(i,{className:"text-right",children:"Acciones"})]})}),e.jsxs(je,{children:[d.data.map(s=>e.jsxs(u,{children:[e.jsx(a,{className:"text-sm",children:ke(new Date(s.created_at),"dd MMM yyyy",{locale:Re})}),e.jsx(a,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-sm",children:s.tenant?.name||"N/A"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-medium",children:[s.tenant?.vertical?.name||"-"," / ",s.tenant?.category?.name||"-"]})]})}),e.jsx(a,{className:"font-medium text-sm",children:s.requested_name}),e.jsx(a,{children:e.jsx("a",{href:`/media/${s.reference_image_path}`,target:"_blank",rel:"noreferrer",className:"block h-10 w-10 relative rounded overflow-hidden transition-all border group",children:e.jsx("img",{src:`/media/${s.reference_image_path}`,alt:"Referencia",className:"object-cover w-full h-full transition-transform group-hover:scale-110"})})}),e.jsx(a,{children:ae(s.status)}),e.jsx(a,{className:"text-right",children:s.status==="pending"&&e.jsxs("div",{className:"flex justify-end gap-1.5",children:[e.jsx(t,{size:"sm",variant:"outline",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700 hover:bg-green-50 border-green-200",onClick:()=>{g("sa.categories.edit")?Y(s):m(!0)},title:"Aprobar",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(t,{size:"sm",variant:"outline",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",onClick:()=>{g("sa.categories.edit")?q(s):m(!0)},title:"Rechazar",children:e.jsx(_e,{className:"h-4 w-4"})})]})})]},s.id)),d.data.length===0&&e.jsx(u,{children:e.jsx(a,{colSpan:6,className:"h-[400px]",children:e.jsxs(le,{className:"h-full",children:[e.jsx(ce,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded-full mb-4",children:e.jsx(P,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs(de,{children:[e.jsx(me,{children:"No hay solicitudes pendientes"}),e.jsx(pe,{children:"Todo está al día. No se encontraron solicitudes que requieran atención."})]})]})})})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(Ce,{links:d.links})})]})]})]}),e.jsx(_,{open:H,onOpenChange:n,children:e.jsxs(k,{children:[e.jsxs(R,{children:[e.jsx(D,{children:"Aprobar Solicitud"}),e.jsx(A,{children:'Confirmar la aprobación de la solicitud. El icono debe ser creado manualmente en la sección "Iconos de Categoría".'})]}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(x,{htmlFor:"feedback_approve",children:"Nota para Tienda (Opcional)"}),e.jsx(E,{id:"feedback_approve",value:V.admin_feedback,onChange:s=>N("admin_feedback",s.target.value),placeholder:"Ej: Icono 'Zapatos' creado y disponible globalmente."})]}),e.jsxs(T,{children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),e.jsx(t,{type:"submit",disabled:G,children:"Aprobar"})]})]})]})}),e.jsx(_,{open:I,onOpenChange:l,children:e.jsxs(k,{children:[e.jsxs(R,{children:[e.jsx(D,{children:"Rechazar Solicitud"}),e.jsx(A,{children:"Por favor indica la razón del rechazo para informar a la tienda."})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(x,{htmlFor:"feedback_reject",children:"Motivo del Rechazo"}),e.jsx(E,{id:"feedback_reject",value:Z.admin_feedback,onChange:s=>J("admin_feedback",s.target.value),required:!0}),e.jsx(he,{children:U.admin_feedback})]}),e.jsxs(T,{children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(t,{type:"submit",variant:"destructive",disabled:Q,children:"Rechazar"})]})]})]})}),e.jsx(Se,{open:F,onOpenChange:m})]})}export{Rs as default};
