import{c as E,r as h,j as e,H as y,L as u,a as g,t as N}from"./app-D9wldZxo.js";import{A as P}from"./AdminLayout-C86srUOQ.js";import{B as p}from"./button-Dadb_Lep.js";import{C,d as b}from"./card-DbFVjWqh.js";import{S as H}from"./switch-BIQUlD4u.js";import{T as L,a as z,b as v,c as i,d as M,e as a}from"./table-B6cmMBvL.js";import{A as R,a as _,b as B,c as I,d as O,e as F,f as U,g as V}from"./alert-dialog-BL6dXcRY.js";import{E as q,a as G,e as J,c as K,d as Q}from"./empty-SlYDCCGq.js";import{S as W}from"./Pagination-3BS96hmy.js";import{P as X}from"./dropdown-menu-C4-9o8Rw.js";import{P as S}from"./plus-evWAfx61.js";import{V as Y}from"./video-DRtFkuCB.js";import{L as Z}from"./loader-circle-B4dqvKUy.js";import{S as $}from"./square-pen-BhQcQCyk.js";import{T as ee}from"./trash-2-CMPgRqgc.js";import"./echo-CmTENghG.js";import"./utils-B0KHI9vB.js";import"./badge-DyYF213F.js";import"./progress-D5NiGDeK.js";import"./index-DdTS5Ad2.js";import"./index-CZBSMaku.js";import"./menuConfig-GyORRgsI.js";import"./createLucideIcon-CJjlOp5I.js";import"./chef-hat-D6sEz8YW.js";import"./table-rgWYlWzZ.js";import"./user-D9c6nVY3.js";import"./map-pin-Du3W4-OO.js";import"./banknote-DTNMynPY.js";import"./star-D-Iirb7f.js";import"./users-OjDIvTV8.js";import"./calendar-check-fjlZrFwy.js";import"./calendar-BW0rhnMu.js";import"./briefcase-Crq0rSJT.js";import"./truck-Db-Ebch9.js";import"./message-circle-DrNrCoj8.js";import"./credit-card-CPDlDYf1.js";import"./package-BPq1-jLc.js";import"./shopping-bag-CQGcPT0-.js";import"./layout-dashboard-BqLojFjH.js";import"./badge-check-CEpGdEtW.js";import"./lock-BHZn93rL.js";import"./chevron-right-BSwXEIvG.js";import"./sparkles-JbdQIbjf.js";import"./separator-L5pP8n2q.js";import"./external-link-pORnC0H4.js";import"./chevron-down-Dux0wLDw.js";import"./headphones-DD_UyCnk.js";import"./shield-BtuNH23d.js";import"./sonner-DQ2kSMfY.js";import"./index-BrcTw33p.js";import"./index-BMdzuiHN.js";import"./index--Jev_GdI.js";import"./index-DeHGgcwY.js";import"./index-BDWpq_YI.js";import"./index-tfOuMV4B.js";import"./ellipsis-BfbyL5_C.js";import"./chevron-left-BFxUkP0a.js";import"./circle-check-CN90YBLh.js";import"./check-BAxbGpAF.js";import"./dialog-C0Lg02Tk.js";import"./x-dvUxMxq3.js";import"./input-rMsYcH4C.js";import"./sheet-BP6KOnln.js";import"./index-CbR7iZJO.js";import"./index-CXzOyCXW.js";import"./index-fFU5c_p6.js";import"./index-Dvu8qGWr.js";import"./index-D4lOZYra.js";function us({shorts:l,shorts_limit:n,shorts_count:j}){const{currentTenant:o,currentUserRole:c}=E().props,[m,x]=h.useState(null),[w,f]=h.useState(null),[D,t]=h.useState(!1),d=n!==null&&j>=n,r=s=>c?c.is_owner===!0||c.permissions?.includes("*")===!0||c.permissions?.includes(s)===!0:!1,A=()=>{if(m){if(!r("shorts.delete")){t(!0);return}g.delete(route("tenant.shorts.destroy",[o?.slug,m.id]),{onSuccess:()=>{N.success("Short eliminado"),x(null)}})}},T=s=>{if(!r("shorts.update")){t(!0);return}f(s.id),g.patch(route("tenant.shorts.toggle-active",[o?.slug,s.id]),{},{onSuccess:()=>N.success("Estado actualizado"),onFinish:()=>f(null)})};return e.jsxs(P,{title:"Shorts",children:[e.jsx(y,{title:"Shorts"}),e.jsx(X,{open:D,onOpenChange:t}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Shorts"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Gestiona los shorts promocionales por sede.",n!==null&&e.jsxs("span",{className:"ml-1 font-medium text-foreground",children:["(",j," / ",n," usados)"]})]})]}),e.jsx(p,{asChild:!0,disabled:d,title:d?"Has alcanzado el máximo de shorts permitidos en tu plan":void 0,children:e.jsxs(u,{href:route("tenant.shorts.create",o?.slug),onClick:s=>{r("shorts.create")||(s.preventDefault(),t(!0)),d&&s.preventDefault()},className:"gap-2",children:[e.jsx(S,{className:"w-4 h-4"})," Nuevo short"]})})]}),l.data.length===0?e.jsx(C,{children:e.jsx(b,{className:"py-16",children:e.jsxs(q,{children:[e.jsxs(G,{children:[e.jsx(J,{variant:"icon",children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsx(K,{children:"No hay shorts creados"}),e.jsx(Q,{children:"Crea shorts por sede con enlace a categoría, producto o URL para mostrar en la portada."})]}),e.jsx(p,{asChild:!0,disabled:d,className:"gap-2 mt-4",children:e.jsxs(u,{href:route("tenant.shorts.create",o?.slug),children:[e.jsx(S,{className:"w-4 h-4"})," Crear primer short"]})})]})})}):e.jsx(C,{children:e.jsxs(b,{className:"p-0",children:[e.jsxs(L,{children:[e.jsx(z,{children:e.jsxs(v,{children:[e.jsx(i,{children:"Nombre"}),e.jsx(i,{children:"Sede"}),e.jsx(i,{children:"Enlace"}),e.jsx(i,{className:"w-20 text-center",children:"Orden"}),e.jsx(i,{className:"w-24 text-center",children:"Activo"}),e.jsx(i,{className:"w-[120px] text-right",children:"Acciones"})]})}),e.jsx(M,{children:l.data.map(s=>e.jsxs(v,{children:[e.jsxs(a,{children:[e.jsx("span",{className:"font-medium",children:s.name}),s.description&&e.jsx("span",{className:"block text-xs text-muted-foreground truncate max-w-[200px]",children:s.description})]}),e.jsx(a,{children:s.location?.name??"—"}),e.jsx(a,{className:"text-muted-foreground text-sm max-w-[180px] truncate",title:s.link_label,children:s.link_label||"—"}),e.jsx(a,{className:"text-center",children:s.sort_order}),e.jsx(a,{className:"text-center",children:w===s.id?e.jsx(Z,{className:"w-4 h-4 animate-spin mx-auto"}):e.jsx(H,{checked:s.is_active,onCheckedChange:()=>T(s),disabled:!r("shorts.update")})}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(p,{variant:"ghost",size:"icon",asChild:!0,onClick:k=>!r("shorts.update")&&(k.preventDefault(),t(!0)),children:e.jsx(u,{href:route("tenant.shorts.edit",[o?.slug,s.id]),children:e.jsx($,{className:"w-4 h-4"})})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>{r("shorts.delete")?x(s):t(!0)},children:e.jsx(ee,{className:"w-4 h-4 text-destructive"})})]})})]},s.id))})]}),l.last_page>1&&e.jsx(W,{links:l.links,className:"border-t p-2"})]})}),e.jsx(R,{open:!!m,onOpenChange:s=>!s&&x(null),children:e.jsxs(_,{children:[e.jsxs(B,{children:[e.jsx(I,{children:"¿Eliminar short?"}),e.jsxs(O,{children:['Se eliminará "',m?.name,'". Esta acción no se puede deshacer.']})]}),e.jsxs(F,{children:[e.jsx(U,{children:"Cancelar"}),e.jsx(V,{onClick:A,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})})]})}export{us as default};
