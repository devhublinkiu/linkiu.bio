import{j as e,a as T,c as A,r as d,t as u,L as v,R as U}from"./app-CzmtjlCW.js";import{B as F}from"./button-DHDYV-Vu.js";import{S as G,a as g,b as f,C as H,c as V,d as h,e as $,f as J,g as K,h as Q,u as X,D as Y,i as Z,A as w,j as N,k as S,l as ee,m as te,n as y,o as se,p as x,L as ie,B as ne,q as ae,r as re,s as oe,t as le,v as ce,w as de,P as ue,x as pe,y as he,z as xe,E as me,F as m,G as C,H as M,I as _,J as ge,N as fe}from"./dropdown-menu-CkPxOfJq.js";import{C as je}from"./chevron-right-CP3Al_6X.js";import{C as be}from"./chevrons-up-down-DP41UalB.js";import{B as ke}from"./badge-check-bj2LNrR7.js";import{c as j}from"./createLucideIcon-CaH5oZCX.js";import{A as E}from"./ApplicationLogo-CUFauJCk.js";import{U as ve}from"./users-CiV-Fhl_.js";import{L as we}from"./layout-grid-Do7wAopY.js";const Ne=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Se=j("bot",Ne);const ye=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],D=j("settings-2",ye);const Ce=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],Me=j("square-terminal",Ce);function _e({items:r}){return e.jsx(G,{children:e.jsx(g,{children:r.map(n=>e.jsx(f,{children:n.items?.length?e.jsx(H,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:e.jsxs("div",{children:[e.jsx(V,{asChild:!0,children:e.jsxs(h,{tooltip:n.title,children:[n.icon&&e.jsx(n.icon,{}),e.jsx("span",{children:n.title}),e.jsx(je,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),e.jsx($,{children:e.jsx(J,{children:n.items?.map(o=>e.jsx(K,{children:e.jsx(Q,{asChild:!0,children:e.jsx("a",{href:o.url,children:e.jsx("span",{children:o.title})})})},o.title))})})]})}):e.jsx(h,{asChild:!0,tooltip:n.title,children:e.jsxs("a",{href:n.url,children:[n.icon&&e.jsx(n.icon,{}),e.jsx("span",{children:n.title})]})})},n.title))})})}function Ee({user:r}){const{isMobile:n}=X();return e.jsx(g,{children:e.jsx(f,{children:e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsxs(h,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground outline-none ring-0 focus:ring-0 focus:outline-none",children:[e.jsxs(w,{className:"h-8 w-8 rounded-lg",children:[e.jsx(N,{src:r.avatar,alt:r.name}),e.jsx(S,{className:"rounded-lg",children:"CN"})]}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-medium",children:r.name}),e.jsx("span",{className:"truncate text-xs",children:r.email})]}),e.jsx(be,{className:"ml-auto size-4"})]})}),e.jsxs(ee,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg",side:n?"bottom":"right",align:"end",sideOffset:4,children:[e.jsx(te,{className:"p-0 font-normal",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[e.jsxs(w,{className:"h-8 w-8 rounded-lg",children:[e.jsx(N,{src:r.avatar,alt:r.name}),e.jsx(S,{className:"rounded-lg",children:"CN"})]}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-medium",children:r.name}),e.jsx("span",{className:"truncate text-xs",children:r.email})]})]})}),e.jsx(y,{}),e.jsxs(se,{children:[e.jsx(x,{asChild:!0,className:"cursor-pointer outline-none ring-0 focus:ring-0 focus:outline-none",children:e.jsxs("a",{href:"/superlinkiu/profile",children:[e.jsx(ke,{}),"Perfil"]})}),e.jsx(x,{asChild:!0,className:"cursor-pointer outline-none ring-0 focus:ring-0 focus:outline-none",children:e.jsxs("a",{href:"/superlinkiu/settings",children:[e.jsx(D,{}),"Configuración"]})})]}),e.jsx(y,{}),e.jsxs(x,{className:"cursor-pointer text-red-500 focus:text-red-500 focus:bg-red-50 hover:text-red-600 outline-none ring-0 focus:ring-0 focus:outline-none",onClick:()=>T.post(route("logout")),children:[e.jsx(ie,{}),"Cerrar Sesión"]})]})]})})})}function Ae({user:r,logo:n,...o}){const{url:i}=A(),p=d.useMemo(()=>[{title:"Dashboard",url:"/superlinkiu/dashboard",icon:Me,isActive:i.startsWith("/superlinkiu/dashboard")},{title:"Tenants",url:"/superlinkiu/tenants",icon:Se,isActive:i.startsWith("/superlinkiu/tenants")},{title:"Usuarios",url:"/superlinkiu/users",icon:ve,isActive:i.startsWith("/superlinkiu/users")},{title:"Facturación",url:"#",icon:ne,isActive:i.startsWith("/superlinkiu/plans")||i.startsWith("/superlinkiu/subscriptions")||i.startsWith("/superlinkiu/payments"),items:[{title:"Planes",url:"/superlinkiu/plans"},{title:"Suscripciones",url:"/superlinkiu/subscriptions"},{title:"Pagos",url:"/superlinkiu/payments"}]},{title:"Contenido",url:"#",icon:we,isActive:i.startsWith("/superlinkiu/categories")||i.startsWith("/superlinkiu/category-icons")||i.startsWith("/superlinkiu/support/requests")||i.startsWith("/superlinkiu/media"),items:[{title:"Categorías de negocio",url:"/superlinkiu/categories"},{title:"Categorías e Iconos",url:"/superlinkiu/category-icons"},{title:"Solicitudes de iconos",url:"/superlinkiu/support/requests"},{title:"Mis archivos",url:"/superlinkiu/media"}]},{title:"Atención",url:"#",icon:ae,isActive:i.startsWith("/superlinkiu/support")&&!i.startsWith("/superlinkiu/support/requests")||i.startsWith("/superlinkiu/reportes-tiendas"),items:[{title:"Tickets de Soporte",url:"/superlinkiu/support"},{title:"Reportes tiendas",url:"/superlinkiu/reportes-tiendas"}]},{title:"Configuración",url:"#",icon:D,isActive:i.startsWith("/superlinkiu/roles")||i.startsWith("/superlinkiu/settings"),items:[{title:"Ajustes generales",url:"/superlinkiu/settings"},{title:"Roles y Permisos",url:"/superlinkiu/roles"}]}],[i]);return e.jsxs(re,{variant:"inset",...o,children:[e.jsx(oe,{children:e.jsx(g,{children:e.jsx(f,{children:e.jsx(h,{size:"lg",asChild:!0,className:"group-data-[state=expanded]:bg-transparent group-data-[state=expanded]:hover:bg-transparent ring-0 group-data-[state=expanded]:h-14 group-data-[state=expanded]:p-4 group-data-[state=expanded]:pl-8",children:e.jsxs("a",{href:"/superlinkiu/dashboard",children:[e.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[state=expanded]:hidden",children:e.jsx(E,{className:"size-6"})}),e.jsx("div",{className:"hidden group-data-[state=expanded]:block",children:n?.url?e.jsx("img",{src:n.url,alt:n.name||"Logo",className:"h-8 w-auto object-contain max-w-[200px]"}):e.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl tracking-tight text-sidebar-foreground",children:[e.jsx("div",{className:"h-8 w-8 flex items-center justify-center bg-primary p-1.5 rounded-lg",children:e.jsx(E,{className:"size-5 text-primary-foreground"})}),e.jsx("span",{children:n?.name||"Linkiu.bio"})]})})]})})})})}),e.jsx(le,{children:e.jsx(_e,{items:p})}),e.jsx(ce,{children:e.jsx(Ee,{user:{name:r.name,email:r.email,avatar:r.profile_photo_url||`https://ui-avatars.com/api/?name=${r.name}&background=0D8ABC&color=fff`}})})]})}function Ue({children:r,header:n,breadcrumbs:o}){const{auth:i,flash:p,site_settings:b}=A().props,B=i.user;i.permissions;const[L,l]=d.useState(i.notifications?.unread_count||0),[R,c]=d.useState(i.notifications?.recent||[]),[De,I]=d.useState(0),[O,k]=d.useState(!1),[W,q]=d.useState(!1);d.useEffect(()=>{i.notifications&&(l(i.notifications.unread_count),c(i.notifications.recent))},[i.notifications]);const z=t=>{c(a=>a.map(s=>s.id===t?{...s,read_at:new Date().toISOString()}:s)),l(a=>Math.max(0,a-1))},P=()=>{c(t=>t.map(a=>({...a,read_at:new Date().toISOString()}))),l(0)};return d.useEffect(()=>{window.Echo?(console.log("[Echo] Subscribing to superadmin-updates channel..."),window.Echo.channel("superadmin-updates").listen(".tenant.created",t=>{console.log("[Echo] Received .tenant.created event:",t),u.info("¡Nueva tienda registrada!",{description:t.message}),I(s=>s+1),l(s=>s+1);const a={id:Math.random().toString(),data:{...t,type:"tenant_created"},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}).listen(".ticket.created",t=>{console.log("[Echo] Received .ticket.created event:",t),u.info("¡Nuevo ticket de soporte!",{description:t.message,action:{label:"Ver",onClick:()=>window.location.href=t.url}}),l(s=>s+1);const a={id:Math.random().toString(),data:{...t,type:"ticket_created"},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}).listen(".ticket.replied",t=>{console.log("[Echo] Received .ticket.replied event:",t),u.info("Nueva respuesta en ticket",{description:t.message,action:{label:"Ver",onClick:()=>window.location.href=t.url}}),l(s=>s+1);const a={id:Math.random().toString(),data:{...t,type:"ticket_replied"},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}).listen(".ticket.assigned",t=>{console.log("[Echo] Received .ticket.assigned event:",t),u.success("Ticket asignado",{description:t.message,action:{label:"Ver",onClick:()=>window.location.href=t.url}}),l(s=>s+1);const a={id:Math.random().toString(),data:{...t,type:"ticket_assigned"},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}).listen(".payment.reported",t=>{console.log("[Echo] Received .payment.reported event:",t),u.success("¡Nuevo pago reportado!",{description:t.message}),l(s=>s+1);const a={id:Math.random().toString(),data:{message:t.message,type:"payment_reported",url:t.url},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}).listen(".icon.requested",t=>{console.log("[Echo] Received .icon.requested event:",t),u.info("¡Nueva solicitud de icono!",{description:t.message}),l(s=>s+1);const a={id:Math.random().toString(),data:{message:t.message,type:"icon_requested",url:t.url},created_at:new Date().toISOString(),read_at:null};c(s=>[a,...s.slice(0,4)])}),console.log("[Echo] Listeners attached to superadmin-updates"),window.Echo.connector.ably.connection.state==="connected"?console.log("[Echo] Status: Connected"):(console.log("[Echo] Status:",window.Echo.connector.ably.connection.state),window.Echo.connector.ably.connection.on("connected",()=>console.log("[Echo] Connected!"))),window.Echo.connector.ably.channels.get("superadmin-updates")&&window.Echo.connector.ably.channels.get("superadmin-updates").subscribe(t=>{console.log("[Ably Raw] Message received:",t.name,t.data)})):console.warn("[Echo] window.Echo not available")},[]),d.useEffect(()=>{p.success&&u.success(p.success),p.error&&u.error(p.error)},[p]),e.jsxs(de,{children:[e.jsx(ue,{open:W,onOpenChange:q}),e.jsx(Ae,{user:B,logo:{url:b?.logo_url||null,name:b?.app_name||"Linkiu"}}),e.jsxs(pe,{children:[e.jsxs("header",{className:"bg-background/80 backdrop-blur-md rounded-t-3xl border-b border-border h-12 flex items-center justify-between px-4 sticky top-0 z-30 gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"-ml-1 md:hidden"}),e.jsx(xe,{children:e.jsxs(me,{children:[e.jsx(m,{className:"hidden md:block",children:e.jsx(C,{asChild:!0,children:e.jsx(v,{href:route("superadmin.dashboard"),children:"SuperLinkiu"})})}),e.jsx(M,{className:"hidden md:block"}),o?o.map((t,a)=>e.jsxs(U.Fragment,{children:[e.jsx(m,{children:t.href?e.jsx(C,{asChild:!0,children:e.jsx(v,{href:t.href,children:t.label})}):e.jsx(_,{children:t.label})}),a<o.length-1&&e.jsx(M,{})]},a)):e.jsx(m,{children:e.jsx(_,{children:n})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{variant:"ghost",size:"icon",className:"relative text-muted-foreground hover:text-foreground",onClick:()=>k(!0),children:[e.jsx(ge,{className:"h-5 w-5"}),L>0&&e.jsx("span",{className:"absolute top-2 right-2 h-2 w-2 bg-destructive rounded-full animate-pulse ring-2 ring-background"})]}),e.jsx(fe,{open:O,onOpenChange:k,notifications:R,onNotificationRead:z,onAllRead:P})]})]}),e.jsx("div",{className:"flex-1 p-4 md:px-8 overflow-auto",children:r}),e.jsx("footer",{className:"border-t border-border bg-background px-6 py-2 text-center rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center p-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["© 2026 ",e.jsx("strong",{children:"Linkiu.bio"}),". Todos los derechos reservados."]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 md:mt-0",children:[e.jsx("span",{children:"v1.0.0 (Beta)"}),e.jsx("span",{className:"h-3 w-px bg-border"}),e.jsx("a",{href:"#",className:"hover:text-foreground",children:"Soporte"})]})]})})]})]})}export{Ue as S};
